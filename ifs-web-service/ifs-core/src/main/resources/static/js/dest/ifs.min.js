if("undefined"==typeof IFS)var IFS={};IFS.core={},IFS.core.loadOrder={common:{init:function(){IFS.core.collapsible.init(),IFS.core.conditionalForms.init(),IFS.core.editor.init(),IFS.core.formValidation.init(),IFS.core.wordCount.init()},finalize:function(){IFS.core.modal.init(),IFS.core.upload.init(),IFS.core.autoSubmitForm.init(),IFS.core.pieChart.init()}},"app-form":{init:function(){IFS.core.mirrorElements.init(),IFS.core.unsavedChanges.init(),IFS.core.autoSave.init(),IFS.core.finance.init()}},"assessment-form":{init:function(){IFS.core.unsavedChanges.init(),IFS.core.autoSave.init()}}},function(e){"use strict";e.ajaxProtected=function(e){function t(e){return!/^(GET|HEAD|TRACE|OPTIONS)$/.test(e)}function a(){return Cookies.get(i)}var r="X-CSRF-TOKEN",i="CSRF-TOKEN",n=e.beforeSend;return e.beforeSend=function(e,i){t(i.type)&&!this.crossDomain&&e.setRequestHeader(r,a()),"undefined"!=typeof n&&n.call(this,arguments)},this.ajax(e)}}(jQuery),IFS.core.autoSave=function(){"use strict";var e,t,a={},r=[];return{settings:{inputs:'.form-serialize-js input:not([type="button"],[readonly="readonly"],[type="hidden"])',textareas:'.form-serialize-js textarea:not([readonly="readonly"])',typeTimeout:500,minimumUpdateTime:1e3,hideAjaxValidation:""},init:function(){e=this.settings,e.hideAjaxValidation=!!jQuery('input[type="hidden"][value="hideAjaxValidation"]').length,jQuery("body").on("change keyup",e.textareas,function(a){"keyup"==a.type?(clearTimeout(t),t=setTimeout(function(){IFS.core.autoSave.fieldChanged(a.target)},e.typeTimeout)):IFS.core.autoSave.fieldChanged(a.target)}),jQuery("body").on("change",e.inputs,function(e){IFS.core.autoSave.fieldChanged(e.target)})},fieldChanged:function(e){var t=jQuery(e),r=t.attr("name"),i=t.attr("id").replace("form-textarea-",""),n=jQuery("#application_id").val(),o=!0;if(t.hasClass("js-autosave-disabled")&&(o=!1),"undefined"!=typeof n&&"undefined"!=typeof r&&o){var l=t.val(),s=t.attr("data-date");if("undefined"!=typeof s&&s!==!1){l=t.attr("data-date");var d=t.closest(".date-group");r=d.attr("data-field-group-name"),i=d.attr("data-field-group-id")}var u={value:l,formInputId:i,fieldName:r,applicationId:n};"undefined"==typeof a[r]&&(a[r]=jQuery.when({})),a[r]=a[r].then(IFS.core.autoSave.processAjax(t,n,u))}},processAjax:function(t,a,i){return function(){var n=jQuery.Deferred(),o=t.closest(".form-group"),l=o.find(".textarea-save-info"),s=(new Date).getTime();return 0===l.length&&(o.find(".textarea-footer").append('<span class="textarea-save-info" />'),l=o.find(".textarea-save-info")),jQuery.ajaxProtected({type:"POST",url:"/application/"+a+"/form/saveFormElement",data:i,dataType:"json",beforeSend:function(){l.html("Saving...")}}).done(function(a){var i=(new Date).getTime(),n=IFS.core.autoSave.settings.minimumUpdateTime-(i-s);jQuery("body").trigger("updateSerializedFormState"),"true"==a.success?setTimeout(function(){IFS.core.autoSave.clearServerSideValidationErrors(t),l.html("Saved!")},n):setTimeout(function(){IFS.core.autoSave.clearServerSideValidationErrors(t),l.html("Saved!"),e.hideAjaxValidation===!1&&jQuery.each(a.validation_errors,function(e,a){IFS.core.formValidation.setInvalid(t,a),r.push(a)})},n)}).fail(function(e){var a=(new Date).getTime(),i=IFS.core.autoSave.settings.minimumUpdateTime-(a-s);"undefined"!=typeof e.responseJSON&&setTimeout(function(){var a=e.responseJSON.errorMessage;if(o.length)if(l.length)l.html(a);else{var i=o.find("label,legend").first();i.length&&(r.push(a),IFS.core.formValidation.setInvalid(t,a))}else t.addClass("error")},i)}).error(function(e){if("undefined"!=typeof e.responseText){var a=jQuery.parseJSON(e.responseText),i=a.error+" : "+a.message;r.push(i),IFS.core.formValidation.setInvalid(t,i),l.html("")}}).complete(function(){n.resolve()}),n.promise()}},clearServerSideValidationErrors:function(e){for(var t=0;t<r.length;t++)IFS.core.formValidation.setValid(e,r[t])}}}(),IFS.core.autoSubmitForm=function(){"use strict";var e;return{settings:{submitElements:".js-auto-submit"},init:function(){e=this.settings,jQuery(e.submitElements).next("button").addClass("visuallyhidden"),jQuery(document).on("change",e.submitElements,function(){IFS.core.autoSubmitForm.submitForm(this)})},submitForm:function(e){jQuery(e).closest("form").submit()}}}(),IFS.core.collapsible=function(){"use strict";var e,t=0;return{settings:{collapsibleEl:".collapsible > h2, .collapsible > h3"},init:function(){e=this.settings,jQuery(e.collapsibleEl).each(function(){IFS.core.collapsible.initCollapsibleHTML(this)}),jQuery("body").on("click",".collapsible > h2 >  [aria-controls], .collapsible > h3 >  [aria-controls]",function(){IFS.core.collapsible.toggleCollapsible(this)})},initCollapsibleHTML:function(e){var a=jQuery(e),r="collapsible-"+t,i=IFS.core.collapsible.getLoadstateFromCookie(r);a.nextUntil("h2,h3").wrapAll('<div id="'+r+'" aria-hidden="'+!i+'">'),a.wrapInner('<button aria-expanded="'+i+'" aria-controls="'+r+'" type="button">'),t++},toggleCollapsible:function(e){var t=jQuery(e),a=jQuery("#"+t.attr("aria-controls")),r="false"===t.attr("aria-expanded");t.attr("aria-expanded",r),a.attr("aria-hidden",!r),IFS.core.collapsible.setLoadStateInCookie(a.attr("id"),r)},getLoadstateFromCookie:function(e){if("undefined"!=typeof Cookies.getJSON("collapsibleStates")){var t=Cookies.getJSON("collapsibleStates"),a=window.location.pathname;if("undefined"!=typeof t[a]&&"undefined"!=typeof t[a][e])return t[a][e]}return!1},setLoadStateInCookie:function(e,t){var a={};"undefined"!=typeof Cookies.getJSON("collapsibleStates")&&(a=Cookies.getJSON("collapsibleStates"));var r=window.location.pathname;if("undefined"==typeof a[r]&&(a[r]={}),t===!0)a[r][e]=t;else if("undefined"!=typeof a[r][e]){delete a[r][e];var i=0;jQuery.each(a[r],function(){i++}),0===i&&delete a[r]}Cookies.set("collapsibleStates",a,{expires:.05})}}}(),IFS.core.conditionalForms=function(){"use strict";return{init:function(){jQuery("label[data-target]").each(function(){var e=jQuery(this),t=e.attr("data-target"),a=e.find('input[type="radio"],input[type="checkbox"]'),r=!1;if(e.attr("data-target-inverted")&&(r=!0),a&&t){var i=a.attr("name");IFS.core.conditionalForms.toggleVisibility(a,"#"+t,r),jQuery('input[name="'+i+'"]').on("click",function(){IFS.core.conditionalForms.toggleVisibility(a,"#"+t,r)})}})},toggleVisibility:function(e,t,a){t=jQuery(t);var r=e.is(":checked");a&&(r=!r),r?t.attr("aria-hidden","false").removeClass("js-hidden"):t.attr("aria-hidden","true")}}}(),IFS.core.editor=function(){"use strict";var e,t;return{settings:{textareas:".textarea-wrapped textarea",htmlOptions:{format:!1,allowedTags:["p","em","strong","ol","ul","li","br","b","div"]}},init:function(){e=this.settings,t=new showdown.Converter;var a=jQuery(e.textareas);jQuery.each(a,function(){IFS.core.editor.prepareEditor(this)}),jQuery(".js-md-to-html").each(function(){var e=jQuery(this).html(),t=IFS.core.editor.markdownToHtml(e);jQuery(this).html(t)}),IFS.core.editor.initEditors(),IFS.core.editor.bindEditors()},prepareEditor:function(e){var t=jQuery(e),a="";jQuery('[for="'+t.attr("id")+'"]').length&&(a=jQuery('[for="'+t.attr("id")+'"]').attr("id")),t.attr("readonly")?t.before('<div class="readonly"></div>'):t.before('<div class="editor" spellcheck="true" aria-multiline="true" tabindex="0" '+a+' visirole="textbox"></div>'),t.attr("aria-hidden","true"),IFS.core.editor.processMarkdownToHtml(t,t.prev())},initEditors:function(){jQuery(".editor").hallo({plugins:{halloformat:{},hallolists:{},hallocleanhtml:e.htmlOptions},toolbar:"halloToolbarFixed"})},bindEditors:function(){jQuery(".editor").bind("hallomodified",function(e,t){var a=jQuery(this).next();IFS.core.editor.processHtmlToMarkdown(t.content,a),jQuery(a).trigger("keyup")})},processMarkdownToHtml:function(e,t){var a=e.val();if(IFS.core.editor.htmlToMarkdown(jQuery(t).html())!=a){var r=IFS.core.editor.markdownToHtml(a);jQuery(t).html(r)}},processHtmlToMarkdown:function(e,t){var a=IFS.core.editor.htmlToMarkdown(e);jQuery(t).get(0).value!=a&&(jQuery(t).get(0).value=a)},htmlToMarkdown:function(t){var a=jQuery.trim(t.replace(/(\r\n|\n|\r)/gm,""));return a=jQuery.htmlClean(a,e.htmlOptions),md(a)},markdownToHtml:function(a){var r;return r=0===a.length?"<p>&nbsp;</p>":t.makeHtml(a),r=jQuery.htmlClean(r,e.htmlOptions)}}}(),IFS.core.finance=function(){"use strict";return{MathOperation:{"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return 0===t?0:e/t}},init:function(){IFS.core.finance.bindCalculationActionToFields()},bindCalculationActionToFields:function(){jQuery("body").on("change","input",function(){jQuery("[data-calculation-fields]:not([data-calculation-binded])").length&&jQuery("[data-calculation-fields]:not([data-calculation-binded])").each(function(){var e=jQuery(this),t=e.attr("data-calculation-fields");jQuery(document).on("change updateFinances",t,function(){IFS.core.finance.doMath(e,t.split(","))}),e.attr("data-calculation-binded","")})}),jQuery("body").on("recalculateAllFinances",function(){jQuery("[data-calculation-fields]").length&&jQuery("[data-calculation-fields]").each(function(){var e=jQuery(this),t=e.attr("data-calculation-fields");IFS.core.finance.doMath(e,t.split(","))})})},getElementValue:function(e){var t=jQuery(e).attr("data-calculation-rawvalue");if("undefined"!=typeof t)return parseFloat(t);if("undefined"!=typeof jQuery(e).val()&&jQuery(e).val().length){var a=jQuery(e).val().replace(",",""),r=0===a.indexOf("Â£ ")?a.substring(2):a;return parseFloat(r)}return parseFloat(0)},doMath:function(e,t){var a=e.attr("data-calculation-operations").split(","),r=[];jQuery.each(t,function(e,t){jQuery.isNumeric(t)?r.push(parseFloat(t)):jQuery(t).length>1?jQuery.each(jQuery(t),function(e,t){r.push(IFS.core.finance.getElementValue(t))}):r.push(IFS.core.finance.getElementValue(t))});var i;if(i=1===r.length?r[0]:IFS.core.finance.MathOperation[a[0]](r[0],r[1]),1==a.length&&r.length>2)for(var n=2;n<r.length;n++)i=IFS.core.finance.MathOperation[a[0]](i,r[n]);else if(a.length>1&&r.length>2)for(var o=1;o<a.length;o++)i=IFS.core.finance.MathOperation[a[o]](i,r[o+1]);e.attr("data-calculation-rawvalue",i);var l=IFS.core.finance.formatCurrency(Math.round(i));e.is("input")?e.val(l):e.text(l),e.trigger("change")},formatCurrency:function(e){return e=parseFloat(e,10),e=e.toFixed(),e=e.replace(/(\d)(?=(\d{3})+\b)/g,"$1,"),"Â£ "+e.toString()}}}(),IFS.core.formValidation=function(){"use strict";var e;return{settings:{number:{fields:'[type="number"]:not([data-date])',messageInvalid:"This field should be a number"},min:{fields:"[min]:not([data-date])",messageInvalid:"This field should be %min% or higher"},max:{fields:"[max]:not([data-date])",messageInvalid:"This field should be %max% or lower"},passwordEqual:{field1:'[name="password"]',field2:'[name="retypedPassword"]',messageInvalid:"Passwords must match"},passwordPolicy:{fields:{password:'[name="password"],[name="retypedPassword"]',firstname:"#firstName",lastname:"#lastName"},messageInvalid:{lowercase:"Password must contain at least one lower case letter",uppercase:"Password must contain at least one upper case letter",number:"Password must contain at least one number",name:"Password should not contain either your first or last name",organisation:"Password should not contain your organisation name"}},email:{fields:'[type="email"]',messageInvalid:"Please enter a valid email address"},required:{fields:"[required]",messageInvalid:"This field cannot be left blank"},minlength:{fields:"[minlength]",messageInvalid:"This field should contain at least %minlength% characters"},maxlength:{fields:"[maxlength]",messageInvalid:"This field cannot contain more than %maxlength% characters"},date:{fields:".date-group input",messageInvalid:{invalid:"Please enter a valid date",future:"Please enter a future date"}},tel:{fields:'[type="tel"]',messageInvalid:"Please enter a valid phone number"},typeTimeout:1500,html5validationMode:!1},init:function(){e=this.settings,e.html5validationMode=IFS.core.formValidation.checkHTML5validationMode(),IFS.core.formValidation.initValidation()},initValidation:function(){jQuery("body").on("change keyup ifsValidate",e.passwordEqual.field1+","+e.passwordEqual.field2,function(t){switch(t.type){case"keyup":clearTimeout(window.IFS.core.formValidation_timer),window.IFS.core.formValidation_timer=setTimeout(function(){IFS.core.formValidation.checkEqualPasswords(!0)},e.typeTimeout);break;default:IFS.core.formValidation.checkEqualPasswords(!0)}}),jQuery("body").on("change",e.passwordPolicy.fields.password,function(){IFS.core.formValidation.checkPasswordPolicy(jQuery(this),!0)}),jQuery("body").on("change",e.email.fields,function(){IFS.core.formValidation.checkEmail(jQuery(this),!0)}),jQuery("body").on("change",e.number.fields,function(){IFS.core.formValidation.checkNumber(jQuery(this),!0)}),jQuery("body").on("change",e.min.fields,function(){IFS.core.formValidation.checkMin(jQuery(this),!0)}),jQuery("body").on("change",e.max.fields,function(){IFS.core.formValidation.checkMax(jQuery(this),!0)}),jQuery("body").on("blur change",e.required.fields,function(){IFS.core.formValidation.checkRequired(jQuery(this),!0)}),jQuery("body").on("change",e.minlength.fields,function(){IFS.core.formValidation.checkMinLength(jQuery(this),!0)}),jQuery("body").on("change",e.maxlength.fields,function(){IFS.core.formValidation.checkMaxLength(jQuery(this),!0)}),jQuery("body").on("change",e.tel.fields,function(){IFS.core.formValidation.checkTel(jQuery(this),!0)}),jQuery("body").on("change",e.date.fields,function(){IFS.core.formValidation.checkDate(jQuery(this),!0)}),jQuery(e.date.fields).attr("data-date",""),jQuery("form:not([novalidate]) input").on("invalid",function(){jQuery(this).trigger("change")}),IFS.core.formValidation.betterMinLengthSupport()},checkEqualPasswords:function(t){var a=jQuery(e.passwordEqual.field1),r=jQuery(e.passwordEqual.field2),i=IFS.core.formValidation.getErrorMessage(r,"passwordEqual");return!!(a.length&&r.length&&a.val().length&&r.val().length)&&(a.val()==r.val()?(t&&(IFS.core.formValidation.setValid(a,i),IFS.core.formValidation.setValid(r,i)),!0):(t&&(IFS.core.formValidation.setInvalid(a,i),IFS.core.formValidation.setInvalid(r,i)),!1))},checkPasswordPolicy:function(t,a){var r=t.val(),i=!0;if(r.length){var n=/(?=\S*?[A-Z])/;n.test(r)===!1?(a&&IFS.core.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid.uppercase),i=!1):a&&IFS.core.formValidation.setValid(t,e.passwordPolicy.messageInvalid.uppercase);var o=/(?=\S*?[a-z])/;o.test(r)===!1?(a&&IFS.core.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid.lowercase),i=!1):a&&IFS.core.formValidation.setValid(t,e.passwordPolicy.messageInvalid.lowercase);var l=/(?=\S*?[0-9])/;l.test(r)===!1?(a&&IFS.core.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid.number),i=!1):a&&IFS.core.formValidation.setValid(t,e.passwordPolicy.messageInvalid.number);var s=jQuery(e.passwordPolicy.fields.firstname).val(),d=jQuery(e.passwordPolicy.fields.lastname).val();(s.replace(" ","").length||d.replace(" ","").length)&&(r.toLowerCase().indexOf(s.toLowerCase())>-1||r.toLowerCase().indexOf(d.toLowerCase())>-1?(a&&IFS.core.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid.name),i=!1):a&&IFS.core.formValidation.setValid(t,e.passwordPolicy.messageInvalid.name))}return i},checkEmail:function(e,t){var a=e.val(),r=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i,i=IFS.core.formValidation.getErrorMessage(e,"email"),n=r.test(a);return n?(t&&IFS.core.formValidation.setValid(e,i),!0):(t&&IFS.core.formValidation.setInvalid(e,i),!1)},checkNumber:function(t,a){var r=IFS.core.formValidation.getErrorMessage(t,"number");if(e.html5validationMode){var i=t[0];return i.validity.valid===!1&&i.validity.badInput===!0?(a&&IFS.core.formValidation.setInvalid(t,r),!1):(a&&IFS.core.formValidation.setValid(t,r),!0)}return t.val()>0&&!jQuery.isNumeric(t.val())?(a&&IFS.core.formValidation.setInvalid(t,r),!1):(a&&IFS.core.formValidation.setValid(t,r),!0)},checkMax:function(t,a){var r=IFS.core.formValidation.getErrorMessage(t,"max");if(e.html5validationMode){var i=t[0];return i.validity.rangeOverflow===!0?(a&&IFS.core.formValidation.setInvalid(t,r),!1):(a&&IFS.core.formValidation.setValid(t,r),!0)}var n=parseInt(t.attr("max"),10);if(IFS.core.formValidation.checkNumber(t,!0)){var o=parseInt(t.val(),10);return o>n?(a&&IFS.core.formValidation.setInvalid(t,r),!1):(a&&IFS.core.formValidation.setValid(t,r),!0)}},checkMin:function(t,a){var r=IFS.core.formValidation.getErrorMessage(t,"min");if(e.html5validationMode){var i=t[0];return i.validity.rangeUnderflow===!0?(a&&IFS.core.formValidation.setInvalid(t,r),!1):(a&&IFS.core.formValidation.setValid(t,r),!0)}var n=parseInt(t.attr("min"),10);if(IFS.core.formValidation.checkNumber(t)){var o=parseInt(t.val(),10);return o<n?(a&&IFS.core.formValidation.setInvalid(t,r),!1):(a&&IFS.core.formValidation.setValid(t,r),!0)}},checkRequired:function(e,t){var a=IFS.core.formValidation.getErrorMessage(e,"required");if(null!==e.val()){if(!e.is(":checkbox,:radio"))return 0===e.val().length?(t&&IFS.core.formValidation.setInvalid(e,a),!1):(t&&IFS.core.formValidation.setValid(e,a),!0);var r=e.attr("name");if("undefined"!=typeof r){var i=jQuery('[name="'+r+'"]');return 0===jQuery('[name="'+r+'"]:checked').length?(t&&i.each(function(){IFS.core.formValidation.setInvalid(jQuery(this),a)}),!1):(t&&i.each(function(){IFS.core.formValidation.setValid(jQuery(this),a)}),!0)}}},betterMinLengthSupport:function(){e.html5validationMode&&"undefined"==typeof jQuery("input")[0].validity.tooShort&&jQuery(e.minlength.fields).each(function(){var e=jQuery(this),t=parseInt(e.attr("minlength"),10);e.attr("pattern",".{"+t+",}")})},checkMinLength:function(e,t){var a=IFS.core.formValidation.getErrorMessage(e,"minlength"),r=parseInt(e.attr("minlength"),10);return e.val().length>0&&e.val().length<r?(t&&IFS.core.formValidation.setInvalid(e,a),!1):(t&&IFS.core.formValidation.setValid(e,a),!0)},checkMaxLength:function(e,t){var a=IFS.core.formValidation.getErrorMessage(e,"maxlength"),r=parseInt(e.attr("maxlength"),10);return e.val().length>r?(t&&IFS.core.formValidation.setInvalid(e,a),!1):(t&&IFS.core.formValidation.setValid(e,a),!0)},checkTel:function(e,t){var a=e.val(),r=IFS.core.formValidation.getErrorMessage(e,"tel"),i=/^(?=.*[0-9])[- +()0-9]+$/,n=i.test(a);return n?(t&&IFS.core.formValidation.setValid(e,r),!0):(t&&IFS.core.formValidation.setInvalid(e,r),!1)},checkDate:function(t,a){var r=t.closest(".date-group");t.addClass("js-visited");var i=r.find(".day input"),n=r.find(".month input"),o=r.find(".year input"),l=i.add(n).add(o),s=i.hasClass("js-visited")&&n.hasClass("js-visited")&&o.hasClass("js-visited"),d=i.val().length>0&&n.val().length>0&&o.val().length>0,u=IFS.core.formValidation.checkNumber(i,!1)&&IFS.core.formValidation.checkNumber(n,!1)&&IFS.core.formValidation.checkNumber(o,!1);if(u&&d){var c=parseInt(n.val(),10),f=parseInt(i.val(),10),m=parseInt(o.val(),10),h=new Date(m,c-1,f);if(h.getDate()==f&&h.getMonth()+1==c&&h.getFullYear()==m){if(a&&IFS.core.formValidation.setValid(l,e.date.messageInvalid.invalid),l.removeClass("js-autosave-disabled").attr("data-date",f+"-"+c+"-"+m),r.hasClass("js-future-date")){var v=new Date;return v<h?(a&&IFS.core.formValidation.setValid(l,e.date.messageInvalid.future),!0):(a&&IFS.core.formValidation.setInvalid(l,e.date.messageInvalid.future),!1)}return!0}return a&&IFS.core.formValidation.setInvalid(l,e.date.messageInvalid.invalid),l.addClass("js-autosave-disabled").attr("data-date",""),!1}return!(!d&&!s)&&(a&&IFS.core.formValidation.setInvalid(l,e.date.messageInvalid.invalid),l.addClass("js-autosave-disabled").attr("data-date",""),!1)},getErrorMessage:function(t,a){var r=t.attr("data-"+a+"-errormessage");return"undefined"==typeof r&&(r=e[a].messageInvalid),r.indexOf("%"+a+"%")!==-1&&(r=r.replace("%"+a+"%",t.attr(a))),r},setInvalid:function(t,a){var r=t.closest(".form-group");if(r){e.html5validationMode&&t[0].setCustomValidity(a),t.addClass("field-error");var i=r.find('.error-message:contains("'+a+'")');if(0===i.length){r.addClass("error");var n='<span class="error-message">'+a+"</span>";r.find("legend,label").first().append(n)}}0===jQuery("ul.error-summary-list li:contains("+a+")").length&&jQuery(".error-summary-list").append("<li>"+a+"</li>"),jQuery(".error-summary").attr("aria-hidden",!1),jQuery(window).trigger("updateWysiwygPosition")},setValid:function(t,a){var r=t.closest(".form-group.error");r&&(r.find('.error-message:contains("'+a+'")').remove(),0===r.find(".error-message").length&&(r.removeClass("error"),t.removeClass("field-error"),e.html5validationMode&&t[0].setCustomValidity(""))),jQuery(".error-summary-list li:contains("+a+")").length&&jQuery(".error-summary-list li:contains("+a+")").remove(),0===jQuery(".error-summary-list li").length&&jQuery(".error-summary").attr("aria-hidden",!0),jQuery(window).trigger("updateWysiwygPosition")},checkHTML5validationMode:function(){var e=jQuery("input");if(e.length)return"undefined"!=typeof e[0].validity}}}(),IFS.core.mirrorElements=function(){"use strict";return{init:function(){jQuery("[data-mirror]").each(function(){var e=jQuery(this),t=e.attr("data-mirror");IFS.core.mirrorElements.updateElement(e,t),IFS.core.mirrorElements.bindMirrorElement(e,t)})},bindMirrorElement:function(e,t){jQuery(document).on("change",t,function(){IFS.core.mirrorElements.updateElement(e,this)})},updateElement:function(e,t){var a=IFS.core.mirrorElements.getSourceText(t);e.is("input")?e.val(a):e.text(a)},getSourceText:function(e){var t=jQuery(e);if(1==t.length){if(t.val().length)return t.val();if(t.text().length)return t.text()}return""}}}(),IFS.core.modal=function(){"use strict";var e;return{settings:{element:"[data-js-modal]",html5validationMode:{}},init:function(){e=this.settings,e.html5validationMode=IFS.core.formValidation.checkHTML5validationMode(),IFS.core.modal.initButtonRole(),jQuery("body").on("click",e.element,function(e){IFS.core.modal.openModal(e,this)}),jQuery("body").on("click",".js-close",function(){IFS.core.modal.closeModal()}),jQuery(document).keyup(function(e){27===e.keyCode&&IFS.core.modal.closeModal()})},initButtonRole:function(){jQuery(e.element).is("a")&&jQuery(e.element).attr({role:"button",tabindex:"0"})},checkForInputErrors:function(t){var a=!0;if(t.closest("form:not([novalidate])").length&&e.html5validationMode){var r=t.closest("form:not([novalidate])");r[0].checkValidity(),r.find(":invalid").length&&(a=!1)}return a},openModal:function(e,t){t=jQuery(t);var a=IFS.core.modal.checkForInputErrors(t),r=jQuery(e.target).attr("data-js-modal");r=jQuery("."+r),r.length&&(e.preventDefault(),a&&t.is('[aria-disabled="true"]')===!1?(IFS.core.modal.disableTabPage(),r.add(".modal-overlay").attr("aria-hidden","false"),setTimeout(function(){var e=r.outerHeight();r.css({"margin-top":"-"+e/2+"px"})},50)):a||t.closest("form:not([novalidate])").find("input:invalid").first().focus())},disableTabPage:function(){jQuery(":tabbable").each(function(){var e=jQuery(this);if(0===e.closest('[role="dialog"]').length){var t=0;e.prop("tabindex")&&(t=e.prop("tabindex")),e.prop("tabindex","-1").attr("data-original-tabindex",t)}})},enableTabPage:function(){jQuery("[data-original-tabindex]").each(function(){var e=jQuery(this),t=e.attr("data-original-tabindex");e.prop("tabindex",t).removeAttr("data-original-tabindex")})},closeModal:function(){IFS.core.modal.enableTabPage(),jQuery('[role="dialog"],.modal-overlay').attr("aria-hidden","true")}}}(),IFS.core.pieChart=function(){"use strict";var e;return{settings:{pieElement:".pie"},init:function(){e=this.settings,document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")&&jQuery(e.pieElement).each(function(){IFS.core.pieChart.pieSVG(this)})},pieSVG:function(e){var t=parseFloat(e.textContent),a="http://www.w3.org/2000/svg",r=document.createElementNS(a,"svg"),i=document.createElementNS(a,"circle"),n=document.createElementNS(a,"title");i.setAttribute("r",16),i.setAttribute("cx",16),i.setAttribute("cy",16),i.setAttribute("stroke-dasharray",t+" 100"),r.setAttribute("viewBox","0 0 32 32"),n.textContent=e.textContent,e.textContent="",r.appendChild(n),r.appendChild(i),e.setAttribute("aria-hidden","true"),e.appendChild(r)}}}(),IFS.core.unsavedChanges=function(){"use strict";var e;return{settings:{formelement:jQuery(".form-serialize-js")},init:function(){e=this.settings,IFS.core.unsavedChanges.initUnsavedChangesWarning(),IFS.core.unsavedChanges.updateSerializedFormState(),jQuery("body").on("updateSerializedFormState",function(){IFS.core.unsavedChanges.updateSerializedFormState()})},updateSerializedFormState:function(){e.formelement.data("serializedFormState",jQuery(".form-serialize-js").serialize())},initUnsavedChangesWarning:function(){var t=!1;e.formelement.on("submit",function(){t=!0}),jQuery(window).bind("beforeunload",function(a){var r=e.formelement.attr("data-test");r="undefined"!=typeof r&&r!==!1;var i=jQuery(".form-serialize-js").serialize()==jQuery(".form-serialize-js").data("serializedFormState");return t===!1&&i===!1&&r===!1?"Are you sure you want to leave this page? There are some unsaved changes...":void(a=null)})}}}(),IFS.core.upload=function(){"use strict";var e;return{settings:{uploadEl:'[type="file"][class="inputfile"]'},init:function(){e=this.settings,jQuery("body").on("change",e.uploadEl,function(){var e=jQuery(this).attr("id");jQuery('[data-for-file-upload="'+e+'"]').click()})}}}(),IFS.core.wordCount=function(){"use strict";var e,t;return{settings:{wordcountEl:".word-count textarea",typeTimeout:500},init:function(){e=this.settings,jQuery("body").on("change keyup",e.wordcountEl,function(a){"keyup"==a.type?(clearTimeout(t),t=setTimeout(function(){IFS.core.wordCount.updateWordCount(a.target)},e.typeTimeout)):IFS.core.wordCount.updateWordCount(a.target)})},updateWordCount:function(e){var t=jQuery(e),a=t.val();a=a.replace(/(\r\n|\n|\r)/gm," "),a=a.replace(/([[0-9]+\.\ |\*\ |\*\*|_)/gm,"");for(var r=jQuery.trim(a).split(" "),i=0,n=0;n<r.length;n++)r[n].length>0&&i++;var o=t.attr("data-max_words")-i,l=t.parents(".word-count").find(".count-down");l.html("Words remaining: "+o),o<0?l.removeClass("positive").addClass("negative"):l.removeClass("negative").addClass("positive")}}}(),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,a=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.push(t);return a});var UTIL=function(){"use strict";return{fire:function(e,t,a){var r=Object.keys(IFS);jQuery.each(r,function(){if("undefined"!=typeof IFS[this].loadOrder){var r=IFS[this].loadOrder;t=void 0===t?"init":t,""!==e&&r[e]&&"function"==typeof r[e][t]&&r[e][t](a)}})},loadEvents:function(){var e=document.body.id;UTIL.fire("common"),jQuery.each(document.body.className.split(/\s+/),function(t,a){UTIL.fire(a),UTIL.fire(a,e)}),UTIL.fire("common","finalize")}}}();jQuery(document).ready(function(){UTIL.loadEvents()});