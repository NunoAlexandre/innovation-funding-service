var IFS={};!function(e){"use strict";e.ajaxProtected=function(e){function t(e){return!/^(GET|HEAD|TRACE|OPTIONS)$/.test(e)}function a(){return Cookies.get(i)}var n="X-CSRF-TOKEN",i="CSRF-TOKEN",o=e.beforeSend;return e.beforeSend=function(e,i){t(i.type)&&!this.crossDomain&&e.setRequestHeader(n,a()),"undefined"!=typeof o&&o.call(this,arguments)},this.ajax(e)}}(jQuery),IFS.progressiveSelect=function(){"use strict";var e,t=0;return{settings:{selectEl:"select.prog-menu",dropdownContainer:".assign-container .assign-button"},init:function(){e=this.settings,IFS.progressiveSelect.initDomChanges(),IFS.progressiveSelect.initEventHandlers()},initEventHandlers:function(){jQuery(document).on("click",function(){IFS.progressiveSelect.hideAll()}),jQuery("body").on("click",".assign-button [aria-controls]",function(e){e.stopPropagation(),IFS.progressiveSelect.toggleDropdown(this)})},initDomChanges:function(){jQuery(e.dropdownContainer).each(function(){IFS.progressiveSelect.initDropDownHTML(this)}),jQuery(e.selectEl).each(function(){IFS.progressiveSelect.selectToListHTML(this)})},selectToListHTML:function(e){e=jQuery(e),e.next("button").remove();var t=e.children("option"),a=e.attr("name"),n='<ul class="list-bullet">';t.each(function(){var e=jQuery(this),t=e.text(),i=e.attr("value");n+="disabled"==e.attr("disabled")?"<li>"+t+"</li>":'<li><button value="'+i+'" name="'+a+'" class="buttonlink">'+t+"</button></li>"}),n+="</ul>",e.after(n).remove(),jQuery("body").trigger("updateSerializedFormState")},initDropDownHTML:function(e){var a=jQuery(e),n="dropdown-"+t;a.next().wrapAll('<div id="'+n+'" aria-hidden="true">'),a.wrapInner('<button aria-expanded="false" aria-controls="'+n+'" type="button">'),t++},toggleDropdown:function(e){var t=jQuery(e),a=jQuery("#"+t.attr("aria-controls")),n="false"===t.attr("aria-expanded");IFS.progressiveSelect.hideAll(),n&&(t.attr("aria-expanded","true"),a.attr("aria-hidden","false"))},hideAll:function(){jQuery('[aria-controls*="dropdown-"][aria-expanded="true"]').attr("aria-expanded","false"),jQuery('[id^="dropdown-"][aria-hidden="false"]').attr("aria-hidden","true")}}}(),IFS.autoSave=function(){"use strict";var e,t={},a=[];return{settings:{inputs:'.form-serialize-js input:not([type="button"],[readonly="readonly"],[type="hidden"])',textareas:'.form-serialize-js textarea:not([readonly="readonly"])',typeTimeout:500,minimumUpdateTime:1e3,hideAjaxValidation:""},init:function(){e=this.settings,e.hideAjaxValidation=!!jQuery('input[type="hidden"][value="hideAjaxValidation"]').length,jQuery("body").on("change keyup",e.textareas,function(t){"keyup"==t.type?(clearTimeout(window.IFS.autoSave_timer),window.IFS.autoSave_timer=setTimeout(function(){IFS.autoSave.fieldChanged(t.target)},e.typeTimeout)):IFS.autoSave.fieldChanged(t.target)}),jQuery("body").on("change",e.inputs,function(e){IFS.autoSave.fieldChanged(e.target)})},fieldChanged:function(e){var a=jQuery(e),n=a.attr("name"),i=a.attr("id").replace("form-textarea-",""),o=jQuery("#application_id").val(),r=!0;if(a.hasClass("js-autosave-disabled")&&(r=!1),"undefined"!=typeof o&&"undefined"!=typeof n&&r){var s=a.val(),l=a.attr("data-date");if("undefined"!=typeof l&&l!==!1){s=a.attr("data-date");var d=a.closest(".date-group");n=d.attr("data-field-group-name"),i=d.attr("data-field-group-id")}var u={value:s,formInputId:i,fieldName:n,applicationId:o};"undefined"==typeof t[n]&&(t[n]=jQuery.when({})),t[n]=t[n].then(IFS.autoSave.processAjax(a,o,u))}},processAjax:function(t,n,i){return function(){var o=jQuery.Deferred(),r=t.closest(".form-group"),s=r.find(".textarea-save-info"),l=(new Date).getTime();return 0===s.length&&(r.find(".textarea-footer").append('<span class="textarea-save-info" />'),s=r.find(".textarea-save-info")),jQuery.ajaxProtected({type:"POST",url:"/application/"+n+"/form/saveFormElement",data:i,dataType:"json",beforeSend:function(){s.html("Saving...")}}).done(function(n){var i=(new Date).getTime(),o=IFS.autoSave.settings.minimumUpdateTime-(i-l);jQuery("body").trigger("updateSerializedFormState"),"true"==n.success?setTimeout(function(){IFS.autoSave.clearServerSideValidationErrors(t),s.html("Saved!")},o):setTimeout(function(){IFS.autoSave.clearServerSideValidationErrors(t),s.html("Saved!"),e.hideAjaxValidation===!1&&jQuery.each(n.validation_errors,function(e,n){IFS.formValidation.setInvalid(t,n),a.push(n)})},o)}).fail(function(e){var n=(new Date).getTime(),i=IFS.autoSave.settings.minimumUpdateTime-(n-l);"undefined"!=typeof e.responseJSON&&setTimeout(function(){var n=e.responseJSON.errorMessage;if(r.length)if(s.length)s.html(n);else{var i=r.find("label,legend").first();i.length&&(a.push(n),IFS.formValidation.setInvalid(t,n))}else t.addClass("error")},i)}).error(function(e){if("undefined"!=typeof e.responseText){var n=jQuery.parseJSON(e.responseText),i=n.error+" : "+n.message;a.push(i),IFS.formValidation.setInvalid(t,i),s.html("")}}).complete(function(){o.resolve()}),o.promise()}},clearServerSideValidationErrors:function(e){for(var t=0;t<a.length;t++)IFS.formValidation.setValid(e,a[t])}}}(),IFS.autoSubmitForm=function(){"use strict";var e;return{settings:{submitElements:".js-auto-submit"},init:function(){e=this.settings,jQuery(e.submitElements).next("button").addClass("visuallyhidden"),jQuery(document).on("change",e.submitElements,function(){IFS.autoSubmitForm.submitForm(this)})},submitForm:function(e){jQuery(e).closest("form").submit()}}}(),IFS.collapsible=function(){"use strict";var e,t=0;return{settings:{collapsibleEl:".collapsible > h2, .collapsible > h3"},init:function(){e=this.settings,jQuery(e.collapsibleEl).each(function(){IFS.collapsible.initCollapsibleHTML(this)}),jQuery("body").on("click",".collapsible > h2 >  [aria-controls], .collapsible > h3 >  [aria-controls]",function(){IFS.collapsible.toggleCollapsible(this)})},initCollapsibleHTML:function(e){var a=jQuery(e),n="collapsible-"+t,i=IFS.collapsible.getLoadstateFromCookie(n);a.nextUntil("h2,h3").wrapAll('<div id="'+n+'" aria-hidden="'+!i+'">'),a.wrapInner('<button aria-expanded="'+i+'" aria-controls="'+n+'" type="button">'),t++},toggleCollapsible:function(e){var t=jQuery(e),a=jQuery("#"+t.attr("aria-controls")),n="false"===t.attr("aria-expanded");t.attr("aria-expanded",n),a.attr("aria-hidden",!n),IFS.collapsible.setLoadStateInCookie(a.attr("id"),n)},getLoadstateFromCookie:function(e){if("undefined"!=typeof Cookies.getJSON("collapsibleStates")){var t=Cookies.getJSON("collapsibleStates"),a=window.location.pathname;if("undefined"!=typeof t[a]&&"undefined"!=typeof t[a][e])return t[a][e]}return!1},setLoadStateInCookie:function(e,t){var a={};"undefined"!=typeof Cookies.getJSON("collapsibleStates")&&(a=Cookies.getJSON("collapsibleStates"));var n=window.location.pathname;"undefined"==typeof a[n]&&(a[n]={}),a[n][e]=t,Cookies.set("collapsibleStates",a,{expires:.05})}}}(),IFS.conditionalForms=function(){"use strict";return{init:function(){jQuery("label[data-target]").each(function(){var e=jQuery(this),t=e.attr("data-target"),a=e.find('input[type="radio"],input[type="checkbox"]'),n=!1;if(e.attr("data-target-inverted")&&(n=!0),a&&t){var i=a.attr("name");IFS.conditionalForms.toggleVisibility(a,"#"+t,n),jQuery('input[name="'+i+'"]').on("click",function(){IFS.conditionalForms.toggleVisibility(a,"#"+t,n)})}})},toggleVisibility:function(e,t,a){t=jQuery(t);var n=e.is(":checked");a&&(n=!n),n?t.attr("aria-hidden","false").removeClass("js-hidden"):t.attr("aria-hidden","true")}}}(),IFS.editor=function(){"use strict";var e,t;return{settings:{textareas:".textarea-wrapped textarea",htmlOptions:{format:!1,allowedTags:["p","em","strong","ol","ul","li","br","b","div"]}},init:function(){e=this.settings,t=new showdown.Converter;var a=jQuery(e.textareas);jQuery.each(a,function(){IFS.editor.prepareEditor(this)}),jQuery(".js-md-to-html").each(function(){var e=jQuery(this).html(),t=IFS.editor.markdownToHtml(e);jQuery(this).html(t)}),IFS.editor.initEditors(),IFS.editor.bindEditors()},prepareEditor:function(e){var t=jQuery(e),a="";jQuery('[for="'+t.attr("id")+'"]').length&&(a=jQuery('[for="'+t.attr("id")+'"]').attr("id")),t.attr("readonly")?t.before('<div class="readonly"></div>'):t.before('<div class="editor" spellcheck="true" aria-multiline="true" tabindex="0" '+a+' visirole="textbox"></div>'),t.attr("aria-hidden","true"),IFS.editor.processMarkdownToHtml(t,t.prev())},initEditors:function(){jQuery(".editor").hallo({plugins:{halloformat:{},hallolists:{},hallocleanhtml:e.htmlOptions},toolbar:"halloToolbarFixed"})},bindEditors:function(){jQuery(".editor").bind("hallomodified",function(e,t){var a=jQuery(this).next();IFS.editor.processHtmlToMarkdown(t.content,a),jQuery(a).trigger("keyup")})},processMarkdownToHtml:function(e,t){var a=e.val();if(IFS.editor.htmlToMarkdown(jQuery(t).html())!=a){var n=IFS.editor.markdownToHtml(a);jQuery(t).html(n)}},processHtmlToMarkdown:function(e,t){var a=IFS.editor.htmlToMarkdown(e);jQuery(t).get(0).value!=a&&(jQuery(t).get(0).value=a)},htmlToMarkdown:function(t){var a=jQuery.trim(t.replace(/(\r\n|\n|\r)/gm,""));return a=jQuery.htmlClean(a,e.htmlOptions),md(a)},markdownToHtml:function(a){var n;return n=0===a.length?"<p>&nbsp;</p>":t.makeHtml(a),n=jQuery.htmlClean(n,e.htmlOptions)}}}(),IFS.finance=function(){"use strict";return{MathOperation:{"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return 0===t?0:e/t}},init:function(){IFS.finance.bindCalculationActionToFields()},bindCalculationActionToFields:function(){jQuery("body").on("change","input",function(){jQuery("[data-calculation-fields]:not([data-calculation-binded])").length&&jQuery("[data-calculation-fields]:not([data-calculation-binded])").each(function(){var e=jQuery(this),t=e.attr("data-calculation-fields");jQuery(document).on("change updateFinances",t,function(){IFS.finance.doMath(e,t.split(","))}),e.attr("data-calculation-binded","")})}),jQuery("body").on("recalculateAllFinances",function(){jQuery("[data-calculation-fields]").length&&jQuery("[data-calculation-fields]").each(function(){var e=jQuery(this),t=e.attr("data-calculation-fields");IFS.finance.doMath(e,t.split(","))})})},getElementValue:function(e){var t=jQuery(e).attr("data-calculation-rawvalue");if("undefined"!=typeof t)return parseFloat(t);if("undefined"!=typeof jQuery(e).val()&&jQuery(e).val().length){var a=jQuery(e).val().replace(",",""),n=0===a.indexOf("£ ")?a.substring(2):a;return parseFloat(n)}return parseFloat(0)},doMath:function(e,t){var a=e.attr("data-calculation-operations").split(","),n=[];jQuery.each(t,function(e,t){jQuery.isNumeric(t)?n.push(parseFloat(t)):jQuery(t).length>1?jQuery.each(jQuery(t),function(e,t){n.push(IFS.finance.getElementValue(t))}):n.push(IFS.finance.getElementValue(t))});var i;if(i=1===n.length?n[0]:IFS.finance.MathOperation[a[0]](n[0],n[1]),1==a.length&&n.length>2)for(var o=2;o<n.length;o++)i=IFS.finance.MathOperation[a[0]](i,n[o]);else if(a.length>1&&n.length>2)for(var r=1;r<a.length;r++)i=IFS.finance.MathOperation[a[r]](i,n[r+1]);e.attr("data-calculation-rawvalue",i);var s=IFS.finance.formatCurrency(Math.round(i));e.is("input")?e.val(s):e.text(s),e.trigger("change")},formatCurrency:function(e){return e=parseFloat(e,10),e=e.toFixed(),e=e.replace(/(\d)(?=(\d{3})+\b)/g,"$1,"),"£ "+e.toString()}}}(),IFS.formValidation=function(){"use strict";var e;return{settings:{number:{fields:'[type="number"]:not([data-date])',messageInvalid:"This field should be a number"},min:{fields:"[min]",messageInvalid:"This field should be %min% or higher"},max:{fields:"[max]",messageInvalid:"This field should be %max% or lower"},passwordEqual:{field1:'[name="password"]',field2:'[name="retypedPassword"]',messageInvalid:"Passwords must match"},passwordPolicy:{fields:{password:'[name="password"],[name="retypedPassword"]',firstname:"#firstName",lastname:"#lastName"},messageInvalid:{lowercase:"Password must contain at least one lower case letter",uppercase:"Password must contain at least one upper case letter",number:"Password must contain at least one number",firstname:"Password should not contain your first name",lastname:"Password should not contain your last name",organisation:"Password should not contain your organisation name"}},email:{fields:'[type="email"]',messageInvalid:"Please enter a valid email address"},required:{fields:"[required]",messageInvalid:"This field cannot be left blank"},minlength:{fields:"[minlength]",messageInvalid:"This field should contain at least %minlength% characters"},maxlength:{fields:"[maxlength]",messageInvalid:"This field cannot contain more than %maxlength% characters"},date:{fields:".date-group input",messageInvalid:{invalid:"Please enter a valid date",future:"Please enter a future date"}},tel:{fields:'[type="tel"]',messageInvalid:"Please enter a valid phone number"},typeTimeout:1500,html5validationMode:!1},init:function(){e=this.settings,e.html5validationMode=IFS.formValidation.checkHTML5validationMode(),jQuery("body").on("change keyup",e.passwordEqual.field1+","+e.passwordEqual.field2,function(t){switch(t.type){case"keyup":clearTimeout(window.IFS.formValidation_timer),window.IFS.formValidation_timer=setTimeout(function(){IFS.formValidation.checkEqualPasswords(!0)},e.typeTimeout);break;default:IFS.formValidation.checkEqualPasswords(!0)}}),jQuery("body").on("change",e.passwordPolicy.fields.password,function(){IFS.formValidation.checkPasswordPolicy(jQuery(this),!0)}),jQuery("body").on("change",e.email.fields,function(){IFS.formValidation.checkEmail(jQuery(this),!0)}),jQuery("body").on("change",e.number.fields,function(){IFS.formValidation.checkNumber(jQuery(this),!0)}),jQuery("body").on("change",e.min.fields,function(){IFS.formValidation.checkMin(jQuery(this),!0)}),jQuery("body").on("change",e.max.fields,function(){IFS.formValidation.checkMax(jQuery(this),!0)}),jQuery("body").on("blur change",e.required.fields,function(){IFS.formValidation.checkRequired(jQuery(this),!0)}),jQuery("body").on("change",e.minlength.fields,function(){IFS.formValidation.checkMinLength(jQuery(this),!0)}),jQuery("body").on("change",e.maxlength.fields,function(){IFS.formValidation.checkMaxLength(jQuery(this),!0)}),jQuery("body").on("change",e.tel.fields,function(){IFS.formValidation.checkTel(jQuery(this),!0)}),jQuery("body").on("change",e.date.fields,function(){IFS.formValidation.checkDate(jQuery(this),!0)})},checkEqualPasswords:function(t){var a=jQuery(e.passwordEqual.field1),n=jQuery(e.passwordEqual.field2),i=IFS.formValidation.getErrorMessage(n,"passwordEqual");return a.length&&n.length&&a.val().length&&n.val().length?a.val()==n.val()?(t&&(IFS.formValidation.setValid(a,i),IFS.formValidation.setValid(n,i)),!0):(t&&(IFS.formValidation.setInvalid(a,i),IFS.formValidation.setInvalid(n,i)),!1):!1},checkPasswordPolicy:function(t,a){var n=t.val(),i=!0;if(n.length){var o=/(?=\S*?[A-Z])/;o.test(n)===!1?(a&&IFS.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid.uppercase),i=!1):a&&IFS.formValidation.setValid(t,e.passwordPolicy.messageInvalid.uppercase);var r=/(?=\S*?[a-z])/;r.test(n)===!1?(a&&IFS.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid.lowercase),i=!1):a&&IFS.formValidation.setValid(t,e.passwordPolicy.messageInvalid.lowercase);var s=/(?=\S*?[0-9])/;s.test(n)===!1?(a&&IFS.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid.number),i=!1):a&&IFS.formValidation.setValid(t,e.passwordPolicy.messageInvalid.number);var l=["firstname","lastname"];jQuery(l).each(function(o,r){var s=jQuery(e.passwordPolicy.fields[r]).val();s.replace(" ","").length&&(n.toLowerCase().indexOf(s.toLowerCase())>-1?(a&&IFS.formValidation.setInvalid(t,e.passwordPolicy.messageInvalid[r]),i=!1):a&&IFS.formValidation.setValid(t,e.passwordPolicy.messageInvalid[r]))})}return i},checkEmail:function(e,t){var a=e.val(),n=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i,i=IFS.formValidation.getErrorMessage(e,"email"),o=n.test(a);return o?(t&&IFS.formValidation.setValid(e,i),!0):(t&&IFS.formValidation.setInvalid(e,i),!1)},checkNumber:function(t,a){var n=IFS.formValidation.getErrorMessage(t,"number");if(e.html5validationMode){var i=t[0];return i.validity.valid===!1&&i.validity.badInput===!0?(a&&IFS.formValidation.setInvalid(t,n),!1):(a&&IFS.formValidation.setValid(t,n),!0)}return t.val()>0&&!jQuery.isNumeric(t.val())?(a&&IFS.formValidation.setInvalid(t,n),!1):(a&&IFS.formValidation.setValid(t,n),!0)},checkMax:function(t,a){var n=IFS.formValidation.getErrorMessage(t,"max");if(e.html5validationMode){var i=t[0];return i.validity.rangeOverflow===!0?(a&&IFS.formValidation.setInvalid(t,n),!1):(a&&IFS.formValidation.setValid(t,n),!0)}var o=parseInt(t.attr("max"),10);if(IFS.formValidation.checkNumber(t,!0)){var r=parseInt(t.val(),10);return r>o?(a&&IFS.formValidation.setInvalid(t,n),!1):(a&&IFS.formValidation.setValid(t,n),!0)}},checkMin:function(t,a){var n=IFS.formValidation.getErrorMessage(t,"min");if(e.html5validationMode){var i=t[0];return i.validity.rangeUnderflow===!0?(a&&IFS.formValidation.setInvalid(t,n),!1):(a&&IFS.formValidation.setValid(t,n),!0)}var o=parseInt(t.attr("min"),10);if(IFS.formValidation.checkNumber(t)){var r=parseInt(t.val(),10);return o>r?(a&&IFS.formValidation.setInvalid(t,n),!1):(a&&IFS.formValidation.setValid(t,n),!0)}},checkRequired:function(e,t){var a=IFS.formValidation.getErrorMessage(e,"required");return e.is(":checkbox")?e.prop("checked")?(t&&IFS.formValidation.setValid(e,a),!0):(t&&IFS.formValidation.setInvalid(e,a),!1):0===e.val().length?(t&&IFS.formValidation.setInvalid(e,a),!1):(t&&IFS.formValidation.setValid(e,a),!0)},checkMinLength:function(e,t){var a=IFS.formValidation.getErrorMessage(e,"minlength"),n=parseInt(e.attr("minlength"),10);return e.val().length<n?(t&&IFS.formValidation.setInvalid(e,a),!1):(t&&IFS.formValidation.setValid(e,a),!0)},checkMaxLength:function(e,t){var a=IFS.formValidation.getErrorMessage(e,"maxlength"),n=parseInt(e.attr("maxlength"),10);return e.val().length>n?(t&&IFS.formValidation.setInvalid(e,a),!1):(t&&IFS.formValidation.setValid(e,a),!0)},checkTel:function(e,t){var a=e.val(),n=IFS.formValidation.getErrorMessage(e,"tel"),i=/^(?=.*[0-9])[- +()0-9]+$/,o=i.test(a);return o?(t&&IFS.formValidation.setValid(e,n),!0):(t&&IFS.formValidation.setInvalid(e,n),!1)},checkDate:function(t,a){var n=t.closest(".date-group");t.addClass("js-visited");var i=n.find(".day input"),o=n.find(".month input"),r=n.find(".year input"),s=i.add(o).add(r),l=i.hasClass("js-visited")&&o.hasClass("js-visited")&&r.hasClass("js-visited"),d=i.val().length>0&&o.val().length>0&&r.val().length>0,u=IFS.formValidation.checkNumber(i,!1)&&IFS.formValidation.checkNumber(o,!1)&&IFS.formValidation.checkNumber(r,!1);if(u&&d){var c=parseInt(o.val(),10),m=parseInt(i.val(),10),f=parseInt(r.val(),10),p=new Date(f,c-1,m);if(p.getDate()==m&&p.getMonth()+1==c&&p.getFullYear()==f){if(a&&IFS.formValidation.setValid(s,e.date.messageInvalid.invalid),s.removeClass("js-autosave-disabled").attr("data-date",m+"-"+c+"-"+f),n.hasClass("js-future-date")){var g=new Date;return p>g?(a&&IFS.formValidation.setValid(s,e.date.messageInvalid.future),!0):(a&&IFS.formValidation.setInvalid(s,e.date.messageInvalid.future),!1)}return!0}return a&&IFS.formValidation.setInvalid(s,e.date.messageInvalid.invalid),s.addClass("js-autosave-disabled").attr("data-date",""),!1}return d||l?(a&&IFS.formValidation.setInvalid(s,e.date.messageInvalid.invalid),s.addClass("js-autosave-disabled").attr("data-date",""),!1):!1},getErrorMessage:function(t,a){var n=t.attr("data-"+a+"-errormessage");return"undefined"==typeof n&&(n=e[a].messageInvalid),-1!==n.indexOf("%"+a+"%")&&(n=n.replace("%"+a+"%",t.attr(a))),n},setInvalid:function(e,t){var a=e.closest(".form-group");if(a){e.addClass("field-error");var n=a.find('.error-message:contains("'+t+'")');if(0===n.length){a.addClass("error");var i='<span class="error-message">'+t+"</span>";a.find("legend,label").first().append(i)}}0===jQuery("ul.error-summary-list li:contains("+t+")").length&&jQuery(".error-summary-list").append("<li>"+t+"</li>"),jQuery(".error-summary").attr("aria-hidden",!1),jQuery(window).trigger("updateWysiwygPosition")},setValid:function(e,t){var a=e.closest(".form-group.error");a&&(a.find('.error-message:contains("'+t+'")').remove(),0===a.find(".error-message").length&&(a.removeClass("error"),e.removeClass("field-error"))),jQuery(".error-summary-list li:contains("+t+")").length&&jQuery(".error-summary-list li:contains("+t+")").remove(),0===jQuery(".error-summary-list li").length&&jQuery(".error-summary").attr("aria-hidden",!0),jQuery(window).trigger("updateWysiwygPosition")},checkHTML5validationMode:function(){var e=jQuery("input");return e.length?!!e[0].validity:void 0}}}(),IFS.mirrorElements=function(){"use strict";return{init:function(){jQuery("[data-mirror]").each(function(){var e=jQuery(this),t=e.attr("data-mirror");IFS.mirrorElements.updateElement(e,t),IFS.mirrorElements.bindMirrorElement(e,t)})},bindMirrorElement:function(e,t){jQuery(document).on("change",t,function(){IFS.mirrorElements.updateElement(e,this)})},updateElement:function(e,t){var a=IFS.mirrorElements.getSourceText(t);e.is("input")?e.val(a):e.text(a)},getSourceText:function(e){var t=jQuery(e);if(1==t.length){if(t.val().length)return t.val();if(t.text().length)return t.text()}return""}}}(),IFS.modal=function(){"use strict";var e;return{settings:{element:"[data-js-modal]"},init:function(){e=this.settings,IFS.modal.initButtonRole(),jQuery("body").on("click",e.element,function(e){IFS.modal.openModal(e)}),jQuery("body").on("click",".js-close",function(){IFS.modal.closeModal()}),jQuery(document).keyup(function(e){27===e.keyCode&&IFS.modal.closeModal()})},initButtonRole:function(){jQuery(e.element).is("a")&&jQuery(e.element).attr({role:"button",tabindex:"0"})},openModal:function(e){var t=jQuery(e.target).attr("data-js-modal");t=jQuery("."+t),t.length&&(e.preventDefault(),IFS.modal.disableTabPage(),t.add(".modal-overlay").attr("aria-hidden","false"),setTimeout(function(){var e=t.outerHeight();t.css({"margin-top":"-"+e/2+"px"})},50))},disableTabPage:function(){jQuery(":tabbable").each(function(){var e=jQuery(this);if(0===e.closest('[role="dialog"]').length){var t=0;e.prop("tabindex")&&(t=e.prop("tabindex")),e.prop("tabindex","-1").attr("data-original-tabindex",t)}})},enableTabPage:function(){jQuery("[data-original-tabindex]").each(function(){var e=jQuery(this),t=e.attr("data-original-tabindex");e.prop("tabindex",t).removeAttr("data-original-tabindex")})},closeModal:function(){IFS.modal.enableTabPage(),jQuery('[role="dialog"],.modal-overlay').attr("aria-hidden","true")}}}(),IFS.pieChart=function(){"use strict";var e;return{settings:{pieElement:".pie"},init:function(){e=this.settings,Modernizr.svg&&Modernizr.inlinesvg&&jQuery(e.pieElement).each(function(){IFS.pieChart.pieSVG(this)})},pieSVG:function(e){var t=parseFloat(e.textContent),a="http://www.w3.org/2000/svg",n=document.createElementNS(a,"svg"),i=document.createElementNS(a,"circle"),o=document.createElementNS(a,"title");i.setAttribute("r",16),i.setAttribute("cx",16),i.setAttribute("cy",16),i.setAttribute("stroke-dasharray",t+" 100"),n.setAttribute("viewBox","0 0 32 32"),o.textContent=e.textContent,e.textContent="",n.appendChild(o),n.appendChild(i),e.setAttribute("aria-hidden","true"),e.appendChild(n)}}}(),IFS.repeatableRows=function(){"use strict";return{init:function(){IFS.repeatableRows.backForwardCacheReload(),jQuery("body").on("click","[data-repeatable-rowcontainer]",function(e){e.preventDefault(),IFS.repeatableRows.backForwardCacheInvalidate(),IFS.repeatableRows.addRow(this,e)}),jQuery("body").on("click",".js-remove-row",function(e){IFS.repeatableRows.backForwardCacheInvalidate(),IFS.repeatableRows.removeRow(this,e)})},getAjaxUrl:function(e){var t="";if("undefined"!=typeof jQuery(e).val()&&"undefined"!=typeof jQuery(e).attr("name")&&1==jQuery("#application_id").length){var a=jQuery("#application_id").val();t=window.location.protocol+"//"+window.location.host+"/application/"+a+"/form/"+jQuery(e).attr("name")+"/"+jQuery(e).val()}return t},addRow:function(e,t){var a=IFS.repeatableRows.getAjaxUrl(e);a.length&&(t.preventDefault(),jQuery.ajaxProtected({url:a,beforeSend:function(){jQuery(e).before('<span class="form-hint">Adding a new row</span>')},cache:!1}).done(function(t){var a=jQuery(e).attr("data-repeatable-rowcontainer");jQuery(e).prev().remove(),jQuery(a).append(t),jQuery("body").trigger("updateSerializedFormState");var n=jQuery(t).find('[type="number"][name],[type="text"][name],[type="email"][name]').first().attr("name");"undefined"!=typeof n&&jQuery("[name="+n+"]").focus()}))},removeRow:function(e,t){var a=IFS.repeatableRows.getAjaxUrl(e);a.length&&(t.preventDefault(),jQuery.ajaxProtected({url:a}).done(function(t){t=jQuery.parseJSON(t),"OK"==t.status&&(jQuery("[data-repeatable-row="+jQuery(e).val()+"]").remove(),jQuery("body").trigger("recalculateAllFinances").trigger("updateSerializedFormState"))}))},backForwardCacheReload:function(){var e=jQuery("#cacheTest");""!==e.val()&&(jQuery("#cacheTest").val(""),window.location.reload())},backForwardCacheInvalidate:function(){jQuery("#cacheTest").val("cached")}}}(),IFS.unsavedChanges=function(){"use strict";var e;return{settings:{formelement:jQuery(".form-serialize-js")},init:function(){e=this.settings,IFS.unsavedChanges.initUnsavedChangesWarning(),IFS.unsavedChanges.updateSerializedFormState(),jQuery("body").on("updateSerializedFormState",function(){IFS.unsavedChanges.updateSerializedFormState()})},updateSerializedFormState:function(){e.formelement.data("serializedFormState",jQuery(".form-serialize-js").serialize())},initUnsavedChangesWarning:function(){var t=!1;e.formelement.on("submit",function(){t=!0}),jQuery(window).bind("beforeunload",function(a){var n=e.formelement.attr("data-test");n="undefined"!=typeof n&&n!==!1;var i=jQuery(".form-serialize-js").serialize()==jQuery(".form-serialize-js").data("serializedFormState");return t===!1&&i===!1&&n===!1?"Are you sure you want to leave this page? There are some unsaved changes...":void(a=null)})}}}(),IFS.upload=function(){"use strict";var e;return{settings:{uploadEl:'[type="file"][class="inputfile"]'},init:function(){e=this.settings,jQuery("body").on("change",e.uploadEl,function(){var e=jQuery(this).attr("id");jQuery('[data-for-file-upload="'+e+'"]').click()})}}}(),IFS.wordCount=function(){"use strict";var e;return{settings:{wordcountEl:".word-count textarea",typeTimeout:500},init:function(){e=this.settings,jQuery("body").on("change keyup",e.wordcountEl,function(t){"keyup"==t.type?(clearTimeout(window.IFS.wordcount_timer),window.IFS.wordcount_timer=setTimeout(function(){IFS.wordCount.updateWordCount(t.target)},e.typeTimeout)):IFS.wordCount.updateWordCount(t.target)})},updateWordCount:function(e){var t=jQuery(e),a=t.val();a=a.replace(/(\r\n|\n|\r)/gm," "),a=a.replace(/([[0-9]+\.\ |\*\ |\*\*|_)/gm,"");for(var n=jQuery.trim(a).split(" "),i=0,o=0;o<n.length;o++)n[o].length>0&&i++;var r=t.attr("data-max_words")-i,s=t.parents(".word-count").find(".count-down");s.html("Words remaining: "+r),0>r?s.removeClass("positive").addClass("negative"):s.removeClass("negative").addClass("positive")}}}(),IFS.application_page=function(){"use strict";return{init:function(){jQuery(document).on("click",'form.application-overview [name="assign_question"]',IFS.application_page.handleAssignQuestionFragmentReload)},handleAssignQuestionFragmentReload:function(e){var t,a=jQuery(this),n=a.closest("form.application-overview"),i=a.closest("li.section"),o=i.attr("id");return i.closest('section[id^="section-"]').length&&(t=i.closest('section[id^="section-"]').attr("id").replace("section-","")),i.length&&t&&o?(jQuery.ajaxProtected({type:"POST",beforeSend:function(){"function"==typeof IFS.progressiveSelect.hideAll&&IFS.progressiveSelect.hideAll(),i.find(".assign-button").html("Assigning to <strong>"+a.text()+"</strong>..."),i.find("img.section-status").remove()},url:"?singleFragment=true&sectionId="+t,data:n.serialize()+"&"+a.attr("name")+"="+a.attr("value"),success:function(e){var t=jQuery("<div>"+e+"</div>"),a=t.find("#"+o);if(i.replaceWith(a),"function"==typeof IFS.progressiveSelect.initDropDownHTML){var n=a.find(".assign-button"),r=a.find("select.prog-menu");IFS.progressiveSelect.initDropDownHTML(n),IFS.progressiveSelect.selectToListHTML(r)}}}),e.preventDefault(),!1):void 0}}}(),IFS.application_summary=function(){"use strict";var e;return{settings:{submitButton:"#submit-application-button",checkbox:"#agree-terms-page"},init:function(){e=this.settings,IFS.application_summary.handleChangeAgreeTermsCheckbox(),jQuery(document).on("change",e.checkbox,IFS.application_summary.handleChangeAgreeTermsCheckbox),jQuery("body").on("click",e.submitButton+"[aria-disabled]",function(e){e.preventDefault()})},disableButton:function(){var t=jQuery(e.submitButton),a=t.attr("data-js-modal");t.removeAttr("data-js-modal").attr({"data-js-modal-disabled":a,"aria-disabled":"true"}).addClass("disabled")},enableButton:function(){var t=jQuery(e.submitButton),a=t.attr("data-js-modal-disabled");t.removeAttr("data-js-modal-disabled aria-disabled").attr("data-js-modal",a).removeClass("disabled")},handleChangeAgreeTermsCheckbox:function(){jQuery(e.checkbox).prop("checked")?IFS.application_summary.enableButton():IFS.application_summary.disableButton()}}}(),IFS.assesment_feedback_page=function(){"use strict";return{init:function(){jQuery("body").on("change",'[id ^= "assessor-question-feedback-text-"],[data-feedback-value]',IFS.assesment_feedback_page.handleAssessorFeedbackUpdate),jQuery("body").on("keyup",'[id ^= "assessor-question-feedback-"]',IFS.assesment_feedback_page.registerKeyupCallback(IFS.assesment_feedback_page.handleAssessorFeedbackFieldChangeOnField,500))},registerKeyupCallback:function(e,t){return function(a){var n=jQuery(this),i=n.data("keyupListener");"undefined"!=typeof i&&window.clearTimeout(i),n.data("keyupListener",window.setTimeout(function(){e(n,a),n.data("keyupListener",null)},t))}},handleAssessorFeedbackFieldChangeOnField:function(e){var t=e.closest("form").attr("action"),a=e.closest("[data-response-id]"),n=a.attr("data-response-id"),i=a.find('[id ^= "assessor-question-feedback-text-"]').val(),o=a.find("[data-feedback-value]").val(),r=e.closest(".form-group"),s=r.find(".textarea-save-info"),l=(new Date).getTime();0===s.length&&(r.find(".textarea-footer").append('<span class="textarea-save-info" />'),s=r.find(".textarea-save-info")),jQuery.ajaxProtected({type:"PUT",url:t+"/response/"+n+"?feedbackText="+i+"&feedbackValue="+o,beforeSend:function(){s.html("Saving...")}}).done(function(e){var t=(new Date).getTime();"ok"==e.message?1500>t-l?setTimeout(function(){s.html("Saved!")},1500):s.html("Saved!"):s.html(e.message).css({color:"red"})})},handleAssessorFeedbackUpdate:function(){var e=jQuery(this);return IFS.assesment_feedback_page.handleAssessorFeedbackFieldChangeOnField(e)}}}(),IFS.assesment_submit_review_page=function(){"use strict";return{init:function(){IFS.assesment_submit_review_page.suitableForFundingChange(),IFS.assesment_submit_review_page.beforeSubmitCheck()},suitableForFundingChange:function(){jQuery("#suitable-for-funding").change(function(){var e=jQuery("#suitable-for-funding option:selected").val(),t=jQuery("#recommendation-feedback-group");e=t.show(),jQuery("#not-suitable-feedback").prop("required","no"==e)}).trigger("change")},beforeSubmitCheck:function(){jQuery("#submission_questions").submit(function(e){var t=jQuery("#suitable-for-funding option:selected").val(),a=""===jQuery("#not-suitable-feedback").val().trim();return"no"==t&&a?(e.preventDefault(),jQuery("#feedback-empty-error").text("Please justify your decision...").show(),!1):void jQuery("#feedback-empty-error").hide()})}}}(),IFS.competition_management=function(){"use strict";var e,t,a={};return{settings:{menu:jQuery(".info-area"),container:".competition-data form",breakpoint:1200,fundingDecisionSelects:".funding-decision",assessorFeedbackButton:"#publish-assessor-feedback",noJsAssessorFeedbackButton:"#publish-assessor-feedback-no-js",submitFundingDecisionButton:"#publish-funding-decision",
noJsSubmitFundingDecisionButton:"#no-js-notify-applicants",noJsSaveFundingDecisionButton:"#no-js-save-funding-decision",fundingDecisionForm:"#submit-funding-decision-form"},init:function(){t=this.settings,IFS.competition_management.getWindowWidth(),IFS.competition_management.getMenuHeight(),IFS.competition_management.getContainerHeight(),IFS.competition_management.handleCompetitionCode(),jQuery("body.competition-management.setup").on("change","#competitionTypeId",function(){IFS.competition_management.handleStateAid()}),jQuery("body.competition-management.setup").on("change",'[name="innovationSectorCategoryId"]',function(){IFS.competition_management.handleInnovationSector()}),jQuery(document).on("change",t.fundingDecisionSelects,IFS.competition_management.handleFundingDecisionSelectChange),IFS.competition_management.handleFundingDecisionEnableOrDisable(),IFS.competition_management.alterSubmitDecisionFormAction(),IFS.competition_management.stickyEnabled()&&(IFS.competition_management.getMenuWidth(),IFS.competition_management.getMenuOffset(),IFS.competition_management.getContainerOffset(),IFS.competition_management.menuPxToPercentage()),jQuery(window).resize(function(){clearTimeout(e),e=setTimeout(function(){IFS.competition_management.getMenuHeight(),IFS.competition_management.getMenuWidth(),IFS.competition_management.getContainerHeight(),IFS.competition_management.getWindowWidth(),IFS.competition_management.menuPxToPercentage(),IFS.competition_management.stickyScroll()},250)}),jQuery(document).scroll(function(){IFS.competition_management.stickyScroll()})},getWindowWidth:function(){a.windowWidth=jQuery(window).width()},getMenuOffset:function(){a.menuOffsetTop=t.menu.offset().top},getMenuWidth:function(){a.menuWidth=t.menu.width()},getMenuHeight:function(){a.menuHeight=t.menu.outerHeight()},getContainerHeight:function(){a.containerHeight=jQuery(t.container).outerHeight(!0)},getContainerOffset:function(){a.containerOffsetTop=jQuery(t.container).offset().top},stickyEnabled:function(){return t.breakpoint<a.windowWidth&&a.menuHeight<a.containerHeight},menuPxToPercentage:function(){a.menuPercentage=parseFloat(a.menuWidth/a.windowWidth*100).toFixed(2)},stickyScroll:function(){if(IFS.competition_management.stickyEnabled()){var e=jQuery(document).scrollTop();if(a.menuHeight+e>a.containerHeight+a.containerOffsetTop){var n=a.containerHeight+a.containerOffsetTop-a.menuHeight;t.menu.addClass("bottom").removeClass("sticky").css({top:n+"px",width:a.menuPercentage+"%"})}else a.menuOffsetTop<e?t.menu.addClass("sticky").css({top:"0",width:a.menuPercentage+"%"}).removeClass("bottom"):t.menu.removeClass("sticky bottom").removeAttr("style")}else t.menu.removeClass("sticky bottom").removeAttr("style")},disableFundingDecisonButton:function(){var e=jQuery(t.submitFundingDecisionButton),a=e.attr("data-js-modal");e.on("click",function(e){e.preventDefault()}),e.removeAttr("data-js-modal").attr({"data-js-modal-disabled":a,"aria-disabled":"true"}).addClass("disabled")},enableFundingDecisionButton:function(){var e=jQuery(t.submitFundingDecisionButton),a=e.attr("data-js-modal-disabled");e.off("click").removeAttr("data-js-modal-disabled aria-disabled").attr("data-js-modal",a).removeClass("disabled")},alterSubmitDecisionFormAction:function(){var e=jQuery(t.fundingDecisionForm),a=e.attr("action");e.attr("action",a+"submit")},allSelectsDecided:function(){var e=jQuery(t.fundingDecisionSelects);if(null===e||void 0===e||0===e.length)return!1;var a=!0;return e.each(function(){var e=jQuery(this).val(),t="Y"===e||"N"===e;t||(a=!1)}),a},handleFundingDecisionSelectChange:function(){IFS.competition_management.handleFundingDecisionEnableOrDisable();var e=jQuery(this),t=e.attr("name"),a=e.attr("competition"),n=e.val();IFS.competition_management.saveFundingDecision(a,t,n)},handleFundingDecisionEnableOrDisable:function(){IFS.competition_management.allSelectsDecided()?IFS.competition_management.enableFundingDecisionButton():IFS.competition_management.disableFundingDecisonButton()},saveFundingDecision:function(e,t,a){var n=jQuery("#funding-decision-save-info-"+t);jQuery.ajaxProtected({type:"POST",url:"/management/funding/"+e,data:{applicationId:t,fundingDecision:a},dataType:"json",beforeSend:function(){n.html("Saving...")}}).done(function(e){"true"==e.success?n.html("Saved!"):n.html("Not saved.")}).error(function(){n.html("Not saved.")})},handleCompetitionCode:function(){jQuery(document).on("click","#generate-code",function(){var e=jQuery(this),t=jQuery("#openingDate .day input").val(),a=jQuery("#openingDate .month input").val(),n=jQuery("#openingDate .year input").val(),i=e.closest(".form-group");if(jQuery("#openingDate").hasClass("error")===!1&&t.length&&a.length&&n.length){i.removeClass("error"),i.find("label .error-message").remove();var o=e.val(),r=window.location.protocol+"//"+window.location.host+"/management/competition/setup/"+o+"/generateCompetitionCode?day="+t+"&month="+a+"&year="+n;jQuery.ajaxProtected({type:"GET",url:r,success:function(t){t=t.replace(/"/g,""),e.closest(".form-group").find("input").val(t),e.remove()}})}else i.addClass("error"),0===i.find(".error-message").length&&i.find("label").append('<span class="error-message">Please fill in a correct date before generating the competition code</span>')})},handleInnovationSector:function(){var e=jQuery('[name="innovationSectorCategoryId"]').val(),t=window.location.protocol+"//"+window.location.host+"/management/competition/setup/getInnovationArea/"+e;jQuery.ajaxProtected({type:"GET",url:t,success:function(e){var t=jQuery('[name="innovationAreaCategoryId"]');t.children().remove(),jQuery.each(e,function(){t.append('<option value="'+this.id+'">'+this.name+"</option>")}),t.trigger("change")}})},handleStateAid:function(){var e=jQuery("#competitionTypeId").find('[value="'+jQuery("#competitionTypeId").val()+'"]').attr("data-stateaid");e="true"==e?"yes":"no",jQuery("#stateAid").attr("aria-hidden","false").find("p").html('<span class="'+e+'">'+e+"</span>")}}}(),IFS.financeSpecifics=function(){"use strict";var e;return{settings:{funderOrgFeedback:{funderOrgsizeInputs:'[name="financePosition-organisationSize"]',fundingLevelInput:"#cost-financegrantclaim",orgToFundingMapping:{SMALL:70,MEDIUM:60,LARGE:50}},administrationCostTotal:{adminSupportCosts:'[name*="overheads-type"]',supportCostInTotal:{NONE:"#section-total-10-labour-cost-none",DEFAULT_PERCENTAGE:"#section-total-10-default",CUSTOM_RATE:"#section-total-10-custom"},allTotals:'[id*="section-total-10"]',totalCostInHeaders:'[data-mirror="#section-total-10"]'}},init:function(){e=this.settings,IFS.financeSpecifics.initFunderOrgSizeFeedback(),IFS.financeSpecifics.initAdministrationCostTotal(),IFS.financeSpecifics.initOtherFunding()},initAdministrationCostTotal:function(){jQuery(e.administrationCostTotal.adminSupportCosts+":checked").each(function(){IFS.financeSpecifics.resetOtherAdministrationTotal(this),IFS.financeSpecifics.placeRightAdministrationTotalInHeader(this)}),jQuery(document).on("change",e.administrationCostTotal.adminSupportCosts,function(){IFS.financeSpecifics.resetOtherAdministrationTotal(this),IFS.financeSpecifics.placeRightAdministrationTotalInHeader(this)})},placeRightAdministrationTotalInHeader:function(t){var a=jQuery(t).val(),n="undefined"!=typeof e.administrationCostTotal.supportCostInTotal[a]?e.administrationCostTotal.supportCostInTotal[a]:!1,i=jQuery(e.administrationCostTotal.totalCostInHeaders);n&&i.length&&(IFS.mirrorElements.updateElement(i,n),jQuery(document).off("change",e.administrationCostTotal.allTotals).on("change",n,function(){IFS.mirrorElements.updateElement(i,this)}))},resetOtherAdministrationTotal:function(t){var a=jQuery(t).closest("[data-target]"),n=jQuery("#"+jQuery(a).attr("data-target")),i=a.prevAll("[data-target]").add(a.nextAll("[data-target]"));i.each(function(){var t=jQuery("#"+jQuery(this).attr("data-target")),a=t.find(e.administrationCostTotal.allTotals),n=a.attr("id");a.attr("data-old-id",n).removeAttr("id").val("£ 0").attr("data-calculation-rawvalue",0)}),n.find("[data-old-id]").each(function(){var e=jQuery(this).attr("data-old-id");jQuery(this).attr("id",e).removeAttr("data-old-id"),jQuery("#section-total-9").trigger("updateFinances")})},initFunderOrgSizeFeedback:function(){jQuery("body").on("change",e.funderOrgFeedback.funderOrgsizeInputs,function(){var t=jQuery(this).val(),a=jQuery(e.funderOrgFeedback.fundingLevelInput);if(a.length&&"undefined"!=typeof e.funderOrgFeedback.orgToFundingMapping[t]){a.attr("max",e.funderOrgFeedback.orgToFundingMapping[t]).removeClass("field-error");var n=a.closest(".form-group");n.removeClass("error"),n.find(".error-message").remove(),setTimeout(function(){a.trigger("change")},1e3)}})},initOtherFunding:function(){jQuery("#otherFundingShowHideToggle").on("change",'[data-target] input[type="radio"]',function(){setTimeout(function(){jQuery("[id*=fundingAmount]").trigger("updateFinances")},0)})}}}(),IFS.invites=function(){"use strict";var e;return{settings:{formid:".contributorsForm",inputs:".contributorsForm input",addRow:".contributorsForm .add-another-row",removeRow:".contributorsForm .remove-another-row",addOrg:'[name="add_partner"]',partnerName:".js-partner-name"},init:function(){e=this.settings,jQuery("body").on("change",e.inputs,function(){IFS.invites.saveToCookie()}),jQuery("body").on("click",e.addRow,function(e){IFS.invites.addRow(e)}),jQuery("body").on("click",e.removeRow,function(e){IFS.invites.removeRow(e)}),jQuery("body").on("click",e.addOrg,function(e){IFS.invites.addOrg(e)}),jQuery("body").on("keyup",e.partnerName,function(e){IFS.invites.parterNameInHeader(e.target)}),jQuery(e.partnerName).each(function(){IFS.invites.parterNameInHeader(this)})},saveToCookie:function(){var t=jQuery(e.formid).serialize();jQuery.ajaxProtected({url:window.location.href,method:"POST",dataType:"json",data:t})},addRow:function(e){e.preventDefault();var t=jQuery(e.target).closest("[data-invite-org]"),a=t.index(),n=t.find("[data-invite-row]").length,i='<tr data-invite-row>                        <td class="form-group">                          <label for="organisations'+a+".invites"+n+'.personName"><span class="visuallyhidden">Name</span></label>                          <input type="text" id="organisations'+a+".invites"+n+'.personName" class="form-control width-full" value="" placeholder="name" name="organisations['+a+"].invites["+n+'].personName"  />                        </td>                        <td class="form-group">                          <label for="organisations'+a+".invites"+n+'.email"><span class="visuallyhidden">Email</span></label>                          <input type="email" class="form-control width-full" value="" placeholder="name@company.co.uk" name="organisations['+a+"].invites["+n+'].email"  />                        </td>                        <td class="alignright"><button value="'+a+"_"+n+'" name="remove_person" type="submit" class="remove-another-row buttonlink">Remove</button></td>                      </tr>';t.find("tbody").append(i),jQuery('[id="organisations'+a+".invites"+n+'.personName"]').focus(),IFS.invites.saveToCookie()},addOrg:function(e){e.preventDefault();var t=jQuery("[data-invite-org]"),a=t.length,n='<li data-invite-org>                      <h2 class="heading-medium">Partner Organisation<span></span></h2>                      <div class="form-group">                        <label for="organisations'+a+'.organisationName" class="form-label"><span>Organisation Name</span></label>                        <input type="text" id="organisations'+a+'.organisationName" value="" name="organisations['+a+'].organisationName"  placeholder="Name of the partner company" class="form-control js-partner-name" />                      </div>                          <table>                              <thead><tr>                                  <th>Applicant name</th>                                  <th>Email</th>                                  <th>&nbsp;</th>                              </tr></thead>                              <tbody>                              <tr data-invite-row>                                  <td class="form-group">                                      <label for="organisations'+a+'.invites0.personName"><span class="visuallyhidden">Name</span></label>                                      <input type="text" value="" id="organisations'+a+'.invites0.personName" name="organisations['+a+'].invites[0].personName"  placeholder="name" class="form-control width-full" />                                  </td>                                  <td class="form-group">                                      <label for="organisations'+a+'.invites0.email"><span class="visuallyhidden">Email</span></label>                                      <input type="email" value="" id="organisations'+a+'.invites0.email" name="organisations['+a+'].invites[0].email" placeholder="name@company.co.uk" class="form-control width-full" />                                  </td>                                  <td class="alignright"><button value="'+a+'_0" name="remove_person" type="submit" class="remove-another-row buttonlink">Remove</button></td>                              </tr>                              </tbody>                          </table>                          <p class="alignright">                              <button value="'+a+'" name="add_person" type="submit" class="add-another-row buttonlink">Add person</button>                          </p>                      </li>';t.last().after(n),jQuery('[id="organisations'+a+'.organisationName"]').focus(),IFS.invites.saveToCookie()},recountRows:function(){jQuery("[data-invite-org]").each(function(e,t){jQuery(t).find('[name*="organisations["]').each(function(){var t=jQuery(this).attr("name").split(".");t[0]="organisations["+e+"]",t=t.join("."),jQuery(this).attr("name",t)}),jQuery(t).find("[data-invite-row]").each(function(e,t){jQuery(t).find('[name*="invites["]').each(function(){var t=jQuery(this).attr("name").split(".");t[1]="invites["+e+"]",t=t.join("."),jQuery(this).attr("name",t)})})}),IFS.invites.saveToCookie()},removeRow:function(e){e.preventDefault();var t=jQuery(e.target);1==t.closest("[data-invite-org]").find("tbody tr").length?t.closest("[data-invite-org]").remove():t.closest("tr").remove(),IFS.invites.recountRows()},parterNameInHeader:function(e){var t=jQuery(e),a=t.closest("[data-invite-org]").children("h2");0===a.children("span").length&&a.append(" <span></span>");var n=t.val().length?'"'+t.val()+'"':"";a.children("span").text(n)}}}();var IFSLoader={common:{init:function(){IFS.collapsible.init(),IFS.conditionalForms.init(),IFS.wordCount.init(),IFS.editor.init(),IFS.formValidation.init()},finalize:function(){IFS.progressiveSelect.init(),IFS.pieChart.init(),IFS.modal.init(),IFS.upload.init(),IFS.autoSubmitForm.init()}},"app-form":{init:function(){IFS.mirrorElements.init(),IFS.unsavedChanges.init(),IFS.autoSave.init(),IFS.finance.init(),IFS.repeatableRows.init(),IFS.financeSpecifics.init()}},"app-details":{init:function(){IFS.application_page.init()}},"app-summary":{init:function(){IFS.application_summary.init()}},"assessment-details":{init:function(){IFS.assesment_feedback_page.init()}},"assessment-submit-review":{init:function(){IFS.assesment_submit_review_page.init()}},"app-invite":{init:function(){IFS.invites.init()}},"competition-management":{init:function(){IFS.competition_management.init()}}},UTIL=function(){"use strict";return{fire:function(e,t,a){var n=IFSLoader;t=void 0===t?"init":t,""!==e&&n[e]&&"function"==typeof n[e][t]&&n[e][t](a)},loadEvents:function(){var e=document.body.id;UTIL.fire("common"),jQuery.each(document.body.className.split(/\s+/),function(t,a){UTIL.fire(a),UTIL.fire(a,e)}),UTIL.fire("common","finalize")}}}();jQuery(document).ready(function(){UTIL.loadEvents()});