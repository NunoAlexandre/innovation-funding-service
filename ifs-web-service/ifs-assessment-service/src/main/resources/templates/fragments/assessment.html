<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">


<!-- ======== Assessment - pagination ======= -->
<div th:fragment="assessment-pagination">
    <nav class="pagination" th:unless="${#strings.isEmpty(navigation.previousUrl) and #strings.isEmpty(navigation.nextUrl)}">
        <ul>
            <li class="prev" th:unless="${#strings.isEmpty(navigation.previousUrl)}">
                <a th:href="@{${navigation.previousUrl}}" rel="prev" title="Navigate to previous part">
                    <span class="pagination-label">Previous</span>
                    <span class="pagination-part-title" th:text="${navigation.previousText}" />
                </a>
            </li>
            <li class="next" th:unless="${#strings.isEmpty(navigation.nextUrl)}">
                <a th:href="@{${navigation.nextUrl}}" rel="next" title="Navigate to next part">
                    <span class="pagination-label">Next</span>
                    <span class="pagination-part-title" th:text="${navigation.nextText}" />
                </a>
            </li>
        </ul>
    </nav>
</div>


<!-- ======== Assessment - sub header back to assessment overview ======= -->
<div th:fragment="assessment-header-sub">
    <div class="sub-header">
        <nav>
            <a th:if="${linkTitle != null and linkUrl != null}" th:class="${linkClass != null ? linkClass : ''}" th:href="${linkUrl}" th:text="${linkTitle}" />
        </nav>
        <div class="deadline" th:if="${daysPercentage != null and daysLeft != null}">Days left to submit&nbsp;&nbsp;
            <div th:include="fragments/elements :: pie-small" th:with="daysPercentage=${daysPercentage},daysLeft=${daysLeft}" th:remove="tag" />
        </div>
    </div>
</div>


<!-- =================== Application details ============================== -->
<div th:fragment="application_details (currentApplication, applicationOrganisations, pendingOrganisationNames, leadOrganisation)" th:remove="tag">
    <div class="grid-row">
        <div class="column-half">
            <h3 class="heading-small">Project title</h3>
            <p th:text="${currentApplication.name}" />
            <h3 class="heading-small">Lead organisation</h3>
            <p th:text="${leadOrganisation.name}" />
            <h3 class="heading-small">Partners</h3>
            <ul class="list-bullet">
                <li th:each="organisation : ${applicationOrganisations}" th:unless="${organisation.equals(leadOrganisation)}">
                    <span th:text="${organisation.getName()}"></span>
                </li>
                <li th:each="pendingOrganisationName : ${pendingOrganisationNames}">
                    <span th:text="${pendingOrganisationName}"></span>
                    <small>(pending)</small>
                </li>
            </ul>
        </div>
        <div class="column-half">
            <h3 class="heading-small">Project timescales</h3>
            <p>Project start date:<br/>
            <span th:if="${currentApplication.getStartDate() != null}" th:text="${#temporals.format(currentApplication.getStartDate(), 'd/M/yyyy')}" th:remove="tag" />
            </p>
            <p>Duration:<br/><span th:remove="tag" th:text="${currentApplication.getDurationInMonths()}" /> months</p>
        </div>
    </div>
</div>


<!-- ======== Assessment - assessor summary section ======= -->
<div th:fragment="assessment-summary-section (question)">
    <h2>
        <span th:text="${question.displayLabel}" />
        <div th:if="${question.isComplete()}" class="section-status section-complete">Complete</div>
        <div th:unless="${question.isComplete()}" class="section-status section-incomplete">Incomplete</div>

        <div class="section-score" th:if="${question.scoreFormInputExists}">
            Score:
            <span th:text="|${question.scoreGiven}/${question.scorePossible}|" th:if="${question.scoreGiven}" th:remove="tag" />
            <span th:unless="${question.scoreGiven}" th:remove="tag">N/A</span>
        </div>
    </h2>
    <div class="question">
        <div class="form-group">
            <p th:text="${question.feedback}" />
            <p><a th:href="@{/{id}/question/{quid}(id=${assessmentId}, quid=${question.questionId})}">Return to this question in the application</a></p>
            <p th:unless="${question.applicationInScope == null}" class="assessor-score alignright">
              <span class="score">In scope: <strong th:text="${question.applicationInScope} ? 'Yes' : 'No'" /></span>
            </p>
        </div>
    </div>
</div>


<!-- ======== Assessment - assessor summary total score ======= -->
<div th:fragment="assessment-summary-total-score(totalGiven, totalPossible, totalPercentage)">
    <div class="extra-margin alignright">
        <p class="no-margin">
            <strong>Total: <span th:text="${totalGiven}" th:remove="tag">0</span>/<span th:text="${totalPossible}" th:remove="tag">100</span></strong>
        </p>
        <p>
            <strong><span th:text="${totalPercentage}+'%'" th:remove="tag">0%</span></strong>
        </p>
    </div>
</div>


<!-- ======== Assessor - reject competition modal ======= -->
<div th:fragment="assessor-reject-competition-modal (inviteHash)">
    <div class="reject-competition-modal" role="dialog" aria-hidden="true">
        <div th:include="fragments/modals :: close-button" th:remove="tag" />
        <div th:include="fragments/assessment :: assessor-reject-competition-form (inviteHash=${inviteHash})" th:remove="tag" />
    </div>
</div>


<!-- ======== Assessor - reject competition form for modal and non-js page ======= -->
<div th:fragment="assessor-reject-competition-form (inviteHash)">
    <form action="#" th:action="@{/invite/competition/{inviteHash}/reject(inviteHash=${inviteHash})}" method="post" th:object="${form}" novalidate="novalidate">
        <div class="error-summary" th:if="${#fields.hasErrors('global')}">
            <h2 class="heading-medium error-summary-heading">We were unable to reject the competition:</h2>
            <ul class="error-summary-list">
                <li th:each="err : ${#fields.globalErrors()}" th:text="${err}"></li>
            </ul>
        </div>

        <div class="form-group" th:classappend="${#fields.hasErrors('rejectReason')}? error">
            <label class="form-label" th:for="${#ids.next('rejectReason')}">
                Please select a reason for rejecting the competition
                <span th:if="${#fields.hasErrors('rejectReason')}" th:remove="tag">
                    <span class="error-message"  th:each="err : ${#fields.errors('rejectReason')}" th:text="${err}" />
                </span>
            </label>
            <select class="form-control" th:errorclass="field-error" required="required" th:field="*{rejectReason}">
                <option value="">Select a reason</option>
                <option th:each="reason : ${rejectionReasons}"
                        th:value="${reason.id}"
                        th:text="${reason.reason}"
                        value="1">Not available</option>
            </select>
        </div>
        <div class="form-group word-count" th:classappend="${#fields.hasErrors('rejectComment')}? error">
            <label class="form-label" th:for="${#ids.next('rejectComment')}">
                Use this space to provide more information
                <span th:if="${#fields.hasErrors('rejectComment')}" th:remove="tag">
                    <span class="error-message"  th:each="err : ${#fields.errors('rejectComment')}" th:text="${err}" />
                </span>
            </label>
            <textarea
                class="form-control width-full"
                data-max_words="100"
                data-maxwordslength="100"
                data-maxwordslength-errormessage="Maximum word count exceeded. Please reduce your word count to 100."
                th:errorclass="field-error"
                rows="4"
                th:field="*{rejectComment}"></textarea>
            <div class="textarea-footer" th:with="rejectComment=*{rejectComment}">
                <div th:include="question-type/form-elements :: form-word-count (maxWords=100, currentWordsLeft=${#ifsUtil.wordsRemaining(100, rejectComment)})" th:remove="tag"/>
            </div>
        </div>
        <button class="button large button-warning extra-margin" name="submit-app-details">Reject</button>
    </form>
</div>


<!-- ======== Assessment - reject assessment modal ======= -->
<div th:fragment="assessment-reject-assesment-modal (assessmentId)">
    <div class="reject-assesment-modal" role="dialog" aria-hidden="true">
        <div th:include="fragments/modals :: close-button" th:remove="tag" />

        <div th:include="fragments/assessment :: assessment-reject-application-form (assessmentId=${assessmentId})" th:remove="tag" />
    </div>
</div>


<!-- ======== Assessment - reject assessment form for modal and non-js page ======= -->
<div th:fragment="assessment-reject-application-form (assessmentId)">
    <form action="#" th:action="@{/{assessmentId}/reject(assessmentId=${assessmentId})}" method="post" th:object="${form}" novalidate="novalidate">
        <div class="error-summary" th:if="${#fields.hasErrors('global')}">
            <h2 class="heading-medium error-summary-heading">We were unable to reject the assessment:</h2>
            <ul class="error-summary-list">
                <li th:each="err : ${#fields.errors('global')}" th:text="${err}"></li>
            </ul>
        </div>

        <div class="form-group" th:classappend="${#fields.hasErrors('rejectReason')}? error">
            <label class="form-label" th:for="rejectReason">
                Please select a reason for rejecting the application
                <span th:if="${#fields.hasErrors('rejectReason')}" th:remove="tag">
                    <span data-errorfield="rejectReason" class="error-message"  th:each="err : ${#fields.errors('rejectReason')}" th:text="${err}" />
                </span>
            </label>
            <select class="form-control" th:errorclass="field-error" required="required" data-required-errormessage="Please enter a reason" th:field="*{rejectReason}">
                <option value="">Select a reason</option>
                <option value="conflict-of-interest">Conflict of interest</option>
                <option value="not-my-area-of-interest">Not my area of expertise</option>
                <option value="too-many-assessments">Too many assessments</option>
            </select>
        </div>
        <div class="form-group word-count" th:classappend="${#fields.hasErrors('rejectComment')}? error">
            <label class="form-label" th:for="rejectComment">
                Use this space to provide more information
                <span th:if="${#fields.hasErrors('rejectComment')}" th:remove="tag">
                    <span data-errorfield="rejectComment" class="error-message"  th:each="err : ${#fields.errors('rejectComment')}" th:text="${err}" />
                </span>
            </label>
            <textarea
                class="form-control width-full"
                data-max_words="100"
                data-maxwordslength="100"
                data-maxwordslength-errormessage="Maximum word count exceeded. Please reduce your word count to 100."
                th:errorclass="field-error"
                rows="4"
                th:field="*{rejectComment}"></textarea>
            <div class="textarea-footer" th:with="rejectComment=*{rejectComment}">
                <div th:include="question-type/form-elements :: form-word-count (maxWords=100, currentWordsLeft=${#ifsUtil.wordsRemaining(100, rejectComment)})" th:remove="tag"/>
            </div>
        </div>
        <button class="button large button-warning extra-margin" name="submit-app-details">Reject</button>
    </form>
</div>


</html>
