if("undefined"==typeof IFS)var IFS={};IFS.competition_management={},IFS.competition_management.loadOrder={common:{init:function(){IFS.competition_management.various.init()}}},IFS.competition_management.various=function(){"use strict";var e,n,t={};return{settings:{menu:jQuery(".info-area"),container:".competition-data form",breakpoint:1200,fundingDecisionSelects:".funding-decision",assessorFeedbackButton:"#publish-assessor-feedback",noJsAssessorFeedbackButton:"#publish-assessor-feedback-no-js",submitFundingDecisionButton:"#publish-funding-decision",noJsSubmitFundingDecisionButton:"#no-js-notify-applicants",noJsSaveFundingDecisionButton:"#no-js-save-funding-decision",fundingDecisionForm:"#submit-funding-decision-form"},init:function(){n=this.settings,IFS.competition_management.getWindowWidth(),IFS.competition_management.getMenuHeight(),IFS.competition_management.getContainerHeight(),IFS.competition_management.handleCompetitionCode(),jQuery("body.competition-management.competition-setup").on("change","#competitionTypeId",function(){IFS.competition_management.handleStateAid()}),jQuery("body.competition-management.competition-setup").on("change",'[name="innovationSectorCategoryId"]',function(){IFS.competition_management.handleInnovationSector()}),jQuery(document).on("change",n.fundingDecisionSelects,IFS.competition_management.handleFundingDecisionSelectChange),IFS.competition_management.handleFundingDecisionEnableOrDisable(),IFS.competition_management.alterSubmitDecisionFormAction(),IFS.competition_management.stickyEnabled()&&(IFS.competition_management.getMenuWidth(),IFS.competition_management.getMenuOffset(),IFS.competition_management.getContainerOffset(),IFS.competition_management.menuPxToPercentage()),jQuery(window).resize(function(){clearTimeout(e),e=setTimeout(function(){IFS.competition_management.getMenuHeight(),IFS.competition_management.getMenuWidth(),IFS.competition_management.getContainerHeight(),IFS.competition_management.getWindowWidth(),IFS.competition_management.menuPxToPercentage(),IFS.competition_management.stickyScroll()},250)}),jQuery(document).scroll(function(){IFS.competition_management.stickyScroll()})},getWindowWidth:function(){t.windowWidth=jQuery(window).width()},getMenuOffset:function(){t.menuOffsetTop=n.menu.offset().top},getMenuWidth:function(){t.menuWidth=n.menu.width()},getMenuHeight:function(){t.menuHeight=n.menu.outerHeight()},getContainerHeight:function(){t.containerHeight=jQuery(n.container).outerHeight(!0)},getContainerOffset:function(){t.containerOffsetTop=jQuery(n.container).offset().top},stickyEnabled:function(){return n.breakpoint<t.windowWidth&&t.menuHeight<t.containerHeight},menuPxToPercentage:function(){t.menuPercentage=parseFloat(t.menuWidth/t.windowWidth*100).toFixed(2)},stickyScroll:function(){if(IFS.competition_management.stickyEnabled()){var e=jQuery(document).scrollTop();if(t.menuHeight+e>t.containerHeight+t.containerOffsetTop){var i=t.containerHeight+t.containerOffsetTop-t.menuHeight;n.menu.addClass("bottom").removeClass("sticky").css({top:i+"px",width:t.menuPercentage+"%"})}else t.menuOffsetTop<e?n.menu.addClass("sticky").css({top:"0",width:t.menuPercentage+"%"}).removeClass("bottom"):n.menu.removeClass("sticky bottom").removeAttr("style")}else n.menu.removeClass("sticky bottom").removeAttr("style")},disableFundingDecisonButton:function(){var e=jQuery(n.submitFundingDecisionButton),t=e.attr("data-js-modal");e.on("click",function(e){e.preventDefault()}),e.removeAttr("data-js-modal").attr({"data-js-modal-disabled":t,"aria-disabled":"true"}).addClass("disabled")},enableFundingDecisionButton:function(){var e=jQuery(n.submitFundingDecisionButton),t=e.attr("data-js-modal-disabled");e.off("click").removeAttr("data-js-modal-disabled aria-disabled").attr("data-js-modal",t).removeClass("disabled")},alterSubmitDecisionFormAction:function(){var e=jQuery(n.fundingDecisionForm),t=e.attr("action");e.attr("action",t+"submit")},allSelectsDecided:function(){var e=jQuery(n.fundingDecisionSelects);if(null===e||void 0===e||0===e.length)return!1;var t=!0;return e.each(function(){var e=jQuery(this).val(),n="Y"===e||"N"===e;n||(t=!1)}),t},handleFundingDecisionSelectChange:function(){IFS.competition_management.handleFundingDecisionEnableOrDisable();var e=jQuery(this),n=e.attr("name"),t=e.attr("competition"),i=e.val();IFS.competition_management.saveFundingDecision(t,n,i)},handleFundingDecisionEnableOrDisable:function(){IFS.competition_management.allSelectsDecided()?IFS.competition_management.enableFundingDecisionButton():IFS.competition_management.disableFundingDecisonButton()},saveFundingDecision:function(e,n,t){var i=jQuery("#funding-decision-save-info-"+n);jQuery.ajaxProtected({type:"POST",url:"/management/funding/"+e,data:{applicationId:n,fundingDecision:t},dataType:"json",beforeSend:function(){i.html("Saving...")}}).done(function(e){"true"==e.success?i.html("Saved!"):i.html("Not saved.")}).error(function(){i.html("Not saved.")})},handleCompetitionCode:function(){jQuery(document).on("click","#generate-code",function(){var e=jQuery(this),n=jQuery("#openingDate .day input").val(),t=jQuery("#openingDate .month input").val(),i=jQuery("#openingDate .year input").val(),o=e.closest(".form-group");if(jQuery("#openingDate").hasClass("error")===!1&&n.length&&t.length&&i.length){o.removeClass("error"),o.find("label .error-message").remove();var a=e.val(),c=window.location.protocol+"//"+window.location.host+"/management/competition/setup/"+a+"/generateCompetitionCode?day="+n+"&month="+t+"&year="+i;jQuery.ajaxProtected({type:"GET",url:c,success:function(n){n=n.replace(/"/g,""),e.closest(".form-group").find("input").val(n),e.remove()}})}else o.addClass("error"),0===o.find(".error-message.correct-date-error-message").length&&o.find("label").append('<span class="error-message correct-date-error-message">Please fill in a correct date before generating the competition code</span>')})},handleInnovationSector:function(){var e=jQuery('[name="innovationSectorCategoryId"]').val();if("undefined"!=typeof e){var n=window.location.protocol+"//"+window.location.host+"/management/competition/setup/getInnovationArea/"+e;jQuery.ajaxProtected({type:"GET",url:n,success:function(e){var n=jQuery('[name="innovationAreaCategoryId"]');n.children().remove(),jQuery.each(e,function(){n.append('<option value="'+this.id+'">'+this.name+"</option>")}),n.trigger("change")}})}},handleStateAid:function(){var e=jQuery("#competitionTypeId").find('[value="'+jQuery("#competitionTypeId").val()+'"]').attr("data-stateaid");e="true"==e?"yes":"no",jQuery("#stateAid").attr("aria-hidden","false").find("p").html('<span class="'+e+'">'+e+"</span>")}}}();