
<!-- =================== Comp setup section - Initial Details (1) ============================== -->
<th:block th:fragment="section-initial">
    <div class="page-title">
        <h1 class="heading-xlarge">Initial details</h1>
    </div>
    <div class="panel-indent">
        This will create a new Competition - you will be able to specify more details as you proceed
    </div>

    <form th:action="@{(${editable} ? '' : 'initial/edit')}"
          data-autosave="compSetup" th:attr="data-competition=${competition.id}" data-section="initial"
          method="post" th:object="${competitionSetupForm}" novalidate="novalidate">

        <fieldset th:if="${editable}" id="section-1-edit">

            <legend class="visuallyhidden">Initial details</legend>
            <div th:class="${#fields.hasErrors('title')}? 'form-group error':'form-group'">
                <label class="form-label" for="competitionSetupForm.title">
                    <span class="form-label-bold">Competition title</span>
                    <span th:if="${#fields.hasErrors('title')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('title')}" th:text="${err}" />
                    </span>
                </label>
                <input th:class="${#fields.hasErrors('title') ? 'form-control field-error width-x-large' : 'form-control width-x-large'}"
                       type="text"
                       th:field="${competitionSetupForm.title}"
                       required="required"
                       data-required-errormessage="Please enter a title" />
            </div>

            <div th:class="${#fields.hasErrors('competitionTypeId')}? 'form-group error':'form-group'">
                <label class="form-label" for="competitionTypeId">
                    <span class="form-label-bold">Competition type</span>
                    <span th:if="${#fields.hasErrors('competitionTypeId')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('competitionTypeId')}" th:text="${err}" />
                    </span>
                </label>
                <select class="form-control width-x-large" th:disabled="${!#strings.isEmpty(restrictInitialDetailsEdit)}" name="competitionTypeId" id="competitionTypeId" required="required" data-required-errormessage="Please select a competition type">
                    <option value="" disabled="disabled" th:selected="${competitionSetupForm.competitionTypeId == null}">Please select &hellip;</option>
                    <option th:each="(competitionType : ${competitionTypes})" th:if="${competitionType.active}" th:attr="data-stateaid=${competitionType.stateAid}" th:text="${competitionType.name}"  th:value="${competitionType.id}" th:selected="${competitionSetupForm.competitionTypeId == competitionType.id}">Competition Type</option>
                </select>
                <input th:if="${!#strings.isEmpty(restrictInitialDetailsEdit)}" type="hidden" th:field="${competitionSetupForm.competitionTypeId}" />

            </div>


            <div th:class="${#fields.hasErrors('innovationSectorCategoryId')}? 'form-group error':'form-group'">
                <label class="form-label" for="innovationSectorCategoryId">
                    <span class="form-label-bold">Innovation sector</span>
                    <span th:if="${#fields.hasErrors('innovationSectorCategoryId')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('innovationSectorCategoryId')}" th:text="${err}" />
                    </span>
                </label>

                <select class="form-control width-x-large" id="innovationSectorCategoryId" name="innovationSectorCategoryId" required="required"
                        data-required-errormessage="Please select an innovation sector"
                        data-autosave-disabled="">
                    <option value="" disabled="disabled" th:selected="${competitionSetupForm.innovationSectorCategoryId == null}">Please select &hellip;</option>
                    <option th:each="(innovationSector : ${innovationSectors})" th:text="${innovationSector.name}" th:value="${innovationSector.id}" th:selected="${competitionSetupForm.innovationSectorCategoryId == innovationSector.id}">Innovation Sector</option>
                </select>
            </div>

            <div th:class="${#fields.hasErrors('innovationAreaCategoryId')}? 'form-group error':'form-group'">
                <label class="form-label" for="innovationAreaCategoryId">
                    <span class="form-label-bold">Innovation area</span>
                    <span th:if="${#fields.hasErrors('innovationAreaCategoryId')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('innovationAreaCategoryId')}" th:text="${err}" />
                    </span>
                </label>
                <select class="form-control width-x-large" name="innovationAreaCategoryId" id="innovationAreaCategoryId" required="required" data-required-errormessage="Please select an innovation area">
                    <option th:if="${competitionSetupForm.innovationAreaCategoryId == null}" value="" disabled="disabled" th:selected="${competitionSetupForm.innovationAreaCategoryId == null}">Please select &hellip;</option>
                    <option th:each="(innovationArea : ${innovationAreas})" th:text="${innovationArea.name}" th:value="${innovationArea.id}" th:selected="${competitionSetupForm.innovationAreaCategoryId == innovationArea.id}">Innovation Area</option>
                </select>
            </div>


            <fieldset>
                <div id="openingDate" th:class="${#fields.hasErrors('openingDate*')}? 'form-group error':'form-group'">
                  <h3 class="heading-small no-margin">Opening date</h3>
                  <legend>
                      <span class="visuallyhidden">Opening date</span>
                      <span th:if="${#fields.hasErrors('openingDate*')}" th:remove="tag">
                            <span class="error-message"  th:each="err : ${#fields.errors('openingDate*')}" th:text="${err}" />
                      </span>
                  </legend>
                  <div class="date-group" data-future-date="">
                      <input type="hidden" name="openingDate" />
                      <div class="day">
                          <label class="form-label" for="competitionSetupForm.openingDateDay">
                              <div>Day</div>
                          </label>
                          <input th:class="${#fields.hasErrors('openingDateDay') ? 'form-control field-error width-extra-small' : 'form-control width-extra-small'}"
                                 type="number"
                                 placeholder="DD"
                                 required="required"
                                 data-required-errormessage="Please enter an opening day"
                                 th:disabled="${!#strings.isEmpty(restrictInitialDetailsEdit)}"
                                 th:field="${competitionSetupForm.openingDateDay}" />
                          <input th:if="${!#strings.isEmpty(restrictInitialDetailsEdit)}" type="hidden" th:field="${competitionSetupForm.openingDateDay}" />
                      </div>

                      <div class="month">
                          <label class="form-label" for="competitionSetupForm.openingDateMonth">
                              <span>Month</span>
                          </label>
                          <input th:class="${#fields.hasErrors('openingDateMonth') ? 'form-control field-error width-extra-small' : 'form-control width-extra-small'}"
                                 type="number"
                                 placeholder="MM"
                                 required="required"
                                 data-required-errormessage="Please enter an opening month"
                                 th:disabled="${!#strings.isEmpty(restrictInitialDetailsEdit)}"
                                 th:field="${competitionSetupForm.openingDateMonth}" />
                          <input th:if="${!#strings.isEmpty(restrictInitialDetailsEdit)}" type="hidden" th:field="${competitionSetupForm.openingDateMonth}" />
                      </div>

                      <div class="year">
                          <label class="form-label" for="competitionSetupForm.openingDateYear">
                              <span>Year</span>
                          </label>
                          <input th:class="${#fields.hasErrors('openingDateYear') ? 'form-control field-error width-extra-small' : 'form-control width-extra-small'}"
                                 type="number"
                                 placeholder="YYYY"
                                 required="required"
                                 data-required-errormessage="Please enter an opening year"
                                 th:disabled="${!#strings.isEmpty(restrictInitialDetailsEdit)}"
                                 th:field="${competitionSetupForm.openingDateYear}" />
                          <input th:if="${!#strings.isEmpty(restrictInitialDetailsEdit)}" type="hidden" th:field="${competitionSetupForm.openingDateYear}" />
                      </div>
                  </div>
                </div>
            </fieldset>

            <div th:class="${#fields.hasErrors('leadTechnologistUserId')}? 'form-group error':'form-group'">
                <label class="form-label" for="leadTechnologistUserId">
                    <span class="form-label-bold">Competition Innovation Lead</span>
                    <span th:if="${#fields.hasErrors('leadTechnologistUserId')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('leadTechnologistUserId')}" th:text="${err}" />
                    </span>
                </label>
                <select class="form-control width-x-large" name="leadTechnologistUserId" id="leadTechnologistUserId" required="required" data-required-errormessage="Please select an Innovation Lead">
                    <option value="" th:selected="${competitionSetupForm.leadTechnologistUserId == null}" disabled="disabled">Please select &hellip;</option>
                    <option th:each="(competitionLeadTechUser : ${competitionLeadTechUsers})" th:text="${competitionLeadTechUser.name}" th:value="${competitionLeadTechUser.id}" th:selected="${competitionSetupForm.leadTechnologistUserId == competitionLeadTechUser.id}">Innovation Lead</option>
                </select>
            </div>

            <div th:class="${#fields.hasErrors('executiveUserId')}? 'form-group error':'form-group'">
                <label class="form-label" for="executiveUserId">
                    <span class="form-label-bold">Competition executive</span>
                    <span th:if="${#fields.hasErrors('executiveUserId')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('executiveUserId')}" th:text="${err}" />
                    </span>
                </label>
                <select class="form-control width-medium" name="executiveUserId" id="executiveUserId" required="required" data-required-errormessage="Please select a competition executive">
                    <option value="" disabled="disabled" th:selected="${competitionSetupForm.executiveUserId == null}">Please select &hellip;</option>
                    <option th:each="(competitionExecutiveUser : ${competitionExecutiveUsers})" th:text="${competitionExecutiveUser.name}" th:value="${competitionExecutiveUser.id}" th:selected="${competitionSetupForm.executiveUserId == competitionExecutiveUser.id}">User</option>
                </select>
            </div>




            <div class="form-group" th:attr="aria-hidden=${competitionSetupForm.competitionTypeId == null ? 'true' : 'false'}" id="stateAid">
                <h3 class="heading-small">State aid</h3>
                <p>
                  <span th:each="(competitionType : ${competitionTypes})" th:remove="tag">
                      <span class="yes" th:if="${competitionSetupForm.competitionTypeId == competitionType.id and competitionType.stateAid == true}">Yes</span>
                      <span class="no" th:if="${competitionSetupForm.competitionTypeId == competitionType.id and competitionType.stateAid == false}">No</span>
                  </span>
                </p>
            </div>

            <button class="button">Done</button>
        </fieldset>

        <fieldset th:if="${!editable}" id="section-1-">

            <dl class="standard-definition-list">
                <dt>Competition title</dt>
                <dd th:text="${competitionSetupForm.title}"></dd>

                <dt>Competition type</dt>
                <dd th:each="(competitionType : ${competitionTypes})" th:text="${competitionType.name}"  th:if="${competitionType.id == competitionSetupForm.competitionTypeId}">Competition Type</dd>

                <dt>Innovation sector</dt>
                <dd th:each="(innovationSector : ${innovationSectors})" th:if="${innovationSector.id == competitionSetupForm.innovationSectorCategoryId}" th:text="${innovationSector.name}">Innovation Sector</dd>

                <dt>Innovation area</dt>
                <dd th:each="(innovationArea : ${innovationAreas})" th:if="${competitionSetupForm.innovationAreaCategoryId == innovationArea.id}" th:text="${innovationArea.name}">Innovation Area</dd>

                <dt>Opening date</dt>
                <dd th:text="${competitionSetupForm.openingDateDay+'/'+competitionSetupForm.openingDateMonth+'/'+competitionSetupForm.openingDateYear}"></dd>

                <dt>Competition Innovation Lead</dt>
                <dd th:each="(competitionLeadTechUser : ${competitionLeadTechUsers})" th:text="${competitionLeadTechUser.name}" th:if="${competitionLeadTechUser.id == competitionSetupForm.leadTechnologistUserId}">Innovation Lead</dd>

                <dt>Competition executive</dt>
                <dd th:each="(competitionExecutiveUser : ${competitionExecutiveUsers})" th:text="${competitionExecutiveUser.name}" th:if="${competitionSetupForm.executiveUserId == competitionExecutiveUser.id}">User</dd>

               <dt>State aid</dt>
                <dd>
                    <span th:each="(competitionType : ${competitionTypes})" th:remove="tag">
                        <span class="yes" th:if="${competitionSetupForm.competitionTypeId == competitionType.id and competitionType.stateAid == true}">Yes</span>
                        <span class="no" th:if="${competitionSetupForm.competitionTypeId == competitionType.id and competitionType.stateAid == false}">No</span>
                    </span>
                </dd>
               </dl>

            <button type="submit" class="button">Edit</button>
        </fieldset>

    </form>
    <ul class="pagination" th:if="${isInitialComplete}">
        <li class="next">
            <a rel="next" title="Navigate to next part" th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='additional')}">
                <span class="pagination-label">Next</span>
                <span class="pagination-part-title">Funding information</span>
            </a>
        </li>
    </ul>


</th:block>

<!-- =================== Comp setup section - Additional info (2) ============================== -->
<th:block th:fragment="section-additional">
    <div class="page-title">
        <h1 class="heading-xlarge">Funding information</h1>
    </div>

    <form data-autosave="compSetup" th:attr="data-competition=${competition.id}" data-section="additional"
          th:action="@{(${editable} ? '' : 'additional/edit')}" method="post" th:object="${competitionSetupForm}" novalidate="novalidate">

        <div class="error-summary" th:attr="aria-hidden=${!#fields.hasAnyErrors()}">
            <h2 class="heading-medium error-summary-heading">
                Unable to save section
            </h2>

            <ul class="error-summary-list">
                <li th:each="err : ${#fields.allErrors()}" th:text="${err}"></li>
            </ul>
        </div>

        <fieldset th:if="${editable}">
            <legend class="visuallyhidden">Funding information</legend>
            <div class="grid-row">
                <div class="column-half">
                    <div class="form-group">
                        <span class="form-label-bold">Funder</span>
                    </div>
                </div>

                <div class="column-half">
                    <div class="form-group">
                        <span class="form-label-bold">Budget</span>
                    </div>
                </div>
            </div>

            <div th:each="(funder, iteration : ${competitionSetupForm.funders})" class="grid-row funder-row" th:id="'funder-row-'+${iteration.index}">
                <div class="column-half">
                    <div th:class="${#fields.hasErrors('funders[__${iteration.index}__].funder')}? 'form-group error':'form-group'">
                        <label class="form-label" th:for="funders[__${iteration.index}__].funder">
                            <th:block th:if="${#fields.hasErrors('funders[__${iteration.index}__].funder')}">
                                <span class="error-message"  th:each="err : ${#fields.errors('funders[__${iteration.index}__].funder')}" th:text="${err}" />
                            </th:block>
                        </label>
                        <input required="required" class="form-control width-x-large"
                               th:class="${#fields.hasErrors('funders[__${iteration.index}__].funder') ? 'form-control field-error width-x-large' : 'form-control width-x-large'}"
                               th:field="${competitionSetupForm.funders[__${iteration.index}__].funder}"
                               data-maxlength-errormessage="Funder has a maximum length of 255 characters"
                               data-required-errormessage="Please enter a funder name" />
                    </div>
                </div>

                <div class="column-half">
                    <div th:class="${#fields.hasErrors('funders[__${iteration.index}__].funderBudget')}? 'form-group error':'form-group'">
                        <label class="form-label" th:for="funders[__${iteration.index}__].funderBudget">
                            <th:block th:if="${#fields.hasErrors('funders[__${iteration.index}__].funderBudget')}">
                                <span class="error-message"  th:each="err : ${#fields.errors('funders[__${iteration.index}__].funderBudget')}" th:text="${err}" />
                            </th:block>
                        </label>
                        <input required="required" type="number" min="0"
                               th:class="${#fields.hasErrors('funders[__${iteration.index}__].funderBudget') ? 'form-control field-error width-x-large' : 'form-control width-x-large'}"
                               th:id="${iteration.index}+'-funderBudget'"
                               th:field="${competitionSetupForm.funders[__${iteration.index}__].funderBudget}" value=""
                               data-required-errormessage="Please enter a budget"
                               data-min-errormessage="Please enter a valid number"/>
                        <input type="hidden"
                               th:field="${competitionSetupForm.funders[__${iteration.index}__].coFunder}"
                               th:value="${iteration.index != 0}"/>

                        <button th:if="${iteration.index != 0}" class="buttonlink alignright remove-funder" name="remove-funder" th:value="${iteration.index}"
                                th:id="'remove-funder-' + ${iteration.index}">Remove</button>
                    </div>
                </div>
            </div>


            <div class="grid-row" id="dynamic-row-pointer">
                <div class="column-half">
                    &nbsp;
                </div>
                <div class="column-half">
                    <p class="heading-small no-margin">Total: <span data-calculation-operations="+" data-calculation-fields="input[id*=funderBudget]" th:text="${competitionSetupForm.totalFunding == 0 ? '' : '&pound;' + #numbers.formatDecimal(competitionSetupForm.totalFunding, 0, 'COMMA', 0, 'POINT')}">£0</span></p>

                    <div class="alignright">
                        <input type="hidden" name="removeFunder" />
                        <input type="hidden" name="funderCount" id="co-funder-count" th:value="${competitionSetupForm.fundersCount}" />
                        <button class="buttonlink" name="add-cofunder" id="add-cofunder">+Add co-funder</button>
                    </div>
                </div>
            </div>

            <hr />

            <fieldset>
                <legend class="heading-medium">Reporting fields</legend>

                <div th:class="${#fields.hasErrors('pafNumber')}? 'form-group error':'form-group'">
                    <label class="form-label" for="pafNumber">
                        <span class="form-label-bold">PAF number</span>
                    <span th:if="${#fields.hasErrors('pafNumber')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('pafNumber')}" th:text="${err}" />
                    </span>
                    </label>
                    <input th:class="${#fields.hasErrors('pafNumber') ? 'form-control field-error width-large' : 'form-control width-large'}"
                           type="text"
                           th:field="${competitionSetupForm.pafNumber}"
                           required="required"
                           data-required-errormessage="Please enter a PAF number" />
                </div>

                <div th:class="${#fields.hasErrors('budgetCode')}? 'form-group error':'form-group'">
                    <label class="form-label" for="budgetCode">
                        <span class="form-label-bold">Budget code</span>
                    <span th:if="${#fields.hasErrors('budgetCode')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('budgetCode')}" th:text="${err}" />
                    </span>
                    </label>
                    <input th:class="${#fields.hasErrors('budgetCode') ? 'form-control field-error width-large' : 'form-control width-large'}"
                           type="text"
                           th:field="${competitionSetupForm.budgetCode}"
                           required="required"
                           data-required-errormessage="Please enter a budget code" />
                </div>


                <div th:class="${#fields.hasErrors('activityCode')}? 'form-group error':'form-group'">
                    <label class="form-label" for="competitionSetupForm.activityCode">
                        <span class="form-label-bold">Activity code</span>
                        <span th:if="${#fields.hasErrors('activityCode')}" th:remove="tag">
                            <span class="error-message"  th:each="err : ${#fields.errors('activityCode')}" th:text="${err}" />
                        </span>
                    </label>
                    <input th:class="${#fields.hasErrors('activityCode') ? 'form-control field-error width-large' : 'form-control width-large'}"
                    type="text" required="required"
                    th:field="${competitionSetupForm.activityCode}"
                    maxlength="255"
                    data-maxlength-errormessage="Activity code has a maximum length of 255 characters"
                           data-required-errormessage="Please enter an activity code" />

                </div>

                <div th:class="${#fields.hasErrors('competitionCode')}? 'form-group error':'form-group'">
                    <label class="form-label" for="competitionCode">
                        <span class="form-label-bold">Competition code</span>
                    <span th:if="${#fields.hasErrors('competitionCode')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('competitionCode')}" th:text="${err}" />
                    </span>
                    </label>
                    <input readonly="readonly"
                           th:class="${#fields.hasErrors('competitionCode') ? 'form-control field-error width-large' : 'form-control width-large'}"
                           type="text"
                           name="competitionCode"
                           th:value="${competitionSetupForm.competitionCode}"
                           required="required"
                           data-required-errormessage="Please generate a competition code"
                           data-autosave-disabled="data-autosave-disabled" />
                    <button class="button button-secondary" th:if="${#strings.isEmpty(competitionSetupForm.competitionCode)}" type="submit" name="generate-code" id="generate-code" th:value="${competition.id}">Generate code</button>
                </div>
            </fieldset>

            <button class="button">Done</button>
        </fieldset>

        <fieldset th:if="${!editable}" id="section-2-">
            <table>
                <thead>
                <tr>
                    <th scope="col">Funder</th>
                    <th scope="col" class="numeric">Budget</th>
                </tr>
                </thead>
                <tfoot>
                <tr>
                    <th>Total</th>
                    <td class="numeric" th:text="${competitionSetupForm.totalFunding == 0 ? '' : '&pound;' + #numbers.formatDecimal(competitionSetupForm.totalFunding, 0, 'COMMA', 0, 'POINT')}">Total</td>
                </tr>
                </tfoot>
                <tbody>
                <tr  th:each="(funder, iteration : ${competitionSetupForm.funders})">
                    <th:block th:if="iteration == 0">
                        <td th:text="${funder.funder}">Funder Name</td>
                        <td class="numeric" th:text="${'&pound;' + #numbers.formatDecimal(funder.funderBudget, 0, 'COMMA', 0, 'POINT')}">Funder Budget</td>
                    </th:block>
                    <th:block th:unless="iteration == 0">
                        <td th:text="${funder.funder}">Co-Funder Name</td>
                        <td class="numeric" th:text="${'&pound;' + #numbers.formatDecimal(funder.funderBudget, 0, 'COMMA', 0, 'POINT')}">Co-Funder Budget</td>
                    </th:block>
                </tr>
                </tbody>
            </table>

            <dl class="standard-definition-list extra-margin">
                <dt>PAF number</dt>
                <dd th:text="${competitionSetupForm.pafNumber}">PAF Number</dd>
                <dt>Budget code</dt>
                <dd th:text="${competitionSetupForm.budgetCode}">Budget Code</dd>
                <dt>Activity code</dt>
                <dd th:text="${competitionSetupForm.activityCode}">Activity Code</dd>
                <dt>Competition code</dt>
                <dd th:text="${competitionSetupForm.competitionCode}">Competition Code</dd>
            </dl>

            <button type="submit" class="button">Edit</button>
        </fieldset>

    </form>
    <ul class="pagination">
        <li class="prev">
            <a rel="prev" title="Navigate to next part" th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='initial')}">
                <span class="pagination-label">Previous</span>
                <span class="pagination-part-title">Initial details</span>
            </a>
        </li>
        <li class="next">
            <a rel="next" title="Navigate to next part" th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='eligibility')}">
                <span class="pagination-label">Next</span>
                <span class="pagination-part-title">Eligibility</span>
            </a>
        </li>
    </ul>
</th:block>

<!-- =================== Comp setup section - Eligibility (3) ============================== -->
<th:block th:fragment="section-eligibility">
    <div class="page-title">
        <h1 class="heading-xlarge">Eligibility</h1>
    </div>

    <form th:action="@{(${editable} ? '' : 'eligibility/edit')}" method="post" th:object="${competitionSetupForm}" novalidate="novalidate"
          th:attr="data-competition=${competition.id}" data-autosave="compSetup" data-section="eligibility">

        <fieldset th:if="${editable}" id="section-3-edit">

            <legend class="visuallyhidden">Eligibility</legend>

            <!-- INFUND-5682 : Competition streams options have been hidden rather than removed, since they will be required when new competition types are added -->
            <div style="display: none">
                <div th:class="${#fields.hasErrors('multipleStream')}? 'form-group error':'form-group'">
                    <fieldset class="inline">
                        <legend>
                            <!--<span class="form-label-bold">Stream</span>-->
                            <span class="form-label-bold">Does the competition have multiple streams?</span>
                            <span th:if="${#fields.hasErrors('multipleStream')}" th:remove="tag">
                                  <span class="error-message"  th:each="err : ${#fields.errors('multipleStream')}" th:text="${err}" />
                            </span>
                        </legend>
                        <label class="block-label" for="comp-stream-yes" data-target="competition-stream-name-fields">
                            <input id="comp-stream-yes" value="yes" type="radio" th:field="*{multipleStream}" required="required" data-required-errormessage="Please select a stream option"></input>
                        Yes
                        </label>
                        <label class="block-label" for="comp-stream-no">
                            <input id="comp-stream-no" value="no" type="radio" th:field="*{multipleStream}" required="required" data-required-errormessage="Please select a stream option"></input>
                        No
                        </label>
                    </fieldset>
                </div>

                <div id="competition-stream-name-fields" class="form-group js-hidden"  th:classappend="${#fields.hasErrors('streamName')}? 'error':''">
                    <fieldset class="inline">
                        <legend>
                            <label class="form-label" for="streamName">
                                <span class="form-label-bold">Stream name</span>
                                <span th:if="${#fields.hasErrors('streamName')}" th:remove="tag">
                                      <span class="error-message"  th:each="err : ${#fields.errors('streamName')}" th:text="${err}" />
                                </span>
                            </label>
                        </legend>

                        <input th:class="${#fields.hasErrors('streamName') ? 'form-control field-error width-x-large' : 'form-control width-x-large'}"
                               type="text"
                               th:field="*{streamName}"
                               maxlength="255"
                               required="required"
                               data-required-errormessage="A stream name is required"
                               data-maxlength-errormessage="Stream name has a maximum length of 255 characters" />
                    </fieldset>
                </div>
            </div>

            <div th:class="${#fields.hasErrors('singleOrCollaborative')}? 'form-group error':'form-group'">
                <fieldset class="inline">
                    <legend>
                        <span class="form-label-bold">Please choose the project type.</span>
                        <!--<span class="hint">Is this a single or collaborative project?</span>-->
	                    <span th:if="${#fields.hasErrors('singleOrCollaborative')}" th:remove="tag">
	                          <span class="error-message"  th:each="err : ${#fields.errors('singleOrCollaborative')}" th:text="${err}" />
	                    </span>
                    </legend>

                    <label th:each="collaborationLevel : ${collaborationLevels}" class="block-label" th:for="${'single-or-collaborative-' + collaborationLevel.code}">
                        <input th:id="${'single-or-collaborative-' + collaborationLevel.code}" name="singleOrCollaborative" th:value="${collaborationLevel.code}" type="radio" th:checked="${competitionSetupForm.singleOrCollaborative == collaborationLevel.code}" required="required" data-required-errormessage="Please select a collaboration level"></input>
                        <span th:text="${collaborationLevel.name}" th:remove="tag" />
                    </label>
                </fieldset>
            </div>



            <div th:class="${#fields.hasErrors('researchCategoryId')}? 'form-group error':'form-group'">
		        <fieldset class="inline">
		            <legend>
			            <span class="form-label-bold">Please choose the research categories.</span>
			            <span th:if="${#fields.hasErrors('researchCategoryId')}" th:remove="tag">
	                          <span class="error-message"  th:each="err : ${#fields.errors('researchCategoryId')}" th:text="${err}" />
	                    </span>
	                </legend>

		            <label class="block-label selected" th:each="researchCategory : ${researchCategories}" th:for="${'research-categories-' + researchCategory.id}">
		                <input th:value="${researchCategory.id}" type="checkbox" name="researchCategoryId" th:id="${'research-categories-' + researchCategory.id}" th:checked="${competitionSetupForm.includesResearchCategory(researchCategory.id)}" required="required" data-required-errormessage="Please select at least one research category" />
		                <span th:text="${researchCategory.name}" th:remove="tag" />
		            </label>
		        </fieldset>
		    </div>



            <div th:class="${#fields.hasErrors('leadApplicantType')}? 'form-group error':'form-group'">
               <fieldset class="inline">
					<legend>
					   <span class="form-label-bold">Lead applicant</span>
					   <span class="hint">Select the lead applicant type required.</span>
					   <span th:if="${#fields.hasErrors('leadApplicantType')}" th:remove="tag">
			             <span class="error-message"  th:each="err : ${#fields.errors('leadApplicantType')}" th:text="${err}" />
					   </span>
					</legend>

					 <label th:each="leadApplicantType : ${leadApplicantTypes}" class="block-label" th:for="${'lead-applicant-type-' + leadApplicantType.code}">
					    <input th:id="${'lead-applicant-type-' + leadApplicantType.code}" name="leadApplicantType" th:value="${leadApplicantType.code}" type="radio" th:checked="${competitionSetupForm.leadApplicantType == leadApplicantType.code}" required="required" data-required-errormessage="Please select a lead applicant type" />
					    <span th:text="${leadApplicantType.name}" th:remove="tag" />
					 </label>
				</fieldset>
            </div>

            <div th:class="${#fields.hasErrors('researchParticipationAmountId')}? 'form-group error':'form-group'">
                <fieldset class="inline">
	                <legend>
	                    <span class="form-label-bold">Research participation</span>
	                    <span class="hint">This indicates the maximum level of research participation allowed.</span>
	                    <span th:if="${#fields.hasErrors('researchParticipationAmountId')}" th:remove="tag">
	                          <span class="error-message"  th:each="err : ${#fields.errors('researchParticipationAmountId')}" th:text="${err}" />
	                    </span>
	                </legend>
	                <select class="form-control width-large" name="researchParticipationAmountId" id="researchParticipation" required="required" data-required-errormessage="Please select a research participation percentage" >
	                    <option th:each="researchParticipationAmount : ${researchParticipationAmounts}" th:text="${researchParticipationAmount.name}" th:value="${researchParticipationAmount.id}" th:selected="${competitionSetupForm.researchParticipationAmountId == researchParticipationAmount.id}">Research participation</option>
	                </select>
                </fieldset>
            </div>

            <div th:class="${#fields.hasErrors('resubmission')}? 'form-group error':'form-group'">
                <fieldset class="inline">
                    <legend>
                        <span class="form-label-bold">Are resubmissions allowed?</span>
                        <span class="hint">Are applicants able to resubmit an application?</span>
		                <span th:if="${#fields.hasErrors('resubmission')}" th:remove="tag">
		                      <span class="error-message"  th:each="err : ${#fields.errors('resubmission')}" th:text="${err}" />
		                </span>
                    </legend>
                    <label class="block-label" for="comp-resubmissions-yes">
                        <input id="comp-resubmissions-yes" value="yes" type="radio" th:field="*{resubmission}" required="required" data-required-errormessage="Please select a resubmission option"></input>
                        Yes
                    </label>
                    <label class="block-label" for="comp-resubmissions-no">
                        <input id="comp-resubmissions-no" value="no" type="radio" th:field="*{resubmission}" required="required" data-required-errormessage="Please select a resubmission option"></input>
                        No
                    </label>
                </fieldset>
            </div>

            <button class="button">Done</button>
        </fieldset>

        <fieldset th:if="${!editable}" id="section-3-">

            <dl class="standard-definition-list">
                <!-- INFUND-5682 : Competition streams options have been hidden rather than removed, since they will be required when new competition types are added -->
                <div style="display: none">
                    <dt>Multiple Stream</dt>
                    <dd th:text="${#strings.capitalize(competitionSetupForm.multipleStream)}"></dd>

                    <div th:if="${'yes' == competitionSetupForm.multipleStream}" th:remove="tag">
                        <dt>Stream name</dt>
                        <dd th:text="${competitionSetupForm.streamName}"></dd>
                    </div>
                </div>

                <dt>Project type</dt>
                <dd th:each="(collaborationLevel : ${collaborationLevels})" th:if="${collaborationLevel.code == competitionSetupForm.singleOrCollaborative}" th:text="${collaborationLevel.name}">Collaboration level</dd>

                <dt>Research categories</dt>
                <dd th:text="${researchCategoriesFormatted}"></dd>

                <dt>Lead applicant</dt>
                <dd th:each="(leadApplicantType : ${leadApplicantTypes})" th:if="${leadApplicantType.code == competitionSetupForm.leadApplicantType}" th:text="${leadApplicantType.name}">Lead applicant type</dd>

                <dt>Research participation</dt>
                <dd th:each="(researchParticipationAmount : ${researchParticipationAmounts})" th:if="${researchParticipationAmount.id == competitionSetupForm.researchParticipationAmountId}" th:text="${researchParticipationAmount.name}">Research category</dd>

                <dt>Are resubmissions allowed?</dt>
                <dd th:text="${#strings.capitalize(competitionSetupForm.resubmission)}"></dd>

            </dl>

            <button type="submit" class="button">Edit</button>
        </fieldset>

    </form>
    <ul class="pagination">
        <li class="prev">
            <a rel="prev" title="Navigate to next part" th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='additional')}">
                <span class="pagination-label">Previous</span>
                <span class="pagination-part-title">Funding Information</span>
            </a>
        </li>
        <li class="next">
            <a rel="next" title="Navigate to next part" th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='milestones')}">
                <span class="pagination-label">Next</span>
                <span class="pagination-part-title">Milestones</span>
            </a>
        </li>
    </ul>
</th:block>

<!-- =================Section: Milestones (4) =========================== -->
<th:block th:fragment="section-milestones">

    <div class="page-title">
        <h1 class="heading-xlarge">Milestones</h1>
    </div>

    <div class="panel-indent">
        Here you can define the Competiton milestones. Submission date will generate other dates. You will be able to edit those, but it will override the dates calculated if you do.
    </div>

    <form th:action="@{(${editable} ? '' : 'milestones/edit')}"
          data-autosave="compSetup" th:attr="data-competition=${competition.id}" data-section="milestones"
          method="post" th:object="${competitionSetupForm}" novalidate="novalidate">

        <div class="error-summary" th:attr="aria-hidden=${!#fields.hasAnyErrors()}">
           <h2 class="heading-medium error-summary-heading">
               Unable to save section
           </h2>

           <ul class="error-summary-list">
               <li th:each="err : ${#fields.allErrors()}" th:text="${err}"></li>
           </ul>
       </div>

        <fieldset th:if="${editable}" id="section-4-edit">


            <legend class="visuallyhidden">Milestones</legend>

            <table class="milestones-table">
                <thead>
                <tr>
                    <th scope="col" id="milestone">Milestone</th>
                    <th scope="col">Weekday</th>
                    <th scope="col">Day</th>
                    <th scope="col">Month</th>
                    <th scope="col">Year</th>
                </tr>
                </thead>
                <tbody>
                  <tr th:each="(milestoneEntry : ${competitionSetupForm.milestoneEntries})"
                      class="date-group form-group-row"
                      data-future-date=""
                      th:attr="data-date-invalid-errormessage=${milestoneEntry.value.milestoneType.milestoneDescription + ': please enter a valid date'},
                               data-date-future-errormessage=${milestoneEntry.value.milestoneType.milestoneDescription  + ': please enter a future date that is after the previous milestone'}">

                      <th scope="row" th:id="${'milestone-' + milestoneEntry.key}">
                        <span th:text="${milestoneEntry.value.milestoneType.milestoneDescription}" />
                      </th>
                      <input type="hidden"
                             required="required"
                             th:name="'milestoneEntries[' + ${milestoneEntry.key} + '].milestoneType'"
                             th:value="${milestoneEntry.key}"  />
                      <td class="js-addWeekDay" th:text="${milestoneEntry.value.dayOfWeek}"></td>
                      <td class="day">
                          <input type="number"
                                 placeholder="DD"
                                 min="1"
                                 max="31"
                                 data-maxlength-errormessage=""
                                 required="required"
                                 class="form-control width-small"
                                 th:attr="aria-labelledby=${'milestone-' + milestoneEntry.key},
                                           data-date=${milestoneEntry.value.day+'-'+milestoneEntry.value.month+'-'+milestoneEntry.value.year}"
                                 th:value="${milestoneEntry.value.day}"
                                 th:name="'milestoneEntries[' + ${milestoneEntry.key} + '].day'"/>
                      </td>
                      <td class="month">
                          <input type="number"
                                placeholder="MM"
                                min="1"
                                max="12"
                                required="required"
                                class="form-control width-small"
                                th:attr="aria-labelledby=${'milestone-' + milestoneEntry.key},data-date=${milestoneEntry.value.day+'-'+milestoneEntry.value.month+'-'+milestoneEntry.value.year}"
                                th:value="${milestoneEntry.value.month}"
                                th:name="'milestoneEntries[' + ${milestoneEntry.key} + '].month'" />
                      </td>
                      <td class="year" >
                          <input type="number"
                                 placeholder="YYYY"
                                 th:attr="aria-labelledby=${'milestone-' + milestoneEntry.key},
                                 data-date=${milestoneEntry.value.day+'-'+milestoneEntry.value.month+'-'+milestoneEntry.value.year},
                                 min=${#dates.format(#dates.createNow(), 'yyyy')}"
                                 required="required"
                                 class="form-control width-small"
                                 th:value="${milestoneEntry.value.year}"
                                 th:name="'milestoneEntries[' + ${milestoneEntry.key} + '].year'"/>
                          </td>
                    </tr>
                </tbody>
            </table>
            <button class="button extra-margin">Done</button>

        </fieldset>

        <th:block th:if="${!editable}">
            <table>
                <thead>
                    <tr>
                      <th scope="col" id="milestone">Milestone</th>
                      <th scope="col">Weekday</th>
                      <th scope="col">Day</th>
                      <th scope="col">Month</th>
                      <th scope="col">Year</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="milestoneEntry : ${competitionSetupForm.milestoneEntries}" >
                        <td th:text="${milestoneEntry.value.milestoneType.milestoneDescription}"></td>
                        <td th:text="${milestoneEntry.value.dayOfWeek}"></td>
                        <td th:text="${milestoneEntry.value.day}"></td>
                        <td th:text="${milestoneEntry.value.month}"></td>
                        <td th:text="${milestoneEntry.value.year}" />
                    </tr>
                </tbody>
            </table>
            <button type="submit" class="button extra-margin">Edit</button>
        </th:block>
    </form>

    <ul class="pagination">
        <li class="prev">
            <a rel="prev" title="Navigate to next part"
               th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='eligibility')}">
                <span class="pagination-label">Previous</span>
                <span class="pagination-part-title">Eligibility</span>
            </a>
        </li>
        <li class="next">
            <a rel="next" title="Navigate to next part"
               th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='application')}">
                <span class="pagination-label">Next</span>
                <span class="pagination-part-title">Application</span>
            </a>
        </li>
    </ul>
</th:block>

<!-- =================== Comp setup section - Application questions (5) ============================== -->
<th:block th:fragment="section-application">

    <div class="page-title">
        <h1 class="heading-xlarge">Application process</h1>
    </div>

    <h2 class="heading-medium extra-margin" th:text="${competition.competitionTypeName+' competition questions'}" />

    <p>Here you can review and amend the application and assessment questions and guidance for this competition.
        Any changes you make will be applied to this competition, but will not affect the default template for this competition type.</p>

    <p>If you're happy with the default questions for this competition type, mark this section as done and continue.</p>

    <div class="grid-row">
        <div class="column-half">
            <div class="grey-box">
                <h3 class="heading-small no-margin">Assessed questions</h3>
                <ol class="list-number">
                    <li th:each="question : ${questions}"><a th:href="@{/competition/setup/{competitionId}/section/application/question/{questionId}(competitionId=${competition.id}, questionId=${question.id})}" th:text="${question.shortName}">Question Title</a></li>
                </ol>
            </div>
        </div>
        <div class="column-half">
            <div class="grey-box">
                <h3 class="heading-small no-margin">Application details</h3>
                <ol class="list-number">
                    <li><a th:href="@{/competition/setup/{competitionId}/section/application/detail(competitionId=${competition.id})}">Application details</a></li>
                    <li th:each="question : ${projectDetails}"><a th:href="@{/competition/setup/{competitionId}/section/application/question/{questionId}(competitionId=${competition.id}, questionId=${question.id})}" th:text="${question.shortName}">Question Title</a></li>
                </ol>
            </div>
            <div class="grey-box">
                <h3 class="heading-small no-margin">Finances</h3>
                <ul>
                    <li><a th:href="@{/competition/setup/{competitionId}/section/application/question/finance(competitionId=${competition.id})}">Finances</a></li>
                </ul>
            </div>
        </div>
    </div>
    <a  th:if="${editable}" class="button extra-margin"  th:href="@{/competition/setup/{competitionId}/section/application/mark-as-complete(competitionId=${competition.id})}">Done</a>

    <ul class="pagination">
        <li class="prev">
            <a rel="prev" title="Navigate to prev part" th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='milestones')}">
                <span class="pagination-label">Previous</span>
                <span class="pagination-part-title">Milestones</span>
            </a>
        </li>
        <li class="next">
            <a rel="next" title="Navigate to next part" th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='assessors')}">
                <span class="pagination-label">Next</span>
                <span class="pagination-part-title">Assessors</span>
            </a>
        </li>
    </ul>
</th:block>

<!-- =================== Comp setup section - Assessors (6) ============================== -->
<th:block th:fragment="section-assessors">

    <div class="page-title">
        <h1 class="heading-xlarge">Assessment</h1>
    </div>


    <form th:action="@{(${editable} ? '' : 'assessors/edit')}" method="post" th:object="${competitionSetupForm}" novalidate="novalidate"
          th:attr="data-competition=${competition.id}" data-autosave="compSetup" data-section="assessors">
        <th:block th:if="${editable}" id="section-assessors-edit">
            <h2 class="heading-small">How many assessors are required for each application?</h2>
            <div th:class="${#fields.hasErrors('assessorCount')}? 'form-group error':'form-group'">
                <fieldset class="inline">
                    <legend class="visuallyhidden">How many assessors are required for each application?</legend>
                    <span th:if="${#fields.hasErrors('assessorCount')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('assessorCount')}" th:text="${err}" />
                    </span>
                    <label th:each="assessorOption : ${assessorOptions}" class="block-label" th:for="${'assessors-' + '__${assessorOption.id}__'}">
                     <input th:id="${'assessors-' + '__${assessorOption.id}__'}" name="assessorCount"
                            th:value="${assessorOption.optionValue}" type="radio"
                            th:checked="${assessorOption.optionValue == competitionSetupForm.assessorCount}" />
                        <span th:text="${assessorOption.optionName}"></span>
                    </label>

                </fieldset>
            </div>
            <div th:class="${#fields.hasErrors('assessorPay')}? 'form-group error':'form-group'">
                <label class="form-label" for="assessorPay">
                    <span class="form-label-bold">How much do assessors receive per application?</span>
                    <span class="form-hint">This information will be available in the assessor invites.</span>
                     <span th:if="${#fields.hasErrors('assessorPay')}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('assessorPay')}" th:text="${err}" />
                    </span>
                </label>
                <input class="form-control width-medium" id="assessorPay" name="assessorPay" type="number" min="0" maxlength="8"

                       th:value="${#fields.hasErrors('assessorPay') ? competitionSetupForm.assessorPay : competitionSetupForm.assessorPay != null ? #numbers.formatInteger(competitionSetupForm.assessorPay, 0, 'COMMA')  : ''}"
                       data-required-errormessage="Please enter how much assessors will be paid"
                       data-min-errormessage="Please enter how much assessors will be paid"
                       data-th-attr="data-maxlength-errormessage=#{validation.assessorsform.assessorPay.max.amount.invalid}"
                       th:errorclass="field-error"/>
            </div>

            <button class="button">Done</button>
        </th:block>

       <th:block th:if="${!editable}" id="section-assessors-readonly">
            <dl class="standard-definition-list">
                <dt>How many assessors are required for each application?</dt>
                <dd th:text="${competitionSetupForm.assessorCount}"></dd>

                <dt>How much do assessors receive per application?</dt>
                <dd th:text="${#numbers.formatInteger(competitionSetupForm.assessorPay, 0, 'COMMA')}"></dd>
            </dl>

            <button class="button">Edit</button>
        </th:block>
    </form>


    <ul class="pagination">
        <li class="prev">
            <a rel="prev" title="Navigate to prev part"
               th:href="@{/competition/setup/{competitionId}/section/{sectionPath}(competitionId=${competition.id},sectionPath='application')}">
                <span class="pagination-label">Previous</span>
                <span class="pagination-part-title">Application</span>
            </a>
        </li>
    </ul>
</th:block>

