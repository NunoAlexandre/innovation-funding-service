<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Funding decision notification'" />
</head>

<body th:with="context='comp-management'" class="competition-management">
<th:block th:insert="fragments/layout :: body-start" />
<th:block th:insert="fragments/layout :: global-header" />

<main id="content" th:object="${form}">
    <th:block th:insert="fragments/layout :: header-sub" th:with="linkTitle='Manage funding notifications',linkClass='link-back',linkUrl=@{/competition/{competitionId}/manage-funding-applications(competitionId=${model.competitionId})}" />
    <h1 class="heading-xlarge">
                <span class="heading-secondary"><th:block th:text="${#numbers.formatInteger(model.competitionId,8)}"/>: <th:block
                    th:text="${model.competitionName}"/></span>
        <span>Funding decision notification</span>
    </h1>

    <p>This email can be edited and customised. Once sent it will be received by all applicants associated with each of the applications you selected. If you want to remove recipients, select 'remove' from the list of recipients. This will remove the application from the list, including all applicants.</p>

    <div class="error-summary" th:if="${#fields.hasErrors('*')}">
        <h2 class="heading-medium error-summary-heading">There is a problem on this page</h2>
        <ul class="error-summary-list">
            <th:block th:each="err : ${#fields.errors('*')}">
                <li th:classappend="list-header" th:text="${err}"></li>
            </th:block>
        </ul>
    </div>

    <h2 class="heading-medium">Key statistics</h2>
    <p>None</p>

    <h2 class="heading-small">Recipients</h2>
    <p>Table of recipients</p>

    <th:block>
        <fieldset>

            <div class="form-group">
                <label class="form-label-bold" for="subject">
                    Subject
                </label>

                <!-- th:field="${form.summary}" -->
                <input class="form-control"
                       id="subject"
                       type="text"
                       required="required"
                       th:attr="data-required-errormessage=#{validation.field.must.not.be.blank}" />
            </div>

            <div class="form-group">
                <label class="form-label-bold" for="message">
                    Message
                </label>
                <div class="textarea-wrapped">
                    <!--
                        th:field="${form.message}"
                        th:errorclass="field-error"
                        ifs:utext="${form.message}"
                    -->
                        <textarea id="message"
                                  class="form-control width-full"
                                  data-editor="html"
                                  maxlength="5000"
                                  rows="4"
                                  required="required"
                                  th:attr="data-required-errormessage=#{validation.field.must.not.be.blank}">
                        </textarea>
                </div>
            </div>

        </fieldset>
    </th:block>

    <!--- TODO: Make this button a form input type button to POST the 'send email' command --->
    <button class="button" formaction="/prototypes/1561-funding-notifications" >Send email to all applicants</button>

    <a th:href="@{/competition/{competitionId}/manage-funding-applications(competitionId=${model.competitionId})}">
        Cancel
    </a>

    <th:block th:insert="fragments/layout :: main-content-end" />
</main>

<th:block th:insert="fragments/layout :: footer" />
<th:block th:insert="fragments/layout :: body-end" />
</body>
</html>
