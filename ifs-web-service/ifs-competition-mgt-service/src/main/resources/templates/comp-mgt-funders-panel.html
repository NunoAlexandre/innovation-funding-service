<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Application Dashboard'" />
</head>
<body th:with="context='comp-management'" class="competition-management application-funders-panel">

<div th:include="fragments/layout :: body-start" th:remove="tag" />
<div th:include="fragments/layout :: global-header" th:remove="tag" />

<main id="content" class="full-width">
    <div th:include="fragments/layout :: main-content-start" th:remove="tag" />

  <div class="grid-row">
      <div class="column-two-thirds">
            <div class="page-title">
                <div th:include="fragments/competition-management :: competition-id(competition=${competitionSummary})" th:remove="tag" />
                <h1 class="heading-xlarge" th:text="${competitionSummary.competitionName}" />
            </div>
      </div>
      <div class="column-third alignright extra-margin">
        <div th:include="fragments/competition-management :: competition-status(competition=${competitionSummary})" th:remove="tag" />
      </div>
  </div>

    <div th:if="${fundingNotDecidedForAllApplications}" class="event-alert">
        <p><span>A funding decision is required for all applications to the competition.</span></p>
    </div>

  <div th:include="fragments/competition-management :: competition-mgt-menu(competitionStatus=${competitionSummary.competitionStatus.name()},competitionId=${competitionSummary.competitionId})" th:remove="tag" />

    <div class="grid-row competition-data">
        <div class="column-fifth">
              <div th:include="fragments/competition-management :: info-area" th:remove="tag" />
        </div>
        <div class="column-four-fifth">
          <form method="get">
				<input type="hidden" name="tab" th:if="${activeTab != null}" th:value="${activeTab}" />

				<h2 class="bold-large" th:if="${activeTab == 'submitted'}">Applications submitted</h2>
				<h2 class="bold-large" th:if="${activeTab == 'notSubmitted'}">Applications not submitted</h2>


			    <div class="grid-row sort-by">
			        <div class="column-two-thirds">
			          <h3>
			            <span class="heading-large" th:text="${results.totalElements}" /> applications
			          </h3>
			        </div>
			        <div class="column-third alignright">
			          <div th:include="fragments/competition-management :: applications-sort(activeTab=${activeTab},activeSortField=${activeSortField})" th:remove="tag" />
			        </div>
			    </div>

			</form>

    <form method="post" id="submit-funding-decision-form" data-autosave="fundingDecision" th:action="@{/competition/{competitionId}/fundingdecision(competitionId=${competitionSummary.getCompetitionId()})}">
      <div th:include="fragments/competition-management :: applications-table(competition=${competitionSummary},results=${results})" th:remove="tag" />
      <div th:include="fragments/modals :: modal-publish-funding-decision" th:remove="tag" />
      <p class="alignright-button">
        <button id="notify-applicants" type="submit" class="visuallyhidden" name="action" value="notify">Notify applicants</button>
        <button id="save-funding-decision" type="submit" class="button button-secondary no-margin" name="action" value="save">Save</button>
      </p>
    </form>

  </div>
</div>

    <div th:include="fragments/layout :: main-content-end" th:remove="tag" />
</main>

<div th:include="fragments/layout :: footer" th:remove="tag" />
<div th:include="fragments/layout :: body-end" th:remove="tag" />

</body>
</html>
