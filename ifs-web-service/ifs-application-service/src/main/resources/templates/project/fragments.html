<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<!-- ===========================Project setup select address=========================== -->

<div th:fragment="select-address">
    <fieldset>
        <legend class="visuallyhidden">Operating address</legend>
        <div class="form-block" th:if="${model.registeredAddress}">
            <label class="block-label" for="address-use-org" data-target="registeredAddress">
                <input id="address-use-org" type="radio" name="project-address-group" value="address-use-org" th:field="*{projectAddressGroup}"/>
                Use organisation address (<strong th:text="${model.registeredAddress.postcode}">BS1 4NT</strong>)
            </label>
        </div>

        <div class="form-block" th:if="${model.operatingAddress}" data-target="operatingAddress">
            <label class="block-label" for="address-use-operating">
                <input id="address-use-operating" type="radio" name="project-address-group" value="address-use-operating" th:field="*{projectAddressGroup}"/>
                Use operating address (<strong th:text="${model.operatingAddress?.postcode}">SN1 2UE</strong>)
            </label>
        </div>


        <div class="form-block">
            <label class="block-label" for="address-add-project" data-target="custom-postcode">
                <input id="address-add-project" type="radio" name="project-address-group" value="address-add-project" th:field="*{projectAddressGroup}"/>
                Enter an alternative project address
            </label>
        </div>
    </fieldset>

    <div id="registeredAddress" class="boxed extra-margin" th:if="${model.registeredAddress}">
        <h3 class="heading-medium no-margin-top">Confirm project location</h3>
        <p>
          <span th:unless="${#strings.isEmpty(model.registeredAddress?.addressLine1)}" th:remove="tag">
            <span th:text="${model.registeredAddress?.addressLine1}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.registeredAddress?.addressLine2)}" th:remove="tag">
            <span th:text="${model.registeredAddress?.addressLine2}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.registeredAddress?.addressLine3)}" th:remove="tag">
            <span th:text="${model.registeredAddress?.addressLine3}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.registeredAddress?.town)}" th:remove="tag">
            <span th:text="${model.registeredAddress?.town}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.registeredAddress?.county)}" th:remove="tag">
            <span th:text="${model.registeredAddress?.county}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.registeredAddress?.postcode)}" th:remove="tag">
            <span th:text="${model.registeredAddress?.postcode}" /><br/>
          </span>
        </p>
    </div>
    <div id="operatingAddress" class="boxed extra-margin" th:if="${model.operatingAddress}">
        <h3 class="heading-medium no-margin-top" th:text="${(address != null and address == 'bankDetails' ? 'Confirm organisation address' : 'Confirm project location')}">LOCATION TITLE</h3>
        <p>
          <span th:unless="${#strings.isEmpty(model.operatingAddress?.addressLine1)}" th:remove="tag">
            <span th:text="${model.operatingAddress?.addressLine1}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.operatingAddress?.addressLine2)}" th:remove="tag">
            <span th:text="${model.operatingAddress?.addressLine2}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.operatingAddress?.addressLine3)}" th:remove="tag">
            <span th:text="${model.operatingAddress?.addressLine3}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.operatingAddress?.town)}" th:remove="tag">
            <span th:text="${model.operatingAddress?.town}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.operatingAddress?.county)}" th:remove="tag">
            <span th:text="${model.operatingAddress?.county}" /><br/>
          </span>
          <span th:unless="${#strings.isEmpty(model.operatingAddress?.postcode)}" th:remove="tag">
            <span th:text="${model.operatingAddress?.postcode}" /><br/>
          </span>
        </p>
    </div>




    <div id="custom-postcode">
    <div class="extra-margin form-group" th:classappend="${#fields.hasErrors('*{addressForm.postcodeInput}') and form.addressForm.triedToSearch} ? 'error'">
        <label class="form-label" for="postcode-check">
            <span class="form-label-bold">Postcode</span>
                    <span th:if="${#fields.hasErrors('*{addressForm.postcodeInput}') and form.addressForm.triedToSearch}"  th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('addressForm.postcodeInput')}" th:text="${err}" />
                    </span>
        </label>
        <input class="form-control" th:field="*{addressForm.postcodeInput}" th:classappend="${#fields.hasErrors('*{addressForm.postcodeInput}') and form.addressForm.triedToSearch} ? 'field-error' : ''" type="text" />
        <button type="submit" id="postcode-lookup" class="button" name="search-address">Find UK address</button>
        <div th:if='${form.addressForm.postcodeInput != ""} and ${form.addressForm.postcodeOptions.size()}==0'>No results were found</div>
    </div>

    <div class="form-group"  th:if="${form.addressForm.postcodeOptions != null and form.addressForm.postcodeOptions.size() != 0}">
        <label class="form-label" for="select-address">
            <span class="form-label-bold">Select your address</span>
        </label>
        <select class="form-control" th:field="*{addressForm.selectedPostcodeIndex}">
            <option th:value="${status.index}" th:each="address,status : ${form.addressForm.postcodeOptions}" th:text="${address.combinedString}"></option>
        </select>
        <button type="submit" class="button" name="select-address">Use selected address</button>
    </div>
    <button type="submit" class="buttonlink" name="manual-address">Enter address manually</button>

    <fieldset class="extra-margin" th:if="${form.addressForm.selectedPostcodeIndex != null or form.addressForm.manualAddress}">
        <input type="hidden" th:field="*{addressForm.manualAddress}" />
        <legend class="visuallyhidden">Address details</legend>
        <div th:class="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine1}') and form.addressForm.triedToSave} ? 'form-group error' : 'form-group'">
            <label class="form-label" for="street">
                <span class="form-label-bold">Street</span>
                    <span th:if="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine1}') and form.addressForm.triedToSave}"  th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('addressForm.selectedPostcode.addressLine1')}" th:text="${err}" />
                    </span>
            </label>
            <input class="form-control" th:field="*{addressForm.selectedPostcode.addressLine1}" th:classappend="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine1}') and form.addressForm.triedToSave} ? 'field-error' : ''" type="text" />
        </div>
        <div th:class="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine2}') and form.addressForm.triedToSave} ? 'form-group error' : 'form-group'">
            <label class="form-label visuallyhidden" for="street-2">
                <span class="form-label-bold">Street line 2</span>
                    <span th:if="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine2}') and form.addressForm.triedToSave}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('addressForm.selectedPostcode.addressLine2')}" th:text="${err}" />
                    </span>
            </label>
            <input class="form-control" th:field="*{addressForm.selectedPostcode.addressLine2}" th:classappend="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine2}') and form.addressForm.triedToSave} ? 'field-error' : ''"   type="text" />
        </div>
        <div th:class="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine3}') and form.addressForm.triedToSave} ? 'form-group error' : 'form-group'">
            <label class="form-label" for="street-2">
                <span class="form-label-bold visuallyhidden">Street line 3</span>
                    <span th:if="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine3}') and form.addressForm.triedToSave}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('addressForm.selectedPostcode.addressLine3')}" th:text="${err}" />
                    </span>
            </label>
            <input class="form-control" th:field="*{addressForm.selectedPostcode.addressLine3}"  th:classappend="${#fields.hasErrors('*{addressForm.selectedPostcode.addressLine3}') and form.addressForm.triedToSave} ? 'field-error' : ''" type="text" />
        </div>
        <div th:class="${#fields.hasErrors('*{addressForm.selectedPostcode.town}') and form.addressForm.triedToSave} ? 'form-group error' : 'form-group'">
            <label class="form-label" for="town">
                <span class="form-label-bold">Town</span>
                    <span th:if="${#fields.hasErrors('*{addressForm.selectedPostcode.town}') and form.addressForm.triedToSave}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('addressForm.selectedPostcode.town')}" th:text="${err}" />
                    </span>
            </label>
            <input class="form-control" th:field="*{addressForm.selectedPostcode.town}"  th:classappend="${#fields.hasErrors('*{addressForm.selectedPostcode.town}') and form.addressForm.triedToSave} ? 'field-error' : ''" type="text" />
        </div>
        <div th:class="${#fields.hasErrors('*{addressForm.selectedPostcode.county}') and form.addressForm.triedToSave} ? 'form-group error' : 'form-group'">
            <label class="form-label" for="county">
                <span class="form-label-bold">County</span>
                    <span th:if="${#fields.hasErrors('*{addressForm.selectedPostcode.county}') and form.addressForm.triedToSave}" th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('addressForm.selectedPostcode.county')}" th:text="${err}" />
                    </span>
            </label>
            <input class="form-control" th:field="*{addressForm.selectedPostcode.county}" th:classappend="${#fields.hasErrors('*{addressForm.selectedPostcode.county}') and form.addressForm.triedToSave} ? 'field-error' : ''"  type="text" />
        </div>
        <div th:class="${#fields.hasErrors('*{addressForm.selectedPostcode.postcode}') and form.addressForm.triedToSave} ? 'form-group error' : 'form-group'">
            <label class="form-label" for="postcode">
                <span class="form-label-bold">Postcode</span>
                    <span th:if="${#fields.hasErrors('*{addressForm.selectedPostcode.postcode}') and form.addressForm.triedToSave}"  th:remove="tag">
                          <span class="error-message"  th:each="err : ${#fields.errors('addressForm.selectedPostcode.postcode')}" th:text="${err}" />
                    </span>
            </label>
            <input class="form-control" th:field="*{addressForm.selectedPostcode.postcode}" th:classappend="${#fields.hasErrors('*{addressForm.selectedPostcode.postcode}') and form.addressForm.triedToSave} ? 'field-error' : ''" type="text" />
        </div>
    </fieldset>
  </div>
</div>

</html>
