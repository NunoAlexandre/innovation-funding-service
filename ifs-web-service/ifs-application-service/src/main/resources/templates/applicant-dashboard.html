<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Application Dashboard'" />
</head>

<body th:with="context='applicant'" class="app-dashboard">

    <th:block th:insert="fragments/layout :: body-start" />
    <th:block th:insert="fragments/layout :: global-header" />

    <main id="content">
        <th:block th:insert="fragments/layout :: main-content-start" />

        <div class="event-alert is-open" th:each="notification:${notifications}">
            <p>
                <span th:text="${notification?.assignedByName + ' has assigned a question to you'}"></span>
            </p>
        </div>

        <div class="my-applications">
            <h1 class="heading-large">Your dashboard</h1>
            <section th:if="${!projectsInSetup.isEmpty()}" class="projects-in-setup">
                <div class="progress-list">
                    <h2 class="heading-medium">Projects in setup</h2>
                    <ul>
                        <li th:each="project : ${projectsInSetup}">
                            <div class="task">
                                <h3 class="heading-small">
                                    <a th:href="@{/project-setup/project/{id}(id=${project.getId()})}" th:text="${(project.name == '' ? competitions.get(project.application).getName(): project.name)}">
                                        PROJECT NAME
                                    </a>
                                </h3>
                                <ul class="application-details">
                                    <li>Application number: <span th:text="${#numbers.formatInteger(project.application,8)}">APPLICATION NUMBER</span></li>
                                    <li>Competition: <span th:text="${competitions.get(project.application).getName()}">COMPETITION NAME</span></li>
                                </ul>
                            </div>
                            <div class="status">
                                <strong class="status-msg msg-progress">
                                    Project in setup
                                </strong>
                            </div>
                        </li>
                    </ul>
                </div>
            </section>

            <section class="in-progress">
                <div class="progress-list">
                  <h2 class="heading-medium">Application in progress</h2>
                    <ul>
                        <li class="status-2-col" th:each="app : ${applicationsInProcess}" th:classappend="${applicationsAssigned?.contains(app.id) ? 'assigned-to-me' : '' }">
                            <th:block th:unless="${applicationStatuses.get(app.getId()).getName() == 'submitted'}">
                                <div class="task">
                                    <h3 class="heading-small">
                                        <a th:unless="${T(org.innovateuk.ifs.application.constant.ApplicationStatusConstants).CREATED.name == app.applicationStatusName}"
                                            th:href="@{/application/{id}(id=${app.getId()})}"
                                            th:text="((${app.name} == '') ? ${competitions.get(app.getId()).getName()}: ${app.name})"/>

                                        <a th:if="${T(org.innovateuk.ifs.application.constant.ApplicationStatusConstants).CREATED.name == app.applicationStatusName}"
                                            th:href="@{/application/{id}/contributors/invite?newApplication(id=${app.getId()})}"
                                            th:text="((${app.name} == '') ? ${competitions.get(app.getId()).getName()}: ${app.name})"/>
                                    </h3>
                                    <ul class="application-details">
                                        <li>Application number: <span th:text="${#numbers.formatInteger(app.id,8)}"></span></li>
                                        <li>Competition: <span th:text="${competitions.get(app.getId()).getName()}">COMPETITION NAME</span></li>
                                    </ul>
                                </div>
                                <div class="status">
                                    <div class="status-msg msg-deadline">
                                      <strong class="bold-medium days-remaining" th:text="${competitions.get(app.getId()).getDaysLeft()}">DAYS LEFT</strong> <br />
                                      days left <br />
                                      Deadine
                                      <span class="day" th:text="${#temporals.day(competitions.get(app.getId()).getEndDate())}">END DAY</span>
                                      <span class="month" th:text="${#temporals.monthName(competitions.get(app.getId()).getEndDate())}">END MONTH</span>
                                    </div>
                                    <span class="status-msg msg-progress" th:text="${applicationProgress.get(app.getId())}+'% complete'">PERCENTAGE COMPLETE</span>
                                </div>
                            </th:block>
                            <th:block th:if="${applicationStatuses.get(app.getId()).getName() == 'submitted'}">
                                <div class="task">
                                    <h3 class="heading-small">
                                        <a th:href="@{/application/{id}/track(id=${app.getId()})}" th:text="${app.name}">placeholder</a>
                                    </h3>
                                    <ul class="application-details">
                                        <li>Application number: <span th:text="${#numbers.formatInteger(app.id,8)}"></span></li>
                                        <li>Competition: <span th:text="${competitions.get(app.getId()).getName()}">COMPETITION NAME</span></li>
                                    </ul>
                                </div>
                                <div class="status">
                                    <span class="status-msg msg-deadline-waiting">Awaiting assessment</span>
                                    <span class="status-msg msg-progress">Application submitted</span>
                                </div>
                            </th:block>
                        </li>
                    </ul>
                </div>
            </section>

            <section th:if="${!applicationsFinished.isEmpty()}" class="previous-applications">
                <div class="progress-list">
                    <h2 class="heading-medium">Previous applications</h2>
                    <ul>
                        <li th:each="app : ${applicationsFinished}"
                            th:with="statusName=${applicationStatuses.get(app.id).name}"
                            th:class="${statusName == 'approved'} ? 'positive' : 'negative'">
                            <div class="task">
                                <h3 class="heading-small">
                                    <a th:href="@{/application/{id}/summary(id=${app.getId()})}" th:text="${app.getApplicationDisplayName()}">placeholder</a>
                                </h3>
                                <ul class="application-details">
                                    <li>Application number: <span th:text="${#numbers.formatInteger(app.id,8)}"></span></li>
                                    <li>Competition: <span th:text="${competitions.get(app.getId()).getName()}">COMPETITION NAME</span></li>
                                </ul>
                            </div>
                            <div class="status">
                                <p th:if="${statusName == 'rejected'}" class="status-msg msg-progress">Unsuccessful</p>
                                <p th:if="${statusName == 'approved'}" class="status-msg msg-progress">Successful</p>
                                <p th:if="${statusName == 'created' || statusName == 'open'}" class="status-msg msg-progress not-submitted">Not submitted</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </section>
            <section class="your-profile">
                <h2 class="heading-medium">Your profile</h2>
                <ul class="list list-bullet">
                    <li>
                        <a href="/profile/view">view and edit your profile details</a>
                    </li>
                    <li>
                        <a href="/info/terms-and-conditions">read the terms and conditions</a>
                    </li>
                </ul>
            </section>
        </div>


        <th:block th:insert="fragments/layout :: main-content-end" />
    </main>

    <th:block th:insert="fragments/layout :: footer" />
    <th:block th:insert="fragments/layout :: body-end" />
</body>

</html>
