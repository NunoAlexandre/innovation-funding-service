<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <th:block th:insert="fragments/layout :: head" th:with="pageTitle='Create an application'" />
</head>
<body th:with="context='applicant'" class="create-application-find-business">

<div th:include="fragments/layout :: body-start" th:remove="tag"/>
<div th:include="fragments/layout :: global-header" th:remove="tag"/>

<main id="content">
    <div th:include="fragments/layout :: main-content-start" th:remove="tag"/>
    <div th:include="fragments/layout :: header-sub" th:with="linkTitle='Back',linkClass='link-back',linkUrl='javascript:history.back()',currentApplication=${currentApplication}" th:remove="tag" />

    <h1 class="heading-large">Create your account</h1>
    <p class="form-hint icon-info-small-blue">Your organisation must be UK based to receive funding from Innovate UK</p>

    <h2 class="heading-medium" th:text="${organisationForm.organisationType.name} + ''">? organisation</h2>

    <form th:action="@{/organisation/create/find-organisation}" th:object="${organisationForm}" method="POST">
        <span th:if="${searchEnabled}">
            <fieldset>
                <legend class="visuallyhidden" th:text="${organisationForm.organisationType.name} + ''">? organisation</legend>

                <div th:class="${#fields.hasErrors('*{organisationSearchName}') and organisationForm.organisationSearching} ? 'form-group error' : 'form-group'">
                    <label class="form-label" for="org-name">
                        <span class="form-label-bold"
                              th:text="${searchLabel}">Find your ? organisation</span>
                        <span class="form-hint" th:text="${searchHint}">Enter your organisation name</span>
                        <span  th:if="${#fields.hasErrors('*{organisationSearchName}') and organisationForm.organisationSearching}" th:remove="tag">
                              <span class="error-message"  th:each="err : ${#fields.errors('*{organisationSearchName}')}" th:text="${err}" />
                        </span>
                    </label>
                    <input  class="form-control" th:field="*{organisationSearchName}" th:classappend="${#fields.hasErrors('*{organisationSearchName}') and organisationForm.organisationSearching} ? 'field-error'" type="text" value="" />
                    <button type="submit" id="org-search" name="search-organisation" class="button">Search</button>
                </div>
                <span th:if="${organisationForm.organisationSearching and organisationForm.organisationSearchResults.size() > 0}" th:unless="${#fields.hasErrors('*{organisationSearchName}')}">Choose your organisation:</span>
                <ul id="org-results" class="results-list panel" th:if="${organisationForm.organisationSearching}"
                    th:unless="${#fields.hasErrors('*{organisationSearchName}')}">
                    <li class="type-company" th:each="organisation : ${organisationForm.organisationSearchResults}">
                        <h3>
                            <a th:href="${'/organisation/create/selected-organisation/'+ organisation.organisationSearchId}" title="View organisation"
                               th:text="${organisation.name}">
                            </a>
                        </h3>
                        <span th:if="${organisationForm.isBusiness()}" th:remove="tag">
                            <p class="meta crumbtrail" th:text="${organisation.extraAttributes.description}"></p>
                            <p th:text="${organisation.location}"></p>
                        </span>
                    </li>
                    <li th:unless="${organisationForm.organisationSearchResults.size()}">
                        <p>No results found.<br/>Please check your search criteria and try again.</p>
                    </li>
                </ul>
            </fieldset>
            <span th:if="${organisationForm.isBusiness()}" th:remove="tag">
                <input type="hidden" th:field="*{manualEntry}" />
                <button type="submit" class="buttonlink" name="not-in-company-house">Not on Companies House?</button>

                <div th:if="${organisationForm.manualEntry}" th:remove="tag">
                    <div th:include="fragments/addresses :: organisation-name" th:with="form=${organisationForm}" th:remove="tag"></div>
                    <div th:include="fragments/addresses :: company-address-details" th:with="form=${organisationForm}" th:remove="tag"></div>
                    <button type="submit button-large extra-margin" name="save-organisation-details" class="button">Continue</button>
                </div>
            </span>
        </span>
        <span th:unless="${searchEnabled}">
            <legend class="visuallyhidden" th:text="${organisationForm.organisationType.name} + ''">? organisation</legend>
            <div th:include="fragments/addresses :: organisation-name" th:with="form=${organisationForm}" th:remove="tag"></div>
            <div th:include="fragments/addresses :: company-address-details" th:with="form=${organisationForm}" th:remove="tag"></div>
            <button type="submit button-large extra-margin" name="save-organisation-details" class="button">Continue</button>
        </span>
    </form>


    <div th:include="fragments/layout :: main-content-end" th:remove="tag"/>
</main>

<div th:include="fragments/layout :: footer" th:remove="tag"/>
<div th:include="fragments/layout :: body-end" th:remove="tag"/>
</body>
</html>
