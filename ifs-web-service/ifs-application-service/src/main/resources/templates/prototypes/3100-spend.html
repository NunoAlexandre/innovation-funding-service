<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <div th:include="fragments/layout :: head" th:with="pageTitle='Application Dashboard'" th:remove="tag" />
    <link href="/css/prototype.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body class="full-width">

<div th:include="prototypes/fragments/layout :: prototype-nav" th:remove="tag" />
<div th:include="fragments/layout :: body-start" th:remove="tag" />
<div th:include="fragments/layout :: global-header" th:remove="tag" />


<main id="content">
    <div th:include="fragments/layout :: main-content-start" th:remove="tag" />
	<div th:include="prototypes/fragments/applicant-view :: prototype-subheader(${'Project setup status'}, ${(param.user != null and param.user[0] == 'nonLead' ? '/prototypes/1588-project-status?user=nonLead' :'/prototypes/1588-project-status')})" th:remove="tag" />


	<!-- HARDCODED PROTOTYPE HTML -->
	<div th:include="prototypes/fragments/applicant-view :: prototype-project-page-title(${'projectSetup'}, ${'Spend profile'})" th:remove="tag" />

	<div class="centralise">
		<div th:if="${param.status != null and param.status[0] == 'MarkedComplete'}" th:remove="tag">
			<div class="marked-complete-alert extra-margin-bottom">
				<p>Your Spend Profile is currently marked as complete, you can decide to make edits to this, or when your partners
	have submitted their spend profiles submit them to Innovate UK</p>
			</div>
		</div>

		<div th:if="${param.spend != null and param.spend[0] == 'high'}" th:remove="tag">

			<div class="warning-alert extra-margin-bottom">
				<h2 class="heading-small">Your spend profile has total costs higher than eligible project costs, this cannot be submitted with higher total costs.</h2>
				<p class="no-margin-bottom">Please review:</p>
				<ul class="list-bullet">
					<li>Subcontracting costs</li>
				</ul>
				<!-- <a th:href="${(param.user != null and param.user[0] == 'nonLead' ? '/prototypes/3100-spend?spend=high&#38;user=nonLead' : '/prototypes/3100-spend?spend=high')}" class="button-secondary" th:unless="${param.status == null}">Save with overspend</a> -->
			</div>

		</div>

		<div th:if="${param.task != null and param.task[0] == 'reviewProject' and param.status != null and param.status[0] == 'Submitted'}" th:remove="tag">
			<div class="success-alert extra-margin-bottom">
				<p><strong>All Project Spend profiles have been submitted to Innovate UK</strong></p>
			</div>
		</div>

		<div th:if="${param.user != null and param.user[0] == 'nonLead' and param.status != null and param.status[0] == 'Submitted'}" th:unless="${param.task != null and param.task[0] == 'reviewPartner'}" th:remove="tag">
			<div class="success-alert extra-margin-bottom">
				<p><strong>Your spend profile has been sent to the lead partner. They will review and submit to Innovate UK.</strong></p>
			</div>
		</div>

		<p th:unless="${param.task != null and param.task[0] == 'reviewProject' or param.task != null and param.task[0] == 'reviewPartner'}">Your project costs have been reviewed and confirmed by Innovate UK. We now require a <strong>spend profile</strong> from you so that we can plan allocation of the grant funding to your project. This spend profile should be developed collaboratively with your project partners.</p>

		<dl class="standard-definition-list">
			<dt>Project start date</dt>
			<dd>1st May 2016</dd>

			<dt>Duration</dt>
			<dd>21 Months</dd>

			<div th:if="${param.task != null and param.task[0] == 'reviewPartner'}" th:remove="tag">

				<dt>Finance contact</dt>
				<dd>
					Dave Normen,
					<a href="mailto:dave@normen.com">dave@normen.com</a>
				</dd>

			</div>

		</dl>

		<div th:if="${param.task != null and param.task[0] == 'reviewProject'}" th:remove="tag">
			<h2 class="heading-medium">Partner project costs</h2>
			<p class="form-hint">These are the project costs for your partners on the project</p>

			<table id="partner-totals">
				<thead>
					<tr>
						<th scope="col">Partner</th>
						<th scope="col">Project costs</th>
					</tr>
				</thead>
				<tfoot>
					<tr>
						<th scope="row">Total</th>
						<td>&pound;525,000</td>
					</tr>
				</tfoot>
				<tbody>
					<tr>
						<td>
							<p class="no-margin">Aptrans Ltd <br />Lead organisation</p>
						</td>
						<td>
							&pound;175,000
						</td>
					</tr>
					<tr>
						<td>
							<p class="no-margin">Biotech Corp <br />Partner</p>
						</td>
						<td>
							&pound;175,000
						</td>
					</tr>
					<tr>
						<td>
							<p class="no-margin">University of Cardiff <br />Partner</p>
						</td>
						<td>
							&pound;175,000
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<h2 class="heading-medium" th:unless="${param.task != null and param.task[0] == 'reviewProject'}" ><span th:text="${(param.user != null and param.user[0] == 'nonLead' ? 'Biotech Corp - Spend profile' : 'Aptrans Ltd - Spend profile')}">Spend profile</span></h2>

		<div th:if="${param.task != null and param.task[0] == 'reviewProject'}" th:remove="tag">
			<h2 class="heading-medium">Project - Spend profile</h2>
		</div>

		<p th:unless="${param.task != null and param.task[0] == 'reviewProject' or param.task != null and param.task[0] == 'reviewPartner'}">
			Your project costs have been profiled equally across the time periods. Please edit to reflect your planned expenditure across the life of your project. Please note that costs cannot be moved across cost categories.
		</p>

		<p th:unless="${param.task == null or param.task[0] != 'reviewProject'}">This is the proposed spend profile for your project.</p>

		<div th:if="${param.status != null and param.status[0] == 'edit'}" th:remove="tag">

			<div class="extra-margin alignright" th:unless="${param.user == null}">

				<a th:href="${(param.spend != null and param.spend[0] == 'high' ? '/prototypes/3100-spend?status=edit&#38;view=full&#38;spend=high&#38;user=nonLead#table-forecast' : '/prototypes/3100-spend?status=edit&#38;view=full&#38;user=nonLead#table-forecast')}" th:unless="${param.view != null or param.status[0] == 'full'}" class="button-secondary">View wide screen table</a>

				<a th:href="${(param.spend != null and param.spend[0] == 'high' ? '/prototypes/3100-spend?status=edit&#38;spend=high&#38;user=nonLead#table-forecast' : '/prototypes/3100-spend?status=edit&#38;user=nonLead#table-forecast')}" th:unless="${param.view == null and param.status[0] != 'full'}" class="button-secondary">View standard table</a>

			</div>

		</div>
		
	</div>

	<form>

		<div class="flex-table">
			<div class="flex-left"></div>
			<div class="flex-middle">
				<table id="table-forecast">
					<thead>
						<tr>
							<th class="alignleft fix-left" scope="row" id="month">Month</th>
							<th scope="col" id="month1">Jun 2016</th>
							<th scope="col" id="month2">Jul 2016</th>
							<th scope="col" id="month3">Aug 2016</th>
							<th scope="col" id="month4">Sep 2016</th>
							<th scope="col" id="month5">Oct 2016</th>
							<th scope="col" id="month6">Nov 2016</th>
							<th scope="col" id="month7">Dec 2016</th>
							<th scope="col" id="month8">Jan 2017</th>
							<th scope="col" id="month9">Feb 2017</th>
							<th scope="col" id="month10" class="separate-cell year">Mar 2017</th>

							<th scope="col" id="month11">Apr 2017</th>
							<th scope="col" id="month12">May 2017</th>
							<th scope="col" id="month13">Jun 2017</th>
							<th scope="col" id="month14">Jul 2017</th>
							<th scope="col" id="month15">Aug 2017</th>
							<th scope="col" id="month16">Sep 2017</th>
							<th scope="col" id="month17">Oct 2017</th>
							<th scope="col" id="month18">Nov 2017</th>
							<th scope="col" id="month19">Dec 2017</th>
							<th scope="col" id="month20">Jan 2018</th>
							<th scope="col" id="month21">Feb 2018</th>
							<th scope="col" id="month22" class="separate-cell year">Mar 2018</th>

							<th scope="col" id="month23">Apr 2018</th>
							<th scope="col" id="month24">May 2018</th>
							<th scope="col" id="month25">Jun 2018</th>
							<th scope="col" id="month26">Jul 2018</th>
							<th scope="col" id="month27">Aug 2018</th>
							<th scope="col" id="month28">Sep 2018</th>
							<th scope="col" id="month29">Oct 2018</th>
							<th scope="col" id="month30">Nov 2018</th>
							<th scope="col" id="month31">Dec 2018</th>
							<th scope="col" id="month32">Jan 2019</th>
							<th scope="col" id="month33">Feb 2019</th>
							<th scope="col" id="month34" class="separate-cell year">Mar 2019</th>

							<th scope="col" id="month35">Apr 2019</th>
							<th scope="col" id="month36">May 2019</th>

							<th scope="col" class="total fix-right2" id="grand-total">Total</th>
							<th scope="col" class="total eligible fix-right" id="eligible-project-cost">Eligible project cost</th>
						</tr>
					</thead>
					<tfoot>
						<tr th:class="${(param.spend != null and param.spend[0] == 'high' ? 'error-in-row totals' : 'totals')}">
							<th scope="row" id="total" class="fix-left" >Total</th>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td class="separate-cell year">26,000</td>

							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td class="separate-cell year">26,000</td>

							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td>26,000</td>
							<td class="separate-cell year">26,000</td>

							<td>26,000</td>
							<td>26,000</td>

							<td class="total fix-right2">936,000</td>
							<td class="total eligible fix-right">936,000</td>
						</tr>
					</tfoot>
					<tbody>
						<div th:if="${param.status == null or param.status[0] != 'edit'}" th:remove="tag">
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row" th:with="header=${'Labour '}, value=${'12,500'}, total=${'450,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row" th:with="header=${'Admin support costs  (20%)'}, value=${'2,500'}, total=${'90,000'}, spend=${(param.spend != null and param.spend[0] == 'high' ? 'high' : 'ok')}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row" th:with="header=${'Materials '}, value=${'3,000'}, total=${'108,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row" th:with="header=${'Capital usage'}, value=${'3,000'}, total=${'108,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row" th:with="header=${'Subcontracting costs'}, value=${'3,000'}, total=${'108,000'}, spend=${(param.spend != null and param.spend[0] == 'high' ? 'high' : 'ok')}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row" th:with="header=${'Travel &#38; subsistence'}, value=${'1,000'}, total=${'36,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row" th:with="header=${'Other '}, value=${'1,000'}, total=${'36,000'}" th:remove="tag"/>
						</div>

						<div th:if="${param.status != null and param.status[0] == 'edit'}" th:remove="tag">
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row-edit" th:with="header=${'Labour '}, value=${'12,500'}, total=${'450,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row-edit" th:with="header=${'Admin support costs (20%)'}, value=${'2,500'}, total=${'90,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row-edit" th:with="header=${'Materials '}, value=${'3,000'}, total=${'108,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row-edit" th:with="header=${'Capital usage'}, value=${'3,000'}, total=${'108,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row-edit" th:with="header=${'Subcontracting costs'}, value=${'3,000'}, total=${'108,000'}, spend=${(param.spend != null and param.spend[0] == 'high' ? 'high' : 'ok')}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row-edit" th:with="header=${'Travel &#38; subsistence'}, value=${'1,000'}, total=${'36,000'}" th:remove="tag"/>
							<div th:include="prototypes/fragments/project-setup :: prototype-spend-row-edit" th:with="header=${'Other '}, value=${'1,000'}, total=${'36,000'}" th:remove="tag"/>
						</div>
					</tbody>
				</table>
			</div>
			<div class="flex-right"></div>
		</div>

		
		
		
		<div class="centralise">

			<div th:include="prototypes/fragments/applicant-view :: prototype-spend-year-totals" th:remove="tag" />

			<div th:unless="${(param.status != null and param.status[0] == 'edit') or (param.status != null and param.status[0] == 'Submitted') or (param.task != null and param.task[0] == 'reviewProject')}" th:remove="tag">

				<div th:if="${param.user == null or param.user[0] != 'nonLead' and param.status != null and param.status[0] == 'MarkedComplete'}" th:remove="tag">
					<p>If required, you can edit this spend profile. It will not be possible to submit the spend profile to Innovate UK until the section is marked as complete.</p>
				</div>


				<div class="extra-margin" th:unless="${param.user != null and param.user[0] == 'nonLead'}">
					<a th:href="${(param.spend != null and param.spend[0] == 'high' ? '/prototypes/3100-spend?status=edit&#38;spend=high#table-forecast' : '/prototypes/3100-spend?status=edit')}" class="button button-secondary">Edit spend profile</a>
				</div>

				<div class="extra-margin" th:unless="${param.user == null}">
					<a th:href="${(param.spend != null and param.spend[0] == 'high' ? '/prototypes/3100-spend?status=edit&#38;spend=high&#38;user=nonLead#table-forecast' : '/prototypes/3100-spend?status=edit&#38;user=nonLead#table-forecast')}" class="button button-secondary">Edit spend profile</a>
				</div>

				<p class="extra-margin" th:unless="${param.user == null or param.user[0] != 'nonLead'}">Before you submit, make sure you are satisfied with your spend profile and that it matches the eligible project costs. You can submit your spend profile to the lead partner. They will then submit to Innovate UK.</p>

				<p class="extra-margin" th:unless="${param.user != null and param.user[0] == 'nonLead' or param.status != null and param.status[0] == 'MarkedComplete'}">When you are satisfied with the spend profile, mark the section as complete. This will allow you to submit the spend profile for the project to Innovate UK. You can still return to edit this page before you choose to submit.</p>


				<div th:if="${param.user != null and param.user[0] == 'nonLead'}" th:remove="tag">

					<div class="extra-margin" th:unless="${param.spend != null and param.spend[0] == 'high'}">
						<a href="#" class="button button-large" data-js-modal="modal-send-to-lead">Send to lead partner</a>
					</div>

					<div class="extra-margin" th:unless="${param.spend == null or param.spend[0] != 'high'}">
						<a href="#" class="button button-large" disabled="disabled">Send to lead partner</a>
					</div>

					<div class="modal-send-to-lead" role="dialog" aria-hidden="true" style="margin-top: -174px;">
				        <button class="js-close close" aria-label="Close Popup">X</button>
				        <div>

							<h2 class="heading-medium no-margin">Send to lead partner</h2>

							<p>Are you sure you want to submit your spend profile to the lead partner?</p>

							<hr />

			            	<div class="alignright-button">
								
								<a href="#" aria-label="Close Popup" class="button-link js-close">Cancel</a> 

			            		<a href="/prototypes/3100-spend?status=Submitted&#38;user=nonLead" class="button">Send</a>
			            	</div>

				        </div>
				    </div>

			 	</div>

			 	<div th:if="${param.user == null or param.user[0] != 'nonLead'}" th:unless="${param.status != null and param.status[0] == 'MarkedComplete'}" th:remove="tag">

			 		<input type="hidden" name="status" id="status" value="MarkedComplete" th:unless="${param.spend != null and param.spend[0] == 'high'}"/>

					<div class="extra-margin">
						<button formaction="/prototypes/2472-spend-lead-overview?status=MarkedComplete" class="button button-large" th:disabled="${param.spend != null and param.spend[0] == 'high'}"> Mark as complete</button>
					</div>

			 	</div>
			</div>

		</div>

		<div th:if="${param.status != null and param.status[0] == 'edit'}" th:remove="tag">

			<div class="centralise extra-margin">

				<a th:href="${param.user != null and param.user[0] == 'nonLead' ? '/prototypes/3100-spend?user=nonLead':'/prototypes/3100-spend'}" class="button button-secondary" th:unless="${param.spend != null and param.spend[0] == 'high'}" >Save and return to spend profile overview</a>

				<a href="#" class="button-secondary" data-js-modal="modal-save-error" th:unless="${param.spend == null or param.spend[0] != 'high'}">Save and return to spend profile overview</a>

				<div class="modal-save-error" role="dialog" aria-hidden="true" style="margin-top: -174px;">
			        <button class="js-close close" aria-label="Close Popup">X</button>
			        <div>

						<h2 class="heading-medium no-margin">Save</h2>

						<p>Are you sure you wish to save your spend profile with higher costs than your eligible project costs?</p>

						<p>You will not be able to submit your spend profile until this is corrected.</p>

						<hr />

		            	<div class="alignright-button">
							
							<a href="#" aria-label="Close Popup" class="button-link js-close">Cancel</a> 

		            		<a th:href="${(param.user != null and param.user[0] == 'nonLead' ? '/prototypes/3100-spend?spend=high&#38;user=nonLead' : '/prototypes/3100-spend?spend=high')}" class="button">Save</a>
		            	</div>

			        </div>
			    </div>



			</div>

		</div>

		<div th:if="${param.task != null and param.task[0] == 'reviewPartner'}" th:remove="tag">
			<p>If required, you can edit this spend profile. It will not be possible to submit the spend profile to Innovate UK until the section is marked as complete</p>

			<div class="extra-margin">
				<a href="#" class="button button-secondary" data-js-modal="modal-allow-edits">Allow partner to edit</a>
			</div>

			<div class="modal-allow-edits" role="dialog" aria-hidden="true" style="margin-top: -174px;">
		        <button class="js-close close" aria-label="Close Popup">X</button>
		        <div>

					<h2 class="heading-medium no-margin">Allow partner to edit</h2>

					<p><strong>Biotech Corp's</strong> spend profile has been handed back to them, they have been informed of by email, if there are any specific changes required please contact them.</p>

					<hr />

	            	<div class="alignright-button">
	            		<a href="/prototypes/2472-spend-lead-overview" class="button">OK</a>
	            	</div>

		        </div>
		    </div>
		</div>

		<div th:if="${param.task != null and param.task[0] == 'reviewProject'}" th:remove="tag">

			<div class="extra-margin" th:unless="${param.status != null and param.status[0] == 'Submitted'}">
				<a href="#" class="button button-large" data-js-modal="modal-submit-spend">Submit project spend profile</a>
			</div>

			<div class="modal-submit-spend" role="dialog" aria-hidden="true" style="margin-top: -174px;">
		        <button class="js-close close" aria-label="Close Popup">X</button>
		        <div>

					<h2 class="heading-medium no-margin">Submit project spend profile</h2>

					<p>The project spend profile will be submitted to both Innovate UK and the Monitoring Officer assigned to this project. This will be used for reference and the base for progress.</p>

					<hr />

	            	<div class="alignright-button">
						<a href="#" aria-label="Close Popup" class="button-link js-close">Cancel</a> 
	            		<a href="/prototypes/1588-project-status?stage=level4" class="button">Submit</a>
	            	</div>

		        </div>
		    </div>
		</div>

	</form>


	<!-- END OFHARDCODED PROTOTYPE HTML -->

    <div th:include="fragments/layout :: main-content-end" th:remove="tag" />
</main>

<div th:include="fragments/layout :: footer" th:remove="tag" />
<div th:include="fragments/layout :: body-end" th:remove="tag" />
<script src="/js/ifs_prototype/prototype.js" type="text/javascript"></script>

<script type="text/javascript">
	// <![CDATA[

	// ]]>
</script>
</body>
</html>
