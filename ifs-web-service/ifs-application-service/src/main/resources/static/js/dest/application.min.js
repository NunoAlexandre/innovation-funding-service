if("undefined"==typeof IFS)var IFS={};IFS.application={},IFS.application.loadOrder={common:{init:function(){},finalize:function(){IFS.application.progressiveSelect.init()}},"app-form":{init:function(){IFS.core.unsavedChanges.init(),IFS.core.repeatableFinanceRows.init()},finalize:function(){IFS.application.financeSpecifics.init()}},"app-details":{init:function(){IFS.application.applicationPage.init()}},"app-invite":{init:function(){IFS.application.invites.init()}},"app-invite-display":{init:function(){IFS.application.inviteDisplay.init()}},"competition-management":{init:function(){IFS.application.competitionManagement.init()}}},IFS.application.progressiveSelect=function(){"use strict";var t,i=0;return{settings:{selectEl:"select.prog-menu",dropdownContainer:".assign-container .assign-button"},init:function(){t=this.settings,IFS.application.progressiveSelect.initDomChanges(),IFS.application.progressiveSelect.initEventHandlers()},initEventHandlers:function(){jQuery(document).on("click",function(){IFS.application.progressiveSelect.hideAll()}),jQuery("body").on("click",".assign-button [aria-controls]",function(t){t.stopPropagation(),IFS.application.progressiveSelect.toggleDropdown(this)})},initDomChanges:function(){jQuery(t.dropdownContainer).each(function(){IFS.application.progressiveSelect.initDropDownHTML(this)}),jQuery(t.selectEl).each(function(){IFS.application.progressiveSelect.selectToListHTML(this)})},selectToListHTML:function(t){t=jQuery(t),t.next("button").remove();var i=t.children("option"),n=t.attr("name"),a='<ul class="bullet list-bullet">';i.each(function(){var t=jQuery(this),i=t.text(),e=t.attr("value");a+=t.is("[disabled]")?"<li>"+i+"</li>":'<li><button value="'+e+'" name="'+n+'" class="buttonlink">'+i+"</button></li>"}),a+="</ul>",t.after(a).remove(),jQuery("body").trigger("updateSerializedFormState")},initDropDownHTML:function(t){var n=jQuery(t),a="dropdown-"+i;n.next().wrapAll('<div id="'+a+'" aria-hidden="true">'),n.wrapInner('<button aria-expanded="false" aria-controls="'+a+'" type="button">'),i++},toggleDropdown:function(t){var i=jQuery(t),n=jQuery("#"+i.attr("aria-controls")),a="false"===i.attr("aria-expanded");IFS.application.progressiveSelect.hideAll(),a&&(i.attr("aria-expanded","true"),n.attr("aria-hidden","false"))},hideAll:function(){jQuery('[aria-controls*="dropdown-"][aria-expanded="true"]').attr("aria-expanded","false"),jQuery('[id^="dropdown-"][aria-hidden="false"]').attr("aria-hidden","true")}}}(),IFS.application.financeSpecifics=function(){"use strict";var t;return{settings:{funderOrgFeedback:{funderOrgsizeInputs:'[name="financePosition-organisationSize"]',fundingLevelInput:"#cost-financegrantclaim",orgToFundingMapping:{SMALL:70,MEDIUM:60,LARGE:50}},administrationCostTotal:{adminSupportCosts:'[name*="overheads-type"]',supportCostInTotal:{NONE:"#section-total-10-labour-cost-none",DEFAULT_PERCENTAGE:"#section-total-10-default",CUSTOM_RATE:"#section-total-10-custom",TOTAL:"#section-total-10-calculate-formatted"},allTotals:'[id*="section-total-10"]',totalCostInHeaders:'[data-mirror="#section-total-10"]'}},init:function(){t=this.settings,IFS.application.financeSpecifics.initFunderOrgSizeFeedback(),IFS.application.financeSpecifics.initAdministrationCostTotal(),IFS.application.financeSpecifics.initOtherFunding()},initAdministrationCostTotal:function(){var i=jQuery(t.administrationCostTotal.adminSupportCosts+":checked");IFS.application.financeSpecifics.resetOtherAdministrationTotal(i),IFS.application.financeSpecifics.placeRightAdministrationTotalInHeader(i),jQuery(document).on("change",t.administrationCostTotal.adminSupportCosts,function(){IFS.application.financeSpecifics.resetOtherAdministrationTotal(this),IFS.application.financeSpecifics.placeRightAdministrationTotalInHeader(this)})},placeRightAdministrationTotalInHeader:function(i){var n=jQuery(i).val(),a="undefined"!=typeof t.administrationCostTotal.supportCostInTotal[n]&&t.administrationCostTotal.supportCostInTotal[n],e=jQuery(t.administrationCostTotal.totalCostInHeaders);a&&e.length&&(IFS.core.mirrorElements.updateElement(e,a),jQuery(document).off("change",t.administrationCostTotal.allTotals).on("change",a,function(){IFS.core.mirrorElements.updateElement(e,this)}))},resetOtherAdministrationTotal:function(i){var n=jQuery(i).closest("[data-target]"),a=n.prevAll("[data-target]").add(n.nextAll("[data-target]"));a.each(function(){var i=jQuery("#"+jQuery(this).attr("data-target")),n=i.find(t.administrationCostTotal.allTotals),a=n.attr("id");n.attr("data-old-id",a).removeAttr("id").val("Â£ 0").attr("data-calculation-rawvalue",0)});var e=jQuery("#"+jQuery(n).attr("data-target"));e.find("[data-old-id]").each(function(){var t=jQuery(this),i=t.attr("data-old-id"),n=t.attr("data-calculation-fields");jQuery(this).attr("id",i).removeAttr("data-old-id"),jQuery("#section-total-9").trigger("updateFinances"),jQuery(n).trigger("updateFinances")})},initFunderOrgSizeFeedback:function(){jQuery("body").on("change",t.funderOrgFeedback.funderOrgsizeInputs,function(){var i=jQuery(this).val(),n=jQuery(t.funderOrgFeedback.fundingLevelInput);if(n.length&&"undefined"!=typeof t.funderOrgFeedback.orgToFundingMapping[i]){n.attr("max",t.funderOrgFeedback.orgToFundingMapping[i]).removeClass("field-error");var a=n.closest(".form-group");a.removeClass("error"),a.find(".error-message").remove(),setTimeout(function(){n.trigger("change")},1e3)}})},initOtherFunding:function(){jQuery("#otherFundingShowHideToggle").on("change",'[data-target] input[type="radio"]',function(){setTimeout(function(){jQuery("[id*=fundingAmount]").trigger("updateFinances")},0)})}}}(),IFS.application.invites=function(){"use strict";var t;return{settings:{formid:".contributorsForm",inputs:".contributorsForm input",addRow:".contributorsForm .add-another-row",removeRow:".contributorsForm .remove-another-row",addOrg:'[name="add_partner"]',partnerName:".js-partner-name"},init:function(){t=this.settings,jQuery("body").on("change",t.inputs,function(){IFS.application.invites.saveToCookie()}),jQuery("body").on("click",t.addRow,function(t){IFS.application.invites.addRow(t)}),jQuery("body").on("click",t.removeRow,function(t){IFS.application.invites.removeRow(t)}),jQuery("body").on("click",t.addOrg,function(t){IFS.application.invites.addOrg(t)}),jQuery("body").on("keyup",t.partnerName,function(t){IFS.application.invites.parterNameInHeader(t.target)}),jQuery(t.partnerName).each(function(){IFS.application.invites.parterNameInHeader(this)})},saveToCookie:function(){var i=jQuery(t.formid).serialize();jQuery.ajaxProtected({url:window.location.href,method:"POST",dataType:"json",data:i})},addRow:function(t){t.preventDefault();var i=jQuery(t.target).closest("[data-invite-org]"),n=i.index(),a=i.find("[data-invite-row]").length,e='<tr data-invite-row><td class="form-group"><label for="organisations'+n+".invites"+a+'.personName"><span class="visuallyhidden">Name</span></label><input type="text" id="organisations'+n+".invites"+a+'.personName" class="form-control width-full" value="" placeholder="name" name="organisations['+n+"].invites["+a+'].personName"  /></td><td class="form-group"><label for="organisations'+n+".invites"+a+'.email"><span class="visuallyhidden">Email</span></label><input type="email" class="form-control width-full" value="" placeholder="name@company.co.uk" name="organisations['+n+"].invites["+a+'].email"  /></td><td class="alignright"><button value="'+n+"_"+a+'" name="remove_person" type="submit" class="remove-another-row buttonlink">Remove</button></td></tr>';i.find("tbody").append(e),jQuery('[id="organisations'+n+".invites"+a+'.personName"]').focus(),IFS.application.invites.saveToCookie()},addOrg:function(t){t.preventDefault();var i=jQuery("[data-invite-org]"),n=i.length,a='<li data-invite-org><h2 class="heading-medium">Partner Organisation<span></span></h2><div class="form-group"><label for="organisations'+n+'.organisationName" class="form-label"><span>Organisation Name</span></label><input type="text" id="organisations'+n+'.organisationName" value="" name="organisations['+n+'].organisationName"  placeholder="Name of the partner company" class="form-control js-partner-name" /></div><table><thead><tr><th>Applicant name</th><th>Email</th><th>&nbsp;</th></tr></thead><tbody><tr data-invite-row><td class="form-group"><label for="organisations'+n+'.invites0.personName"><span class="visuallyhidden">Name</span></label><input type="text" value="" id="organisations'+n+'.invites0.personName" name="organisations['+n+'].invites[0].personName"  placeholder="name" class="form-control width-full" /></td><td class="form-group"><label for="organisations'+n+'.invites0.email"><span class="visuallyhidden">Email</span></label><input type="email" value="" id="organisations'+n+'.invites0.email" name="organisations['+n+'].invites[0].email" placeholder="name@company.co.uk" class="form-control width-full" /></td><td class="alignright"><button value="'+n+'_0" name="remove_person" type="submit" class="remove-another-row buttonlink">Remove</button></td></tr></tbody></table><p class="alignright"><button value="'+n+'" name="add_person" type="submit" class="add-another-row buttonlink">Add another person</button></p></li>';i.last().after(a),jQuery('[id="organisations'+n+'.organisationName"]').focus(),IFS.application.invites.saveToCookie()},recountRows:function(){jQuery("[data-invite-org]").each(function(t,i){jQuery(i).find('[name*="organisations["]').each(function(){var i=jQuery(this).attr("name").split(".");i[0]="organisations["+t+"]",i=i.join("."),jQuery(this).attr("name",i)}),jQuery(i).find("[data-invite-row]").each(function(t,i){jQuery(i).find('[name*="invites["]').each(function(){var i=jQuery(this).attr("name").split(".");i[1]="invites["+t+"]",i=i.join("."),jQuery(this).attr("name",i)})})}),IFS.application.invites.saveToCookie()},removeRow:function(t){t.preventDefault();var i=jQuery(t.target);1===i.closest("[data-invite-org]").find("tbody tr").length?i.closest("[data-invite-org]").remove():i.closest("tr").remove(),IFS.application.invites.recountRows()},parterNameInHeader:function(t){var i=jQuery(t),n=i.closest("[data-invite-org]").children("h2");0===n.children("span").length&&n.append(" <span></span>");var a=i.val().length?'"'+i.val()+'"':"";n.children("span").text(a)}}}(),IFS.application.inviteDisplay=function(){"use strict";return{settings:{},init:function(){jQuery('[data-js-modal="modal-submit-remove-collaborator"]').click(function(){IFS.application.inviteDisplay.assignInviteIdOnClickRemove(this)})},assignInviteIdOnClickRemove:function(t){var i=jQuery(t).data("invite-id");jQuery('input[name="applicationInviteId"]').val(i)}}}();