if("undefined"==typeof IFS)var IFS={};IFS.application={},IFS.application.loadOrder={common:{init:function(){},finalize:function(){IFS.application.progressiveSelect.init()}},"app-form":{init:function(){IFS.core.unsavedChanges.init()}},"app-details":{init:function(){IFS.application.applicationPage.init()}},"app-invite":{init:function(){IFS.application.invites.init()}},"app-invite-display":{init:function(){IFS.application.inviteDisplay.init()}},"competition-management":{init:function(){IFS.application.competitionManagement.init()}}},IFS.application.progressiveSelect=function(){"use strict";var i,t=0;return{settings:{selectEl:"select.prog-menu",dropdownContainer:".assign-container .assign-button"},init:function(){i=this.settings,IFS.application.progressiveSelect.initDomChanges(),IFS.application.progressiveSelect.initEventHandlers()},initEventHandlers:function(){jQuery(document).on("click",function(){IFS.application.progressiveSelect.hideAll()}),jQuery("body").on("click",".assign-button [aria-controls]",function(i){i.stopPropagation(),IFS.application.progressiveSelect.toggleDropdown(this)})},initDomChanges:function(){jQuery(i.dropdownContainer).each(function(){IFS.application.progressiveSelect.initDropDownHTML(this)}),jQuery(i.selectEl).each(function(){IFS.application.progressiveSelect.selectToListHTML(this)})},selectToListHTML:function(i){i=jQuery(i),i.next("button").remove();var t=i.children("option"),e=i.attr("name"),n='<ul class="bullet list-bullet">';t.each(function(){var i=jQuery(this),t=i.text(),a=i.attr("value");n+=i.is("[disabled]")?"<li>"+t+"</li>":'<li><button value="'+a+'" name="'+e+'" class="buttonlink">'+t+"</button></li>"}),n+="</ul>",i.after(n).remove(),jQuery("body").trigger("updateSerializedFormState")},initDropDownHTML:function(i){var e=jQuery(i),n="dropdown-"+t;e.next().wrapAll('<div id="'+n+'" aria-hidden="true">'),e.wrapInner('<button aria-expanded="false" aria-controls="'+n+'" type="button">'),t++},toggleDropdown:function(i){var t=jQuery(i),e=jQuery("#"+t.attr("aria-controls")),n="false"===t.attr("aria-expanded");IFS.application.progressiveSelect.hideAll(),n&&(t.attr("aria-expanded","true"),e.attr("aria-hidden","false"))},hideAll:function(){jQuery('[aria-controls*="dropdown-"][aria-expanded="true"]').attr("aria-expanded","false"),jQuery('[id^="dropdown-"][aria-hidden="false"]').attr("aria-hidden","true")}}}(),IFS.application.applicationPage=function(){"use strict";return{init:function(){jQuery(document).on("click",'form.application-overview [name="assign_question"]',IFS.application.applicationPage.handleAssignQuestionFragmentReload)},handleAssignQuestionFragmentReload:function(i){var t,e=jQuery(this),n=e.closest("form.application-overview"),a=e.closest("li.section"),o=a.attr("id");if(a.closest('section[id^="section-"]').length&&(t=a.closest('section[id^="section-"]').attr("id").replace("section-","")),a.length&&t&&o)return jQuery.ajaxProtected({type:"POST",beforeSend:function(){"function"==typeof IFS.application.progressiveSelect.hideAll&&IFS.application.progressiveSelect.hideAll();var i=a.find(".assign-button");i.children("button").attr("aria-hidden","true"),a.find("img.section-status").attr("aria-hidden","true"),i.find(".reassign-status").remove(),i.append('<div class="reassign-status">Assigning to <strong>'+e.text()+"</strong>...</div>")},url:"?singleFragment=true&sectionId="+t,data:n.serialize()+"&"+e.attr("name")+"="+e.attr("value"),timeout:15e3,success:function(i){var t=jQuery("<div>"+i+"</div>"),e=t.find("#"+o);if(a.replaceWith(e),"function"==typeof IFS.application.progressiveSelect.initDropDownHTML){var n=e.find(".assign-button"),r=e.find("select.prog-menu");IFS.application.progressiveSelect.initDropDownHTML(n),IFS.application.progressiveSelect.selectToListHTML(r)}}}).fail(function(i){var t=IFS.core.autoSave.getErrorMessage(i);if(t){var e=a.find(".assign-button");e.children("button").attr("aria-hidden","false"),a.find("img.section-status").attr("aria-hidden","false"),a.find(".reassign-status").html('<div class="error-message">'+t+"</div>")}}),i.preventDefault(),!1}}}(),IFS.application.invites=function(){"use strict";var i;return{settings:{formid:".contributorsForm",inputs:".contributorsForm input",addRow:".contributorsForm .add-another-row",removeRow:".contributorsForm .remove-another-row",addOrg:'[name="add_partner"]',partnerName:".js-partner-name"},init:function(){i=this.settings,jQuery("body").on("change",i.inputs,function(){IFS.application.invites.saveToCookie()}),jQuery("body").on("click",i.addRow,function(i){IFS.application.invites.addRow(i)}),jQuery("body").on("click",i.removeRow,function(i){IFS.application.invites.removeRow(i)}),jQuery("body").on("click",i.addOrg,function(i){IFS.application.invites.addOrg(i)}),jQuery("body").on("keyup",i.partnerName,function(i){IFS.application.invites.parterNameInHeader(i.target)}),jQuery(i.partnerName).each(function(){IFS.application.invites.parterNameInHeader(this)})},saveToCookie:function(){var t=jQuery(i.formid).serialize();jQuery.ajaxProtected({url:window.location.href,method:"POST",dataType:"json",data:t})},addRow:function(i){i.preventDefault();var t=jQuery(i.target).closest("[data-invite-org]"),e=t.index(),n=t.find("[data-invite-row]").length,a='<tr data-invite-row><td class="form-group"><label for="organisations'+e+".invites"+n+'.personName"><span class="visuallyhidden">Name</span></label><input type="text" id="organisations'+e+".invites"+n+'.personName" class="form-control width-full" value="" placeholder="name" name="organisations['+e+"].invites["+n+'].personName"  /></td><td class="form-group"><label for="organisations'+e+".invites"+n+'.email"><span class="visuallyhidden">Email</span></label><input type="email" class="form-control width-full" value="" placeholder="name@company.co.uk" name="organisations['+e+"].invites["+n+'].email"  /></td><td class="alignright"><button value="'+e+"_"+n+'" name="remove_person" type="submit" class="remove-another-row buttonlink">Remove</button></td></tr>';t.find("tbody").append(a),jQuery('[id="organisations'+e+".invites"+n+'.personName"]').focus(),IFS.application.invites.saveToCookie()},addOrg:function(i){i.preventDefault();var t=jQuery("[data-invite-org]"),e=t.length,n='<li data-invite-org><h2 class="heading-medium">Partner Organisation<span></span></h2><div class="form-group"><label for="organisations'+e+'.organisationName" class="form-label"><span>Organisation Name</span></label><input type="text" id="organisations'+e+'.organisationName" value="" name="organisations['+e+'].organisationName"  placeholder="Name of the partner company" class="form-control js-partner-name" /></div><table><thead><tr><th>Applicant name</th><th>Email</th><th>&nbsp;</th></tr></thead><tbody><tr data-invite-row><td class="form-group"><label for="organisations'+e+'.invites0.personName"><span class="visuallyhidden">Name</span></label><input type="text" value="" id="organisations'+e+'.invites0.personName" name="organisations['+e+'].invites[0].personName"  placeholder="name" class="form-control width-full" /></td><td class="form-group"><label for="organisations'+e+'.invites0.email"><span class="visuallyhidden">Email</span></label><input type="email" value="" id="organisations'+e+'.invites0.email" name="organisations['+e+'].invites[0].email" placeholder="name@company.co.uk" class="form-control width-full" /></td><td class="alignright"><button value="'+e+'_0" name="remove_person" type="submit" class="remove-another-row buttonlink">Remove</button></td></tr></tbody></table><p class="alignright"><button value="'+e+'" name="add_person" type="submit" class="add-another-row buttonlink">Add another person</button></p></li>';t.last().after(n),jQuery('[id="organisations'+e+'.organisationName"]').focus(),IFS.application.invites.saveToCookie()},recountRows:function(){jQuery("[data-invite-org]").each(function(i,t){jQuery(t).find('[name*="organisations["]').each(function(){var t=jQuery(this).attr("name").split(".");t[0]="organisations["+i+"]",t=t.join("."),jQuery(this).attr("name",t)}),jQuery(t).find("[data-invite-row]").each(function(i,t){jQuery(t).find('[name*="invites["]').each(function(){var t=jQuery(this).attr("name").split(".");t[1]="invites["+i+"]",t=t.join("."),jQuery(this).attr("name",t)})})}),IFS.application.invites.saveToCookie()},removeRow:function(i){i.preventDefault();var t=jQuery(i.target);1===t.closest("[data-invite-org]").find("tbody tr").length?t.closest("[data-invite-org]").remove():t.closest("tr").remove(),IFS.application.invites.recountRows()},parterNameInHeader:function(i){var t=jQuery(i),e=t.closest("[data-invite-org]").children("h2");0===e.children("span").length&&e.append(" <span></span>");var n=t.val().length?'"'+t.val()+'"':"";e.children("span").text(n)}}}(),IFS.application.inviteDisplay=function(){"use strict";return{settings:{},init:function(){jQuery('[data-js-modal="modal-submit-remove-collaborator"]').click(function(){IFS.application.inviteDisplay.assignInviteIdOnClickRemove(this)})},assignInviteIdOnClickRemove:function(i){var t=jQuery(i).data("invite-id");jQuery('input[name="applicationInviteId"]').val(t)}}}();