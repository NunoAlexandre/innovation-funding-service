
<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <div th:include="fragments/layout :: head" th:with="pageTitle='Finance Contact'" th:remove="tag" />
</head>
<body th:with="context='project'" class="project-detail finance-contact">
<div th:include="fragments/layout :: body-start" th:remove="tag" />
<div th:include="fragments/layout :: global-header" th:remove="tag" />

<main id="content">
    <div th:include="fragments/layout :: main-content-start" th:remove="tag" />
    <div th:include="fragments/layout :: header-sub" th:with="linkTitle='Project details',linkClass='link-back',linkUrl=@{/project/{projectId}/details(projectId=${model.projectId})}"  th:remove="tag"></div>

    <div class="page-title">
        <div th:include="fragments/elements :: project-title (projectId=${model.app.id}, projectName=${model.projectName})" th:remove="tag" />
        <h1 class="heading-xlarge">Finance contact</h1>
    </div>

    <form method="POST" th:action="@{/project/{projectId}/details/finance-contact(projectId=${model.projectId})}" th:object="${form}" novalidate="novalidate">
        <fieldset>
            <h2 class="heading-medium">Finance contact</h2>
            <div class="form-group" th:classappend="${#fields.hasErrors('*') ? 'error' : ''}">
                <legend>
                    <span class="visuallyhidden">Finance contact</span>
                    <div th:if="${#fields.hasErrors('*')}" th:remove="tag">
                       <span class="error-message" th:each="err : ${#fields.errors('*')}" th:text="${err}" />
                   </div>
                </legend>
                <p class="form-hint">Who will be responsible for project finances in your organisation?</p>
                <p>We will ask this person to</p>
                <ul class="list list-bullet">
                    <li>provide bank details for your organisation</li>
                    <li>confirm any queries we have with your project costs</li>
                    <li>review the spend profile of your project costs</li>
                </ul>
                <div class="extra-margin">

                    <th:block th:each="user : ${model.organisationUsers}">
                        <input type="hidden" th:field="*{organisation}"></input>
                        <label th:for="${#ids.next('financeContact')}" class="block-label selection-button-radio">
                            <input type="radio" th:field="*{financeContact}"  data-hide-errors-on-select="#finance-contact-table input" th:value="${user.id}" th:attr="data-required-errormessage=#{validation.financecontactform.financecontact.required}" required="required" />
                            <span th:text="${user.name}" th:remove="tag"></span>
                        </label>
                    </th:block>

                    <th:block th:each="user : ${model.invitedUsers}">
                        <input type="hidden" th:field="*{organisation}"></input>
                        <label th:for="${#ids.next('financeContact')}" class="block-label selection-button-radio">
                            <input type="radio" th:unless="${user == null or user.status != 'EXISTING'}" th:field="*{financeContact}"  data-hide-errors-on-select="#finance-contact-table input" th:value="${user.id}" th:attr="data-required-errormessage=#{validation.financecontactform.financecontact.required}" required="required" />
                            <span th:text="${user.name}" th:remove="tag"></span>
                        </label>
                    </th:block>

                    <label for="new" class="block-label selection-button-radio" data-target="finance-contact-table">
                        <input id="new" name="financeContact" th:checked="${model.inviteAction} or *{financeContact == -1}" type="radio" value="-1" th:attr="data-required-errormessage=#{validation.financecontactform.financecontact.required}" required="required" />
                        Add new team member
                        <span class="form-hint">A new team member will be invited to join the project</span>
                    </label>
                </div>
                <table id="finance-contact-table">
                    <thead>
                    <tr>
                        <th></th>
                        <th scope="col" id="finance-contact-name">Name</th>
                        <th scope="col" colspan="2" id="finance-contact-email">E-mail</th>
                    </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">
                                <span class="visuallyhidden">invitee</span>
                            </th>
                            <td>
                                <label for="name-finance-contact" class="visuallyhidden">name</label>
                                <input type="text" class="form-control width-full"  th:value="*{name}" th:classappend="${#fields.hasErrors('name') ? 'field-error' : ''}" name="name" id="name-finance-contact" th:attr="data-required-errormessage=#{validation.project.invite.name.required}" required="required"/>
                            </td>
                            <td>
                                <label for="email-finance-contact" class="visuallyhidden">email</label>
                                <input type="email" class="form-control width-full" th:value="*{email}" th:classappend="${#fields.hasErrors('email') ? 'field-error' : ''}" name="email" id="email-finance-contact" th:attr="data-required-errormessage=#{validation.project.invite.email.required}" required="required"/>
                            </td>
                            <td class="alignright">
                                <button class="buttonlink no-margin-bottom" name="invite_fc" id="invite-finance-contact">Invite to project</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </fieldset>
        <p>If you add a new team member this section will show as pending until they have accepted. Once the team member has accepted and created their account, they will automatically be submitted as your finance contact.</p>
        <button class="button extra-margin" type="submit"  name="save_fc" id="save">Save</button>
    </form>



    <div th:include="fragments/layout :: main-content-end" th:remove="tag" />
</main>

<div th:include="fragments/layout :: footer" th:remove="tag" />
<div th:include="fragments/layout :: body-end" th:remove="tag" />

</body>
</html>
