<!DOCTYPE html>
<html class="no-js" lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <div th:include="fragments/layout :: head" th:with="pageTitle='Application Dashboard'" th:remove="tag" />
    <link href="/css/prototype.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body class="app-overview">

<div th:include="prototypes/fragments/layout :: prototype-nav" th:remove="tag" />
<div th:include="fragments/layout :: body-start" th:remove="tag" />
<div th:include="fragments/layout :: global-header" th:remove="tag" />


<main id="content">
    <div th:include="fragments/layout :: main-content-start" th:remove="tag" />
	<div th:include="prototypes/fragments/applicant-view :: prototype-subheader(${'Offer status'}, ${'/prototypes/1588-project-status'})" th:remove="tag" />


	<!-- HARDCODED PROTOTYPE HTML -->
	<div th:include="prototypes/fragments/applicant-view :: prototype-project-page-title(${'194741: Machine learning in robots'}, ${'Project details'})" th:remove="tag" />
	
	<p>Please supply the following details about your project and the team so that we can conduct the necessary finance checks before the project begins.</p>

	<h2 class="heading-medium">Project details</h2>

	<p>You are providing these details as the lead applicant on behalf of the overall project.</p>

	<table>
		<thead>
			<tr>
				<th scope="col" style="width: 45%">Question</th>
				<th scope="col" style="width: 45%">Answer</th>
				<th scope="col" style="width: 20%">Complete</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>
					<a href="/prototypes/1575-start-date" th:unless="${param.user != null and param.user[0] == 'nonLead'}">Start date</a>
					<span th:unless="${param.user == null or param.user[0] != 'nonLead'}">Start date</span>
				</td>
				<td id="start-date">
					&nbsp;
				</td>
				<td>
					<span id="start-date-status">&nbsp;</span>
				</td>
			</tr>
			<tr>
				<td>					
					<a href="/prototypes/1575-project-address" th:unless="${param.user != null and param.user[0] == 'nonLead'}">Project address</a>
					<span th:unless="${param.user == null or param.user[0] != 'nonLead'}">Project address</span>
				</td>
				<td id="project-address">
					&nbsp;
				</td>
				<td>
					<span id="project-address-status">&nbsp;</span>
				</td>
			</tr>
			<tr>
				<td>
					<a href="/prototypes/1575-project-manager" th:unless="${param.user != null and param.user[0] == 'nonLead'}">Project manager</a>
					<span th:unless="${param.user == null or param.user[0] != 'nonLead'}">Project manager</span>
				</td>
				<td id="project-manager">
					&nbsp;
				</td>
				<td>
					<span id="project-manager-status">&nbsp;</span>
				</td>
			</tr>
			
		</tbody>
	</table>

	<h2 class="heading-medium">Finance contacts</h2>

	<p>Each partner is required to provide a finance contact who will be sent any queries from Innovate UK around project finances.</p>

	<table>
		<thead>
			<tr>
				<th scope="col" style="width: 45%">Partner</th>
				<th scope="col" style="width: 45%">Finance contact</th>
				<th scope="col" style="width: 10%">Complete</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>
					<a href="/prototypes/1575-finance-contact" th:unless="${param.user != null and param.user[0] == 'nonLead'}" >Worth systems</a>
					<span th:unless="${param.user == null or param.user[0] != 'nonLead'}">Worth systems</span>
				</td>
				<td>
					<span id="finance-contact">John Smith</span>
				</td>
				<td>
					<span id="finance-contact-status" class="yes">Yes</span>
				</td>
			</tr>
			<tr>
				<td>
					<span th:unless="${param.user != null and param.user[0] == 'nonLead'}">Nomensa</span>
					<a href="/prototypes/1575-finance-contact?user=nonLead" th:unless="${param.user == null or param.user[0] != 'nonLead'}">Nomensa</a>
				</td>
				<td>
					<span id="finance-partner-contact">-</span>
				</td>
				<td>
					<span id="finance-partner-contact-status" class="no">No</span>
				</td>
			</tr>
			<tr>
				<td>
					C@C
				</td>
				<td>
					David Evans
				</td>
				<td>
					<span id="finance-partner2-contact-status">Pending</span>
				</td>
			</tr>
		</tbody>
	</table>

	<p class="extra-margin">Any new team members invited at this stage are required to join this project before this section can be marked as complete.</p>

	<div class="extra-margin">
		<a th:href="${param.user != null and param.user[0] == 'nonLead' ? '/prototypes/1588-project-status?user=nonLead' :'/prototypes/1588-project-status'}" class="button-secondary">Save and return to project setup</a>
	</div>

	
	<!-- END OFHARDCODED PROTOTYPE HTML -->

    <div th:include="fragments/layout :: main-content-end" th:remove="tag" />
</main>

<div th:include="fragments/layout :: footer" th:remove="tag" />
<div th:include="fragments/layout :: body-end" th:remove="tag" />
<script src="/js/ifs_prototype/prototype.js" type="text/javascript"></script>

<script type="text/javascript">
	// <![CDATA[
	jQuery(document).ready(function(){

		function $_GET(param) {
	        var vars = {};
	        window.location.href.replace( location.hash, '' ).replace( 
	            /[?&]+([^=&]+)=?([^&]*)?/gi, // regexp
	            function( m, key, value ) { // callback
	                vars[key] = value !== undefined ? value : '';
	            }
	        );

	        if ( param ) {
	            return vars[param] ? vars[param] : null;    
	        }
	        return vars;
	    }

		var startDay = $_GET('start-day'),
			startMonth = $_GET('start-month'),
			startYear = $_GET('start-year'),
			street = $_GET('street'),
			town = $_GET('town'),
			postcode = $_GET('postcode'),
			pmName = $_GET('pm-name-group'),
			pmNamePending = $_GET('name-pm1'),
			financesName = $_GET('finances-name-group'),
			financesNamePending = $_GET('name-finance-contact1'),
			userType = $_GET('user');

		if (startDay != null || startMonth != null || startYear != null){
			localStorage.setItem('startDate', startDay+'/'+startMonth+'/'+startYear)
		}
		var startDate = localStorage.getItem('startDate');

		if (postcode != null){
			localStorage.setItem('projectAddress', street+','+town+','+postcode)
		}
		var projectAddress = localStorage.getItem('projectAddress');

		if (pmName != null){
			localStorage.setItem('pmName', pmName);
			localStorage.removeItem('pmNamePending');
		}
		var pmName = localStorage.getItem('pmName');

		if (pmNamePending != null){
			localStorage.setItem('pmNamePending', pmNamePending);
			localStorage.removeItem('pmName');
		}
		var pmNamePending = localStorage.getItem('pmNamePending');

		if (financesName != null){
			localStorage.setItem('financesName', financesName);
			localStorage.removeItem('financesNamePending');
		}
		var financesName = localStorage.getItem('financesName');

		if (financesNamePending != null){
			localStorage.setItem('financesNamePending', financesNamePending);
			localStorage.removeItem('financesName');
		}
		var financesNamePending = localStorage.getItem('financesNamePending');
		

		if(startDate == null){
			jQuery('#start-date').text('-');
			jQuery('#start-date-status').text('No');
			jQuery('#start-date-status').addClass('no');
			jQuery('#start-date-status').removeClass('yes');	
		}else{
			jQuery('#start-date').text(startDate);
			jQuery('#start-date-status').text('Yes');
			jQuery('#start-date-status').addClass('yes');
			jQuery('#start-date-status').removeClass('yes');

		}

		if(projectAddress == null){
			jQuery('#project-address').text('-');
			jQuery('#project-address-status').text('No');
			jQuery('#project-address-status').addClass('no');
			jQuery('#project-address-status').removeClass('yes');
		}else{
			jQuery('#project-address').text(projectAddress.replace(/\+/g,' '));
			jQuery('#project-address-status').text('Yes');
			jQuery('#project-address-status').addClass('yes');
			jQuery('#project-address-status').removeClass('no');

		}

		if(pmName == null){
			jQuery('#project-manager').text('-');
			jQuery('#project-manager-status').text('No');
			jQuery('#project-manager-status').addClass('no');
			jQuery('#project-manager-status').removeClass('yes');	
		}else{
			jQuery('#project-manager').text(pmName.replace(/\+/g,' '));

			if(pmNamePending == null){
				jQuery('#project-manager-status').text('Yes');
				jQuery('#project-manager-status').addClass('yes');
				jQuery('#project-manager-status').removeClass('no');	

			}else{
				jQuery('#project-manager').text(pmNamePending.replace(/\+/g,' '));
				jQuery('#project-manager-status').text('Pending');
				jQuery('#project-manager-status').removeClass('yes');
				jQuery('#project-manager-status').removeClass('no');
			}
		}

		if(financesName == null & userType == null){
			jQuery('#finance-contact').text('John Smith');
			jQuery('#finance-contact-status').text('No');
			jQuery('#finance-contact-status').addClass('no');
			jQuery('#finance-contact-status').removeClass('yes');

		}else if(financesName != null & userType == null){

			jQuery('#finance-contact').text(financesName.replace(/\+/g,' '));



			if(financesNamePending == null){
				jQuery('#finance-contact-status').text('Yes');
				jQuery('#finance-contact-status').addClass('yes');
				jQuery('#finance-contact-status').removeClass('no');
			}else{
				jQuery('#finance-contact').text(financesNamePending.replace(/\+/g,' '));
				jQuery('#finance-contact-status').text('Pending');
				jQuery('#finance-contact-status').removeClass('yes');
				jQuery('#finance-contact-status').removeClass('no');
			}
		}

		if(financesName == null & userType == 'nonLead'){
			jQuery('#finance-partner-contact').text('-');
			jQuery('#finance-partner-contact-status').text('No');
			jQuery('#finance-partner-contact-status').addClass('no');
			jQuery('#finance-partner-contact-status').removeClass('yes');

		}else if(financesName != null & userType == 'nonLead'){

			jQuery('#finance-partner-contact').text(financesName.replace(/\+/g,' '));

			if(financesNamePending == null){
				jQuery('#finance-partner-contact-status').text('Yes');
				jQuery('#finance-partner-contact-status').addClass('yes');
				jQuery('#finance-partner-contact-status').removeClass('no');
			}else{
				jQuery('#finance-partner-contact').text(financesNamePending.replace(/\+/g,' '));
				jQuery('#finance-partner-contact-status').text('Pending');
				jQuery('#finance-partner-contact-status').removeClass('yes');
				jQuery('#finance-partner-contact-status').removeClass('no');
			}
		}


		jQuery('#add-finance-contact').on('click',function(e){ 
			e.preventDefault();
			jQuery('#finance-contact-table').show();

		});

		jQuery('#invite-finance-contact').on('click',function(e){ 
			e.preventDefault();

			var financeContact = jQuery('#name-finance-contact1').val();

			jQuery('#finance-name').text(financeContact + ' (Pending)')
			jQuery("#finances-name-invite").attr('checked', 'checked');
			jQuery('#finance-contact-table').hide();
			jQuery('#invited-finance-contact').show(); 

		});



		jQuery('#add-pm').on('click',function(e){ 
			e.preventDefault();
			jQuery('#pm-table').show();

		});

		jQuery('#invite-pm').on('click',function(e){ 
			e.preventDefault();
			jQuery('#pm-table').hide();
		});


		jQuery('#postcode-lookup').on('click',function(e){ 
			e.preventDefault();
			jQuery("#select-address-block").show();
		});

		jQuery('#select-address').on('change',function(e){ 
			e.preventDefault();
			jQuery("#address-details").show();
			jQuery("#street").val("4 Station Road");
			jQuery("#county").val("Wiltshire");
			jQuery("#town").val("Swindon");
			jQuery("#postcode").val("SN1 2BD");

		});

		jQuery('#enter-address-manually').on('click',function(e){ 
			e.preventDefault();
			jQuery("#address-details").show();
			jQuery("#select-address-block").hide();
		});

	});
	// ]]>
</script>
</body>
</html>